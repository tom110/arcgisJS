// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.18/esri/copyright.txt for details.
//>>built
define("esri/layers/vectorTiles/views/vectorTiles/SpriteSource","require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper dojo/Deferred dojo/promise/all ../../request ../../identity/IdentityManager ../../core/promiseUtils".split(" "),function(n,p,q,r,g,h,k,l,m){return function(){function d(c,a){this.baseURL=c;this.devicePixelRatio=a;this._isRetina=!1;this._spritesData={};this.height=this.width=this.image=null;this.loadStatus="not-loaded"}d.prototype.getSpritePosition=
function(c){return this._spritesData[c]};d.prototype.load=function(){var c=this;this.loadStatus="loading";return this._loadSprites().then(function(){c.loadStatus="loaded";return c}).otherwise(function(a){c.loadStatus="failed";return m.reject(a)})};d.prototype._loadSprites=function(){var c=this;this._isRetina=1.15<this.devicePixelRatio?!0:!1;var a=this.baseURL,e=this._isRetina?"@2x":"",d=k(a+e+".json",{callbackParamName:"callback",responseType:"json"}).then(function(b){c._spritesData=b.data}),f=new g,
b=new Image;b.crossOrigin="anonymous";b.onload=function(){b.onload=null;c.width=b.width;c.height=b.height;var a=document.createElement("canvas");a.width=b.width;a.height=b.height;a=a.getContext("2d");a.drawImage(b,0,0,b.width,b.height);a=a.getImageData(0,0,b.width,b.height);c.image=new Uint8Array(a.data);f.resolve()};a=""+a+e+".png";(e=l.findCredential(a))&&e.token&&(a+="?token\x3d"+e.token);b.src=a;return h([d,f.promise])};return d}()});