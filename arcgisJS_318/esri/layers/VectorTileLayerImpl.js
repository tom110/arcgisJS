// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.18/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/unitBezier":function(){define([],function(){var k=function(a,b,c,d){function e(a,b){var c,d,e,l;b=null==b?1E-6:b;e=a;for(d=0;8>d;d++){l=((m*e+h)*e+f)*e-a;if(Math.abs(l)<b)return e;c=(3*m*e+2*h)*e+f;if(1E-6>Math.abs(c))break;e-=l/c}c=0;d=1;e=a;if(e<c)return c;if(e>d)return d;for(;c<d;){l=((m*e+h)*e+f)*e;if(Math.abs(l-a)<b)break;a>l?c=e:d=e;e=0.5*(d-c)+c}return e}var f=3*a,h=3*(c-a)-f,m=1-f-h,l=3*b,n=3*(d-b)-l,p=1-l-n;return function(a,b){var c=e(a,b);return((p*c+n)*c+l)*
c}},g=/^cubic-bezier\((.*)\)/;k.parse=function(a){var b=k[a]||null;if(!b&&(a=g.exec(a)))a=a[1].split(",").map(function(a){return parseFloat(a.trim())}),4===a.length&&!a.some(function(a){return isNaN(a)})&&(b=k.apply(k,a));return b};k.ease=k(0.25,0.1,0.25,1);k.linear=k(0,0,1,1);k.easeIn=k["ease-in"]=k(0.42,0,1,1);k.easeOut=k["ease-out"]=k(0,0,0.58,1);k.easeInOut=k["ease-in-out"]=k(0.42,0,0.58,1);return k})},"esri/layers/vectorTiles/request":function(){define(["require","exports","esri/request","dojo/_base/lang"],
function(k,g,a,b){return function(c,d){var e=b.mixin({},{url:c,failOk:!0},d);"array-buffer"===d.responseType?(e.handleAs="arraybuffer",delete e.responseType):d.responseType&&(e.handleAs=d.responseType,delete e.responseType);null!==d.query&&(e.content=e.query,delete e.query);return a(e).then(function(a){return{data:a}})}})},"esri/layers/vectorTiles/core/promiseUtils":function(){define(["require","exports","dojo/Deferred","./Error"],function(k,g,a,b){g.eachAlways=function(b){var d=new a,e=[],f=b.length;
0===f&&d.resolve(e);b.forEach(function(a){var b={promise:a};e.push(b);a.then(function(a){b.value=a}).otherwise(function(a){b.error=a}).then(function(){--f;0===f&&d.resolve(e)})});return d.promise};g.create=function(b){var d=new a;b(function(a){void 0===a&&(a=null);return d.resolve(a)},d.reject);return d.promise};g.reject=function(b){var d=new a;d.reject(b);return d.promise};g.resolve=function(b){void 0===b&&(b=null);var d=new a;d.resolve(b);return d.promise};g.after=function(b,d){void 0===d&&(d=null);
var e=0,f=new a(function(){e&&(clearTimeout(e),e=0)}),e=setTimeout(function(){f.resolve(d)},b);return f.promise};g.timeout=function(c,d,e){var f=0,h=new a(c.cancel);c.then(function(a){h.isFulfilled()||(h.resolve(a),f&&(clearTimeout(f),f=0))});c.otherwise(function(a){h.isFulfilled()||(h.reject(a),f&&(clearTimeout(f),f=0))});f=setTimeout(function(){var a=e||new b("promiseUtils:timeout","The wrapped promise did not resolve within "+d+" ms");h.reject(a)},d);return h.promise}})},"esri/layers/vectorTiles/core/Error":function(){define(["require",
"exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","./Message"],function(k,g,a,b,c){k=function(b){function c(){b.apply(this,arguments)}a(c,b);return c}(c);k.prototype.type="error";return k})},"esri/layers/vectorTiles/core/tsSupport/extendsHelper":function(){define([],function(){return function(k,g){function a(){this.constructor=k}for(var b in g)g.hasOwnProperty(b)&&(k[b]=g[b]);k.prototype=null===g?Object.create(g):(a.prototype=g.prototype,new a)}})},"esri/layers/vectorTiles/core/tsSupport/decorateHelper":function(){define([],
function(){return function(k,g,a,b){var c=arguments.length,d=3>c?g:null===b?b=Object.getOwnPropertyDescriptor(g,a):b,e;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)d=Reflect.decorate(k,g,a,b);else for(var f=k.length-1;0<=f;f--)if(e=k[f])d=(3>c?e(d):3<c?e(g,a,d):e(g,a))||d;return 3<c&&d&&Object.defineProperty(g,a,d),d}})},"esri/layers/vectorTiles/core/Message":function(){define(["require","exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","dojo/string"],function(k,
g,a,b,c){return function(){function a(b,d,h){this.name=b;this.message=d&&c.substitute(d,h,function(a){return null==a?"":a})||"";this.details=h}a.prototype.toString=function(){return"["+this.name+"]: "+this.message};return a}()})},"esri/layers/vectorTiles/core/urlUtils":function(){define(["require","exports","esri/urlUtils","dojo/_base/url"],function(k,g,a,b){function c(a){return a&&"/"===a[0]&&"/"===a[1]||m.test(a)}function d(a){if("string"===typeof a)return new b(e(a));a.scheme||(a.scheme=g.appUrl.scheme);
return a}function e(a,b){void 0===b&&(b=g.appBaseUrl);if(a&&"/"===a[0]&&"/"===a[1])return"file"===g.appUrl.scheme?"https:"+a:g.appUrl.scheme+":"+a;if(m.test(a))return a;var c=f,d;if("/"===a[0]){d=b;var e=d.indexOf("//"),e=d.indexOf("/",e+2);d=-1===e?d:d.slice(0,e)}else d=b;return c(d,a)}function f(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];if(a&&a.length){b=[];if(c(a[0])){var d=a[0],e=d.indexOf("//");b.push(d.slice(0,e+1));h.test(a[0])&&(b[0]+="/");a[0]=d.slice(e+2)}else"/"===a[0][0]&&
b.push("");a=a.reduce(function(a,b){return a.concat(b.split("/"))},[]);for(d=0;d<a.length;d++)e=a[d],".."===e&&0<b.length?b.pop():e&&("."!==e||0===b.length)&&b.push(e);return b.join("/")}}g.normalize=function(b){return a.normalize(b)};k=Function("return this")();g.appUrl=new b(k.location);g.appBaseUrl=function(){var a=g.appUrl.path,a=a.substring(0,a.lastIndexOf(a.split("/")[a.split("/").length-1]));return""+(g.appUrl.scheme+"://"+g.appUrl.host+(null!=g.appUrl.port?":"+g.appUrl.port:""))+a}();var h=
/^\s*file:/i,m=/^\s*[a-z][a-z0-9-+.]*:[^0-9]/i;g.isAbsolute=c;g.urlToObject=function(b){return a.urlToObject(b)};g.makeAbsolute=e;g.hasSameOrigin=function(a,b,c){void 0===c&&(c=!1);a=d(a);b=d(b);return!c&&a.scheme!==b.scheme?!1:a.host.toLowerCase()===b.host.toLowerCase()&&a.port===b.port};g.join=f})},"esri/layers/vectorTiles/layers/support/vectorTileLayerLoader":function(){define("require exports dojo/has dojo/_base/lang ../../core/promiseUtils ../../core/urlUtils ../../request".split(" "),function(k,
g,a,b,c,d,e){function f(a,b,c){if(b.hasOwnProperty("tileInfo"))return a.layerDefinition=b,a.serviceUrl=c.path,h(a,b,c);c?-1!==c.path.indexOf("root.json")&&(c.path=c.path.substr(0,c.path.indexOf("root.json"))):(c=b.sprite,c=c.substr(0,c.indexOf("sprites/sprite"))+"styles/",a.url=d.normalize(c),c=a.parsedUrl=d.urlToObject(a.url));a.styleUrl=c.path;a.style=b;return m(a,b,c)}function h(a,b,c){if(p&&!b.hasOwnProperty("defaultStyles"))throw Error("Service definition must have 'defaultStyles' element!");
a.styleUrl=d.normalize(d.join(c.path,b.defaultStyles));return e(d.join(a.styleUrl,"root.json"),{callbackParamName:"callback",responseType:"json"}).then(function(b){return a.style=b.data})}function m(a,b,f){(b=l(b))||c.reject("Source isn't available in the syle object!");if(b.hasOwnProperty("url"))return a.serviceUrl=b.url,d.isAbsolute(a.serviceUrl)||(a.serviceUrl=d.join(f.path,a.serviceUrl)),e(a.serviceUrl,{query:{f:"json"},callbackParamName:"callback",responseType:"json"}).then(function(b){a.layerDefinition=
n(b.data);return a});a.layerDefinition=n(b);return c.resolve(a)}function l(a){if(!a.hasOwnProperty("sources"))return null;a=a.sources;var b=null;if(a.hasOwnProperty("esri"))b=a.esri;else{for(var c=0,d=Object.keys(a);c<d.length;c++){var e=d[c];if(-1!==e.toLocaleLowerCase().indexOf("street")&&"vector"===b.type){b=a[e];break}}if(!b){c=0;for(d=Object.keys(a);c<d.length&&!(e=d[c],b=a[e],"vector"===b.type);c++);}}return b}function n(a){a.hasOwnProperty("fullExtent");if(!a.hasOwnProperty("tileInfo")){for(var b=
this.fullExtent.width/512,c=[],d=a.hasOwnProperty("minzoom")?parseFloat(a.minzoom):0,e=a.hasOwnProperty("maxzoom")?parseFloat(a.maxzoom):16;d<e;d++){var f=b/Math.pow(2,d);c.push({level:d,scale:Math.floor(3779.527559055118*f),resolution:f})}a.tileInfo={rows:512,cols:512,dpi:96,format:"pbf",origin:{x:this.fullExtent.xmin,y:this.fullExtent.ymax,spatialReference:{wkid:102100}},lods:c,spatialReference:{wkid:102100}}}a.hasOwnProperty("capabilities")||(a.capabilities="TilesOnly");if(p&&!a.hasOwnProperty("tiles"))throw Error("Cannot find element tiles!");
return a}var p=a("dojo-debug-messages");g.loadMetadata=function(a){if(!a)return c.reject("invalid input URL!");if("string"!==typeof a){var h=l(a);h&&h.hasOwnProperty("url")&&(h=d.join(h.url,"/resources/styles"),a.hasOwnProperty("sprite")&&!d.isAbsolute(a.sprite)&&(a.sprite=d.join(h,a.sprite)),a.hasOwnProperty("glyphs")&&!d.isAbsolute(a.glyphs)&&(a.glyphs=d.join(h,a.glyphs)))}var m={layerDefinition:null,parsedUrl:null,serviceUrl:null,style:null,styleUrl:null,url:null};if("string"===typeof a){a=m.url=
d.normalize(a);var p=m.parsedUrl=d.urlToObject(a);return e(p.path,{callbackParamName:"callback",responseType:"json",query:b.mixin({f:"json"},p.query)}).then(function(a){return f(m,a.data,p)}).then(function(){return m})}return f(m,a,null).then(function(){return m})}})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleRepository":function(){define(["require","exports","../../../core/urlUtils","./StyleLayer"],function(k,g,a,b){return function(){function c(b,e){void 0===e&&(e="");this.styleJSON=
b;this.version=parseFloat(b.version);this.sprite=b.sprite;a.isAbsolute(this.sprite)||(this.sprite=a.join(e,this.sprite));this.glyphs=b.glyphs;a.isAbsolute(this.glyphs)||(this.glyphs=a.join(e,this.glyphs));this.layers=(b.layers||[]).map(c._create);this._identifyRefLayers()}c.prototype._identifyRefLayers=function(){for(var a=[],b=[],c=0,h=this.layers;c<h.length;c++){var m=h[c];if(1===m.type){var l=m.sourceLayer,l=l+("|"+JSON.stringify(m.minzoom)),l=l+("|"+JSON.stringify(m.maxzoom)),l=l+("|"+JSON.stringify(m.filter));
a.push({key:l,layer:m})}2===m.type&&(l=m.sourceLayer,l+="|"+JSON.stringify(m.minzoom),l+="|"+JSON.stringify(m.maxzoom),l+="|"+JSON.stringify(m.filter),l+="|"+JSON.stringify(m.layout["line-cap"]),l+="|"+JSON.stringify(m.layout["line-join"]),b.push({key:l,layer:m}))}this._assignRefLayers(a);this._assignRefLayers(b)};c.prototype._assignRefLayers=function(a){a.sort(function(a,b){return a.key<b.key?-1:a.key>b.key?1:0});for(var b,c,h=a.length,m=0;m<h;m++){var l=a[m];if(l.key===b)l.layer.refLayerId=c;else if(b=
l.key,c=l.layer.id,1===l.layer.type&&!l.layer.hasPaintProperty("fill-outline-color"))for(var n=m+1;n<h;n++){var p=a[n];if(p.key===b){if(p.layer.hasPaintProperty("fill-outline-color")){a[m]=p;a[n]=l;c=p.layer.id;break}}else break}}};c._create=function(a,c,f){c=1-(1+c)*(1/(f.length+1));switch(a.type){case "background":return new b.StyleLayer(0,a,c);case "fill":return new b.StyleLayer(1,a,c);case "line":return new b.StyleLayer(2,a,c);case "symbol":return new b.StyleLayer(3,a,c);case "raster":throw Error("Unsupported vector tile raster layer");
case "circle":throw Error("Unsupported vector tile circle layer");}throw Error("Unknown vector tile layer");};return c}()})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleLayer":function(){define(["require","exports","./StyleDefinition","./StyleProperty","./Filter"],function(k,g,a,b,c){k=function(){function d(b,c,d){this.type=b;this.id=c.id;this.source=c.source;this.sourceLayer=c["source-layer"];this.minzoom=c.minzoom;this.maxzoom=c.maxzoom;this.filter=c.filter;this.layout=c.layout;this.paint=
c.paint;this.z=d;switch(b){case 0:this._layoutDefinition=a.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=a.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=a.StyleDefinition.fillLayoutDefinition;this._paintDefinition=a.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=a.StyleDefinition.lineLayoutDefinition;this._paintDefinition=a.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=a.StyleDefinition.symbolLayoutDefinition,
this._paintDefinition=a.StyleDefinition.symbolPaintDefinition}this._layoutProperties=this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}d.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=c.createFilter(this.filter)};d.prototype.hasLayoutProperty=function(a){var b=this._layoutProperties;return b&&b[a]?!0:!1};d.prototype.hasPaintProperty=function(a){var b=this._paintProperties;return b?void 0!==b[a]:!1};
d.prototype.getLayoutValue=function(a,b){var c,d=this._layoutProperties;d&&(d=d[a])&&(c=d.getValue(b));d=this._layoutDefinition[a];void 0===c&&(c=d["default"]);"enum"===d.type&&(c=d.values.indexOf(c));return c};d.prototype.getPaintValue=function(a,b){var c,d=this._paintProperties;d&&(d=d[a])&&(c=d.getValue(b));d=this._paintDefinition[a];void 0===c&&(c=d["default"]);"enum"===d.type&&(c=d.values.indexOf(c));return c};d.prototype._parseLayout=function(a){var c={},d;for(d in a)c[d]=new b(this._layoutDefinition[d],
a[d]);return c};d.prototype._parsePaint=function(a){var c={},d;for(d in a)c[d]=new b(this._paintDefinition[d],a[d]);return c};return d}();g.StyleLayer=k;k=function(){return function(a,b){this.cap=a.getLayoutValue("line-cap",b);this.join=a.getLayoutValue("line-join",b);this.miterLimit=a.getLayoutValue("line-miter-limit",b);this.roundLimit=a.getLayoutValue("line-round-limit",b)}}();g.LineLayout=k;k=function(){return function(a,b,c){this.allowOverlap=a.getLayoutValue("icon-allow-overlap",b);this.ignorePlacement=
a.getLayoutValue("icon-ignore-placement",b);this.optional=a.getLayoutValue("icon-optional",b);this.rotationAlignment=a.getLayoutValue("icon-rotation-alignment",b);this.size=a.getLayoutValue("icon-size",b);this.rotate=a.getLayoutValue("icon-rotate",b);this.padding=a.getLayoutValue("icon-padding",b);this.keepUpright=a.getLayoutValue("icon-keep-upright",b);this.offset=a.getLayoutValue("icon-offset",b);c&&(1===this.rotationAlignment&&!a.hasLayoutProperty("icon-rotation-alignment"))&&(this.rotationAlignment=
0)}}();g.IconLayout=k;k=function(){return function(a,b,c){this.allowOverlap=a.getLayoutValue("text-allow-overlap",b);this.ignorePlacement=a.getLayoutValue("text-ignore-placement",b);this.optional=a.getLayoutValue("text-optional",b);this.rotationAlignment=a.getLayoutValue("text-rotation-alignment",b);this.font=a.getLayoutValue("text-font",b);this.maxWidth=a.getLayoutValue("text-max-width",b);this.lineHeight=a.getLayoutValue("text-line-height",b);this.letterSpacing=a.getLayoutValue("text-letter-spacing",
b);this.justify=a.getLayoutValue("text-justify",b);this.anchor=a.getLayoutValue("text-anchor",b);this.maxAngle=a.getLayoutValue("text-max-angle",b);this.size=a.getLayoutValue("text-size",b);this.rotate=a.getLayoutValue("text-rotate",b);this.padding=a.getLayoutValue("text-padding",b);this.keepUpright=a.getLayoutValue("text-keep-upright",b);this.transform=a.getLayoutValue("text-transform",b);this.offset=a.getLayoutValue("text-offset",b);c&&(1===this.rotationAlignment&&!a.hasLayoutProperty("text-rotation-alignment"))&&
(this.rotationAlignment=0)}}();g.TextLayout=k})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(k,g){var a=function(){function a(){}a.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"}};a.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"}};a.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"line-cap":{type:"enum",
values:["butt","round","square"],"default":"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],"default":"miter"},"line-miter-limit":{type:"number","default":2},"line-round-limit":{type:"number","default":1.05}};a.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"symbol-placement":{type:"enum",values:["point","line"],"default":"point"},"symbol-spacing":{type:"number",minimum:1,"default":250},"symbol-avoid-edges":{type:"boolean","default":!1},
"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean","default":!1},"icon-ignore-placement":{type:"boolean","default":!1},"icon-optional":{type:"boolean","default":!1},"icon-rotation-alignment":{type:"enum",values:["map","viewport"],"default":"viewport"},"icon-size":{type:"number",minimum:0,"default":1},"icon-rotate":{type:"number","default":0},"icon-padding":{type:"number",minimum:0,"default":2},"icon-keep-upright":{type:"boolean","default":!0},"icon-offset":{type:"array",value:"number",
length:2,"default":[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport"],"default":"viewport"},"text-font":{type:"array",value:"string","default":["Open Sans Regular","Arial Unicode MS Regular"]},"text-size":{type:"number",minimum:0,"default":16},"text-max-width":{type:"number",minimum:0,"default":10},"text-line-height":{type:"number","default":1.2},"text-letter-spacing":{type:"number","default":0},"text-justify":{type:"enum",values:["left","center",
"right"],"default":"center"},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),"default":"center"},"text-max-angle":{type:"number",minimum:0,"default":45},"text-rotate":{type:"number","default":0},"text-padding":{type:"number",minimum:0,"default":2},"text-keep-upright":{type:"boolean","default":!0},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],"default":"none"},"text-offset":{type:"array",value:"number",
length:2,"default":[0,0]},"text-allow-overlap":{type:"boolean","default":!1},"text-ignore-placement":{type:"boolean","default":!1},"text-optional":{type:"boolean","default":!1}};a.backgroundPaintDefinition={"background-opacity":{type:"number",minimum:0,maximum:1,"default":1},"background-color":{type:"color","default":[0,0,0,1]},"background-pattern":{type:"string"}};a.fillPaintDefinition={"fill-opacity":{type:"number",minimum:0,maximum:1,"default":1},"fill-antialias":{type:"boolean","default":!0},
"fill-color":{type:"color","default":[0,0,0,1]},"fill-outline-color":{type:"color","default":[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"fill-pattern":{type:"string"}};a.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,"default":1},"line-color":{type:"color","default":[0,0,0,1]},"line-translate":{type:"array",value:"number",length:2,"default":[0,0]},"line-translate-anchor":{type:"enum",
values:["map","viewport"],"default":"map"},"line-width":{type:"number",minimum:0,"default":1},"line-gap-width":{type:"number",minimum:0,"default":0},"line-offset":{type:"number","default":0},"line-blur":{type:"number",minimum:0,"default":0},"line-dasharray":{type:"array",value:"number","default":[]},"line-pattern":{type:"string"}};a.symbolPaintDefinition={"icon-opacity":{type:"number",minimum:0,maximum:1,"default":1},"icon-color":{type:"color","default":[0,0,0,1]},"icon-halo-color":{type:"color",
"default":[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,"default":0},"icon-halo-blur":{type:"number",minimum:0,"default":0},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"text-opacity":{type:"number",minimum:0,maximum:1,"default":1},"text-color":{type:"color","default":[0,0,0,1]},"text-halo-color":{type:"color","default":[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,"default":0},
"text-halo-blur":{type:"number",minimum:0,"default":0},"text-translate":{type:"array",value:"number",length:2,"default":[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}};a.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,"default":1},"raster-hue-rotate":{type:"number","default":0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,"default":0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,"default":1},"raster-saturation":{type:"number",
minimum:-1,maximum:1,"default":0},"raster-contrast":{type:"number",minimum:-1,maximum:1,"default":0},"raster-fade-duration":{type:"number",minimum:0,"default":300}};a.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,"default":1},"circle-radius":{type:"number",minimum:0,"default":5},"circle-color":{type:"color","default":[0,0,0,1]},"circle-blur":{type:"number",minimum:0,"default":0},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0]},"circle-translate-anchor":{type:"enum",
values:["map","viewport"],"default":"map"}};return a}();g.StyleDefinition=a})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleProperty":function(){define(["require","exports","../../../Color","../GeometryUtils"],function(k,g,a,b){return function(){function c(a,b){var f;switch(a.type){case "number":f=!0;break;case "color":f=!0;b=c._parseColor(b);break;case "array":f="number"===a.value;break;default:f=!1}this.getValue=f?this._interpolate(b):this._piecewise(b)}c.prototype._piecewise=function(a){var b=
a.stops;return b?function(a){var c=b.length;if(0!==c){for(var d=0,l=0;l<c;l++)if(b[l][0]<=a)d=l;else break;return b[d][1]}}:function(){return a}};c.prototype._interpolate=function(a){var c=a.stops;if(c){var f=a.base||1;return function(a){for(var d,l,n=c.length,p=0;p<n;p++){var s=c[p];if(s[0]<=a)d=s;else{l=s;break}}if(d&&l){p=l[0]-d[0];a-=d[0];a=1===f?a/p:(Math.pow(f,a)-1)/(Math.pow(f,p)-1);if(Array.isArray(d[1])){d=d[1];l=l[1];n=[];for(p=0;p<d.length;p++)n.push(b.interpolate(d[p],l[p],a));return n}return b.interpolate(d[1],
l[1],a)}if(d)return d[1];if(l)return l[1]}}return function(){return a}};c._parseColor=function(b){if(Array.isArray(b))return b;if("string"===typeof b){var e=new a(b);if(e)return[e.r/255,e.g/255,e.b/255,e.a||1]}if(b&&b.stops)return b.stops=b.stops.map(function(a){return[a[0],c._parseColor(a[1])]}),b;throw Error("Incorrect color definition "+b);};return c}()})},"esri/layers/vectorTiles/Color":function(){define(["require","exports","esri/Color"],function(k,g,a){return function(){return function(b){return new a(b)}}()})},
"esri/layers/vectorTiles/views/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(k,g){function a(a,b){a%=b;return 0<=a?a:a+b}g.C_INFINITY=Number.POSITIVE_INFINITY;g.C_PI=Math.PI;g.C_2PI=2*g.C_PI;g.C_PI_BY_2=g.C_PI/2;g.C_RAD_TO_256=128/g.C_PI;g.C_256_TO_RAD=g.C_PI/128;g.C_DEG_TO_256=256/360;g.C_DEG_TO_RAD=g.C_PI/180;g.C_SQRT2=1.414213562;g.C_SQRT2_INV=1/g.C_SQRT2;var b=1/Math.LN2;g.positiveMod=a;g.radToByte=function(b){return a(b*g.C_RAD_TO_256,256)};g.degToByte=function(b){return a(b*
g.C_DEG_TO_256,256)};g.log2=function(a){return Math.log(a)*b};g.sqr=function(a){return a*a};g.clamp=function(a,b,e){return Math.min(Math.max(a,b),e)};g.interpolate=function(a,b,e){return a*(1-e)+b*e}})},"esri/layers/vectorTiles/views/vectorTiles/style/Filter":function(){define(["require","exports"],function(k,g){return function(){function a(b,c,d){this._op=b;"$type"===c?(this._val=a._types.indexOf(d),this._op+=11):(this._key=c,this._val=d)}a.prototype.filter=function(a){switch(this._op){case 0:return this._val;
case 1:return a.values[this._key]===this._val;case 2:return a.values[this._key]!==this._val;case 3:return a.values[this._key]<this._val;case 4:return a.values[this._key]>this._val;case 5:return a.values[this._key]>=this._val;case 6:return a.values[this._key]<=this._val;case 7:return-1!==this._val.indexOf(a.values[this._key]);case 8:return-1===this._val.indexOf(a.values[this._key]);case 9:for(var c=0,d=this._val;c<d.length;c++){var e=d[c];if(e.filter(a))return!0}return!1;case 10:c=0;for(d=this._val;c<
d.length;c++)if(e=d[c],!e.filter(a))return!1;return!0;case 11:c=0;for(d=this._val;c<d.length;c++)if(e=d[c],e.filter(a))return!1;return!0;case 12:return a.type===this._val;case 13:return a.type!==this._val;case 14:return a.type<this._val;case 15:return a.type>this._val;case 16:return a.type>=this._val;case 17:return a.type<=this._val;case 18:return-1!==this._val.indexOf(a.type);case 19:return-1===this._val.indexOf(a.type)}};a.createFilter=function(b){if(!b)return new a(0,void 0,!0);var c=b[0];if(1>=
b.length)return new a(0,void 0,"any"!==c);switch(c){case "\x3d\x3d":return new a(1,b[1],b[2]);case "!\x3d":return new a(2,b[1],b[2]);case "\x3e":return new a(4,b[1],b[2]);case "\x3c":return new a(3,b[1],b[2]);case "\x3e\x3d":return new a(6,b[1],b[2]);case "\x3c\x3d":return new a(5,b[1],b[2]);case "in":return new a(7,b[1],b.slice(2));case "!in":return new a(8,b[1],b.slice(2));case "any":return new a(9,void 0,b.slice(1).map(a.createFilter.bind(this)));case "all":return new a(10,void 0,b.slice(1).map(a.createFilter.bind(this)));
case "none":return new a(11,void 0,b.slice(1).map(a.createFilter.bind(this)));default:throw Error("invalid operator: "+c);}};a._types=["Unknown","Point","LineString","Polygon"];return a}()})},"esri/layers/vectorTiles/views/vectorTiles/VectorTileContainer":function(){define("require exports ../../core/tsSupport/extendsHelper dojo/has ../../core/libs/gl-matrix/vec3 ../../core/libs/gl-matrix/mat4 ../2d/engine/Container ./renderers/Renderer ./GeometryUtils ./StencilClipGenerator".split(" "),function(k,
g,a,b,c,d,e,f,h,m){var l=b("dojo-debug-messages");return function(b){function e(){b.call(this);this.isInitialized=!1;this._displayHeight=this._displayWidth=0;this._clip=new m;this._tileCoordinateScale=c.create();this._orientationVec=c.create();this._displayScale=c.create();this._orientationVec.set([0,0,1]);this._defaultTransform=d.create()}a(e,b);e.prototype.initialize=function(a,b,c,d){this._renderer=new f(a,b);this._tileInfoView=d;this._tileInfo=c;this.isInitialized=!0};e.prototype.prepareChildrenRenderParameters=
function(a){var b=a.state;if(!b||!this._tileInfo||!this.isInitialized)return a;a.displayLevel=this._tileInfo.scaleToZoom(b.scale);a.requiredLevel=this._tileInfoView.getClosestInfoForScale(b.scale).level;a.renderer=this._renderer;return a};e.prototype.renderChildren=function(a){if(!(0===this.children.length||!this.isInitialized||!a||!a.state)){this.sortChildren(function(a,b){return b.resolution-a.resolution});this._clip.update(this.children);this._updateTilesTransform(a.state,this._tileInfoView.getClosestInfoForScale(a.state.scale).level);
var c=a.context;c.setDepthWriteEnabled(!0);this._renderer.setStateParams(a.state,a.devicePixelRatio,a.displayLevel);this._renderer.drawClippingMasks(c,this.children);c.setStencilWriteMask(0);c.setBlendFunctionSeparate(770,771,1,771);c.setStencilOp(7680,7680,7681);c.setDepthFunction(515);c.setBlendingEnabled(!1);c.setStencilTestEnabled(!0);c.setDepthTestEnabled(!0);c.setDepthWriteEnabled(!0);a.drawphase=0;b.prototype.renderChildren.call(this,a);c.setDepthWriteEnabled(!1);c.setBlendingEnabled(!0);a.drawphase=
1;b.prototype.renderChildren.call(this,a);a.drawphase=2;b.prototype.renderChildren.call(this,a);c.setStencilTestEnabled(!1);c.setDepthTestEnabled(!1);if(l){a=0;for(var d=this.children;a<d.length;a++){var e=d[a];e.attached&&e.visible&&this._renderer.renderTileInfo(c,e)}}this._renderer.needsRedraw()&&this.requestRender()}};e.prototype.attachChild=function(a,b){return a.attach(b)};e.prototype.detachChild=function(a,b){a.detach(b)};e.prototype.renderChild=function(a,b){a.render(b)};e.prototype._updateTilesTransform=
function(a,b){var c=1/a.width,d=1/a.height,e=[0,0];this._calculateRelativeViewProjMat(this._tileInfo.lods[b].resolution,a.resolution,a.rotation,this._tileInfo.size[1],4096,a.width,a.height,this._defaultTransform);for(var f=0,h=this.children;f<h.length;f++){var l=h[f];a.toScreen(e,l.topLeft);e[1]=a.height-e[1];l.tileTransform.displayCoord[0]=2*e[0]*c-1;l.tileTransform.displayCoord[1]=2*e[1]*d-1;l.key.level===b&&4096===l.coordRange?l.tileTransform.transform.set(this._defaultTransform):this._calculateRelativeViewProjMat(this._tileInfo.lods[l.key.level].resolution,
a.resolution,a.rotation,this._tileInfo.size[1],l.coordRange,a.width,a.height,l.tileTransform.transform)}};e.prototype._calculateRelativeViewProjMat=function(a,b,c,e,f,l,m,p){var n=0.125;512!==e&&4096!==f&&(n=e/f);a=n*(a/b);this._tileCoordinateScale.set([a,a,1]);if(l!==this._displayWidth||m!==this._displayHeight)this._displayScale.set([2/l,-2/m,1]),this._displayWidth=l,this._displayHeight=m;d.identity(p);d.scale(p,p,this._tileCoordinateScale);d.rotate(p,p,-c*h.C_DEG_TO_RAD,this._orientationVec);d.scale(p,
p,this._displayScale);d.transpose(p,p)};return e}(e)})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec3":function(){define(["./common"],function(k){var g={create:function(){var a=new k.ARRAY_TYPE(3);a[0]=0;a[1]=0;a[2]=0;return a},clone:function(a){var b=new k.ARRAY_TYPE(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},fromValues:function(a,b,c){var d=new k.ARRAY_TYPE(3);d[0]=a;d[1]=b;d[2]=c;return d},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a},set:function(a,b,c,d){a[0]=b;a[1]=c;a[2]=d;
return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];return a}};g.sub=g.subtract;g.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];return a};g.mul=g.multiply;g.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];return a};g.div=g.divide;g.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);return a};g.floor=function(a,b){a[0]=Math.floor(b[0]);
a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);return a};g.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);return a};g.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);return a};g.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);return a};g.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;return a};g.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;
a[2]=b[2]+c[2]*d;return a};g.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)};g.dist=g.distance;g.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return c*c+d*d+e*e};g.sqrDist=g.squaredDistance;g.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};g.len=g.length;g.squaredLength=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};g.sqrLen=g.squaredLength;g.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=
-b[2];return a};g.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];return a};g.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],c=c*c+d*d+e*e;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c);return a};g.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};g.cross=function(a,b,c){var d=b[0],e=b[1];b=b[2];var f=c[0],h=c[1];c=c[2];a[0]=e*c-b*h;a[1]=b*f-d*c;a[2]=d*h-e*f;return a};g.lerp=function(a,b,c,d){var e=b[0],f=b[1];b=b[2];a[0]=e+d*(c[0]-e);a[1]=f+d*(c[1]-f);a[2]=b+d*(c[2]-
b);return a};g.hermite=function(a,b,c,d,e,f){var h=f*f,m=h*(2*f-3)+1,l=h*(f-2)+f,n=h*(f-1);f=h*(3-2*f);a[0]=b[0]*m+c[0]*l+d[0]*n+e[0]*f;a[1]=b[1]*m+c[1]*l+d[1]*n+e[1]*f;a[2]=b[2]*m+c[2]*l+d[2]*n+e[2]*f;return a};g.bezier=function(a,b,c,d,e,f){var h=1-f,m=h*h,l=f*f,n=m*h,m=3*f*m,h=3*l*h;f*=l;a[0]=b[0]*n+c[0]*m+d[0]*h+e[0]*f;a[1]=b[1]*n+c[1]*m+d[1]*h+e[1]*f;a[2]=b[2]*n+c[2]*m+d[2]*h+e[2]*f;return a};g.random=function(a,b){b=b||1;var c=2*k.RANDOM()*Math.PI,d=2*k.RANDOM()-1,e=Math.sqrt(1-d*d)*b;a[0]=
Math.cos(c)*e;a[1]=Math.sin(c)*e;a[2]=d*b;return a};g.transformMat4=function(a,b,c){var d=b[0],e=b[1];b=b[2];var f=c[3]*d+c[7]*e+c[11]*b+c[15],f=f||1;a[0]=(c[0]*d+c[4]*e+c[8]*b+c[12])/f;a[1]=(c[1]*d+c[5]*e+c[9]*b+c[13])/f;a[2]=(c[2]*d+c[6]*e+c[10]*b+c[14])/f;return a};g.transformMat3=function(a,b,c){var d=b[0],e=b[1];b=b[2];a[0]=d*c[0]+e*c[3]+b*c[6];a[1]=d*c[1]+e*c[4]+b*c[7];a[2]=d*c[2]+e*c[5]+b*c[8];return a};g.transformQuat=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=c[0];var h=c[1],m=c[2];c=c[3];
var l=c*d+h*f-m*e,n=c*e+m*d-b*f,p=c*f+b*e-h*d,d=-b*d-h*e-m*f;a[0]=l*c+d*-b+n*-m-p*-h;a[1]=n*c+d*-h+p*-b-l*-m;a[2]=p*c+d*-m+l*-h-n*-b;return a};g.rotateX=function(a,b,c,d){var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[0];f[1]=e[1]*Math.cos(d)-e[2]*Math.sin(d);f[2]=e[1]*Math.sin(d)+e[2]*Math.cos(d);a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a};g.rotateY=function(a,b,c,d){var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[2]*Math.sin(d)+e[0]*Math.cos(d);f[1]=
e[1];f[2]=e[2]*Math.cos(d)-e[0]*Math.sin(d);a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a};g.rotateZ=function(a,b,c,d){var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[0]*Math.cos(d)-e[1]*Math.sin(d);f[1]=e[0]*Math.sin(d)+e[1]*Math.cos(d);f[2]=e[2];a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a};g.forEach=function(){var a=g.create();return function(b,c,d,e,f,h){c||(c=3);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],f(a,
a,h),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2];return b}}();g.angle=function(a,b){var c=g.fromValues(a[0],a[1],a[2]),d=g.fromValues(b[0],b[1],b[2]);g.normalize(c,c);g.normalize(d,d);c=g.dot(c,d);return 1<c?0:Math.acos(c)};g.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};g.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]};g.equals=function(a,b){var c=a[0],d=a[1],e=a[2],f=b[0],h=b[1],m=b[2];return Math.abs(c-f)<=k.EPSILON*Math.max(1,Math.abs(c),Math.abs(f))&&Math.abs(d-h)<=
k.EPSILON*Math.max(1,Math.abs(d),Math.abs(h))&&Math.abs(e-m)<=k.EPSILON*Math.max(1,Math.abs(e),Math.abs(m))};return g})},"esri/layers/vectorTiles/core/libs/gl-matrix/common":function(){define([],function(){var k={EPSILON:1E-6};k.ARRAY_TYPE="undefined"!==typeof Float32Array?Float32Array:Array;k.RANDOM=Math.random;k.ENABLE_SIMD=!1;k.SIMD_AVAILABLE=k.ARRAY_TYPE===Float32Array&&"SIMD"in this;k.USE_SIMD=k.ENABLE_SIMD&&k.SIMD_AVAILABLE;k.setMatrixArrayType=function(a){k.ARRAY_TYPE=a};var g=Math.PI/180;
k.toRadian=function(a){return a*g};k.equals=function(a,b){return Math.abs(a-b)<=k.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};return k})},"esri/layers/vectorTiles/core/libs/gl-matrix/mat4":function(){define(["./common"],function(k){var g={scalar:{},SIMD:{},create:function(){var a=new k.ARRAY_TYPE(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},clone:function(a){var b=new k.ARRAY_TYPE(16);b[0]=a[0];b[1]=a[1];b[2]=
a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},fromValues:function(a,b,c,d,e,f,h,m,l,n,p,s,g,q,t,x){var u=new k.ARRAY_TYPE(16);u[0]=a;u[1]=b;u[2]=c;u[3]=d;u[4]=e;u[5]=f;u[6]=h;u[7]=m;u[8]=l;
u[9]=n;u[10]=p;u[11]=s;u[12]=g;u[13]=q;u[14]=t;u[15]=x;return u},set:function(a,b,c,d,e,f,h,m,l,n,p,s,g,q,t,x,u){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=h;a[6]=m;a[7]=l;a[8]=n;a[9]=p;a[10]=s;a[11]=g;a[12]=q;a[13]=t;a[14]=x;a[15]=u;return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}};g.scalar.transpose=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],h=b[7],m=b[11];a[1]=b[4];a[2]=b[8];
a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=f;a[11]=b[14];a[12]=e;a[13]=h;a[14]=m}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a};g.SIMD.transpose=function(a,b){var c,d,e,f,h,m,l;c=SIMD.Float32x4.load(b,0);d=SIMD.Float32x4.load(b,4);e=SIMD.Float32x4.load(b,8);f=SIMD.Float32x4.load(b,12);h=SIMD.Float32x4.shuffle(c,d,0,1,4,5);m=SIMD.Float32x4.shuffle(e,f,
0,1,4,5);l=SIMD.Float32x4.shuffle(h,m,0,2,4,6);h=SIMD.Float32x4.shuffle(h,m,1,3,5,7);SIMD.Float32x4.store(a,0,l);SIMD.Float32x4.store(a,4,h);h=SIMD.Float32x4.shuffle(c,d,2,3,6,7);m=SIMD.Float32x4.shuffle(e,f,2,3,6,7);c=SIMD.Float32x4.shuffle(h,m,0,2,4,6);d=SIMD.Float32x4.shuffle(h,m,1,3,5,7);SIMD.Float32x4.store(a,8,c);SIMD.Float32x4.store(a,12,d);return a};g.transpose=k.USE_SIMD?g.SIMD.transpose:g.scalar.transpose;g.scalar.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=b[4],m=b[5],l=b[6],
n=b[7],p=b[8],s=b[9],g=b[10],q=b[11],t=b[12],x=b[13],u=b[14],k=b[15],v=c*m-d*h,y=c*l-e*h,z=c*n-f*h,A=d*l-e*m,C=d*n-f*m,F=e*n-f*l,G=p*x-s*t,J=p*u-g*t,E=p*k-q*t,H=s*u-g*x,N=s*k-q*x,L=g*k-q*u,I=v*L-y*N+z*H+A*E-C*J+F*G;if(!I)return null;I=1/I;a[0]=(m*L-l*N+n*H)*I;a[1]=(e*N-d*L-f*H)*I;a[2]=(x*F-u*C+k*A)*I;a[3]=(g*C-s*F-q*A)*I;a[4]=(l*E-h*L-n*J)*I;a[5]=(c*L-e*E+f*J)*I;a[6]=(u*z-t*F-k*y)*I;a[7]=(p*F-g*z+q*y)*I;a[8]=(h*N-m*E+n*G)*I;a[9]=(d*E-c*N-f*G)*I;a[10]=(t*C-x*z+k*v)*I;a[11]=(s*z-p*C-q*v)*I;a[12]=(m*
J-h*H-l*G)*I;a[13]=(c*H-d*J+e*G)*I;a[14]=(x*y-t*A-u*v)*I;a[15]=(p*A-s*y+g*v)*I;return a};g.SIMD.invert=function(a,b){var c,d,e,f,h,m,l,n,p;m=SIMD.Float32x4.load(b,0);l=SIMD.Float32x4.load(b,4);n=SIMD.Float32x4.load(b,8);p=SIMD.Float32x4.load(b,12);h=SIMD.Float32x4.shuffle(m,l,0,1,4,5);d=SIMD.Float32x4.shuffle(n,p,0,1,4,5);c=SIMD.Float32x4.shuffle(h,d,0,2,4,6);d=SIMD.Float32x4.shuffle(d,h,1,3,5,7);h=SIMD.Float32x4.shuffle(m,l,2,3,6,7);f=SIMD.Float32x4.shuffle(n,p,2,3,6,7);e=SIMD.Float32x4.shuffle(h,
f,0,2,4,6);f=SIMD.Float32x4.shuffle(f,h,1,3,5,7);h=SIMD.Float32x4.mul(e,f);h=SIMD.Float32x4.swizzle(h,1,0,3,2);m=SIMD.Float32x4.mul(d,h);l=SIMD.Float32x4.mul(c,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,h),m);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,h),l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);h=SIMD.Float32x4.mul(d,e);h=SIMD.Float32x4.swizzle(h,1,0,3,2);m=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,h),m);p=SIMD.Float32x4.mul(c,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);
m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(f,h));p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,h),p);p=SIMD.Float32x4.swizzle(p,2,3,0,1);h=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,3,0,1),f);h=SIMD.Float32x4.swizzle(h,1,0,3,2);e=SIMD.Float32x4.swizzle(e,2,3,0,1);m=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,h),m);n=SIMD.Float32x4.mul(c,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(e,h));n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,h),n);n=SIMD.Float32x4.swizzle(n,2,3,0,
1);h=SIMD.Float32x4.mul(c,d);h=SIMD.Float32x4.swizzle(h,1,0,3,2);n=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,h),n);p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,h),p);h=SIMD.Float32x4.swizzle(h,2,3,0,1);n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,h),n);p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(e,h));h=SIMD.Float32x4.mul(c,f);h=SIMD.Float32x4.swizzle(h,1,0,3,2);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(e,h));n=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,h),n);h=SIMD.Float32x4.swizzle(h,2,3,0,1);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,
h),l);n=SIMD.Float32x4.sub(n,SIMD.Float32x4.mul(d,h));h=SIMD.Float32x4.mul(c,e);h=SIMD.Float32x4.swizzle(h,1,0,3,2);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,h),l);p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(d,h));h=SIMD.Float32x4.swizzle(h,2,3,0,1);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(f,h));p=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,h),p);c=SIMD.Float32x4.mul(c,m);c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c);c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c);h=SIMD.Float32x4.reciprocalApproximation(c);
c=SIMD.Float32x4.sub(SIMD.Float32x4.add(h,h),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(h,h)));c=SIMD.Float32x4.swizzle(c,0,0,0,0);if(!c)return null;SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(c,m));SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(c,l));SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(c,n));SIMD.Float32x4.store(a,12,SIMD.Float32x4.mul(c,p));return a};g.invert=k.USE_SIMD?g.SIMD.invert:g.scalar.invert;g.scalar.adjoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=b[4],m=b[5],l=b[6],n=b[7],p=b[8],
s=b[9],g=b[10],q=b[11],t=b[12],k=b[13],u=b[14],w=b[15];a[0]=m*(g*w-q*u)-s*(l*w-n*u)+k*(l*q-n*g);a[1]=-(d*(g*w-q*u)-s*(e*w-f*u)+k*(e*q-f*g));a[2]=d*(l*w-n*u)-m*(e*w-f*u)+k*(e*n-f*l);a[3]=-(d*(l*q-n*g)-m*(e*q-f*g)+s*(e*n-f*l));a[4]=-(h*(g*w-q*u)-p*(l*w-n*u)+t*(l*q-n*g));a[5]=c*(g*w-q*u)-p*(e*w-f*u)+t*(e*q-f*g);a[6]=-(c*(l*w-n*u)-h*(e*w-f*u)+t*(e*n-f*l));a[7]=c*(l*q-n*g)-h*(e*q-f*g)+p*(e*n-f*l);a[8]=h*(s*w-q*k)-p*(m*w-n*k)+t*(m*q-n*s);a[9]=-(c*(s*w-q*k)-p*(d*w-f*k)+t*(d*q-f*s));a[10]=c*(m*w-n*k)-h*(d*
w-f*k)+t*(d*n-f*m);a[11]=-(c*(m*q-n*s)-h*(d*q-f*s)+p*(d*n-f*m));a[12]=-(h*(s*u-g*k)-p*(m*u-l*k)+t*(m*g-l*s));a[13]=c*(s*u-g*k)-p*(d*u-e*k)+t*(d*g-e*s);a[14]=-(c*(m*u-l*k)-h*(d*u-e*k)+t*(d*l-e*m));a[15]=c*(m*g-l*s)-h*(d*g-e*s)+p*(d*l-e*m);return a};g.SIMD.adjoint=function(a,b){var c,d,e,f,h,m,l,n,p;c=SIMD.Float32x4.load(b,0);d=SIMD.Float32x4.load(b,4);e=SIMD.Float32x4.load(b,8);f=SIMD.Float32x4.load(b,12);l=SIMD.Float32x4.shuffle(c,d,0,1,4,5);m=SIMD.Float32x4.shuffle(e,f,0,1,4,5);h=SIMD.Float32x4.shuffle(l,
m,0,2,4,6);m=SIMD.Float32x4.shuffle(m,l,1,3,5,7);l=SIMD.Float32x4.shuffle(c,d,2,3,6,7);d=SIMD.Float32x4.shuffle(e,f,2,3,6,7);c=SIMD.Float32x4.shuffle(l,d,0,2,4,6);d=SIMD.Float32x4.shuffle(d,l,1,3,5,7);l=SIMD.Float32x4.mul(c,d);l=SIMD.Float32x4.swizzle(l,1,0,3,2);e=SIMD.Float32x4.mul(m,l);f=SIMD.Float32x4.mul(h,l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(m,l),e);f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,l),f);f=SIMD.Float32x4.swizzle(f,2,3,0,1);l=SIMD.Float32x4.mul(m,
c);l=SIMD.Float32x4.swizzle(l,1,0,3,2);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,l),e);p=SIMD.Float32x4.mul(h,l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(d,l));p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,l),p);p=SIMD.Float32x4.swizzle(p,2,3,0,1);l=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,2,3,0,1),d);l=SIMD.Float32x4.swizzle(l,1,0,3,2);c=SIMD.Float32x4.swizzle(c,2,3,0,1);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,l),e);n=SIMD.Float32x4.mul(h,l);l=SIMD.Float32x4.swizzle(l,
2,3,0,1);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(c,l));n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,l),n);n=SIMD.Float32x4.swizzle(n,2,3,0,1);l=SIMD.Float32x4.mul(h,m);l=SIMD.Float32x4.swizzle(l,1,0,3,2);n=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,l),n);p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,l),p);l=SIMD.Float32x4.swizzle(l,2,3,0,1);n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,l),n);p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(c,l));l=SIMD.Float32x4.mul(h,d);l=SIMD.Float32x4.swizzle(l,1,0,3,2);f=SIMD.Float32x4.sub(f,
SIMD.Float32x4.mul(c,l));n=SIMD.Float32x4.add(SIMD.Float32x4.mul(m,l),n);l=SIMD.Float32x4.swizzle(l,2,3,0,1);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,l),f);n=SIMD.Float32x4.sub(n,SIMD.Float32x4.mul(m,l));l=SIMD.Float32x4.mul(h,c);l=SIMD.Float32x4.swizzle(l,1,0,3,2);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,l),f);p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(m,l));l=SIMD.Float32x4.swizzle(l,2,3,0,1);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(d,l));p=SIMD.Float32x4.add(SIMD.Float32x4.mul(m,l),p);SIMD.Float32x4.store(a,
0,e);SIMD.Float32x4.store(a,4,f);SIMD.Float32x4.store(a,8,n);SIMD.Float32x4.store(a,12,p);return a};g.adjoint=k.USE_SIMD?g.SIMD.adjoint:g.scalar.adjoint;g.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],h=a[5],m=a[6],l=a[7],n=a[8],p=a[9],g=a[10],r=a[11],q=a[12],t=a[13],k=a[14];a=a[15];return(b*h-c*f)*(g*a-r*k)-(b*m-d*f)*(p*a-r*t)+(b*l-e*f)*(p*k-g*t)+(c*m-d*h)*(n*a-r*q)-(c*l-e*h)*(n*k-g*q)+(d*l-e*m)*(n*t-p*q)};g.SIMD.multiply=function(a,b,c){var d=SIMD.Float32x4.load(b,0),e=SIMD.Float32x4.load(b,
4),f=SIMD.Float32x4.load(b,8);b=SIMD.Float32x4.load(b,12);var h=SIMD.Float32x4.load(c,0),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),b))));SIMD.Float32x4.store(a,0,h);h=SIMD.Float32x4.load(c,4);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,
0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),b))));SIMD.Float32x4.store(a,4,h);h=SIMD.Float32x4.load(c,8);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,
3,3,3,3),b))));SIMD.Float32x4.store(a,8,h);c=SIMD.Float32x4.load(c,12);d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),b))));SIMD.Float32x4.store(a,12,d);return a};g.scalar.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],h=b[3],m=b[4],l=b[5],n=b[6],p=b[7],g=b[8],r=b[9],
q=b[10],t=b[11],k=b[12],u=b[13],w=b[14];b=b[15];var v=c[0],y=c[1],z=c[2],A=c[3];a[0]=v*d+y*m+z*g+A*k;a[1]=v*e+y*l+z*r+A*u;a[2]=v*f+y*n+z*q+A*w;a[3]=v*h+y*p+z*t+A*b;v=c[4];y=c[5];z=c[6];A=c[7];a[4]=v*d+y*m+z*g+A*k;a[5]=v*e+y*l+z*r+A*u;a[6]=v*f+y*n+z*q+A*w;a[7]=v*h+y*p+z*t+A*b;v=c[8];y=c[9];z=c[10];A=c[11];a[8]=v*d+y*m+z*g+A*k;a[9]=v*e+y*l+z*r+A*u;a[10]=v*f+y*n+z*q+A*w;a[11]=v*h+y*p+z*t+A*b;v=c[12];y=c[13];z=c[14];A=c[15];a[12]=v*d+y*m+z*g+A*k;a[13]=v*e+y*l+z*r+A*u;a[14]=v*f+y*n+z*q+A*w;a[15]=v*h+y*
p+z*t+A*b;return a};g.multiply=k.USE_SIMD?g.SIMD.multiply:g.scalar.multiply;g.mul=g.multiply;g.scalar.translate=function(a,b,c){var d=c[0],e=c[1];c=c[2];var f,h,m,l,n,p,g,r,q,t,k,u;b===a?(a[12]=b[0]*d+b[4]*e+b[8]*c+b[12],a[13]=b[1]*d+b[5]*e+b[9]*c+b[13],a[14]=b[2]*d+b[6]*e+b[10]*c+b[14],a[15]=b[3]*d+b[7]*e+b[11]*c+b[15]):(f=b[0],h=b[1],m=b[2],l=b[3],n=b[4],p=b[5],g=b[6],r=b[7],q=b[8],t=b[9],k=b[10],u=b[11],a[0]=f,a[1]=h,a[2]=m,a[3]=l,a[4]=n,a[5]=p,a[6]=g,a[7]=r,a[8]=q,a[9]=t,a[10]=k,a[11]=u,a[12]=
f*d+n*e+q*c+b[12],a[13]=h*d+p*e+t*c+b[13],a[14]=m*d+g*e+k*c+b[14],a[15]=l*d+r*e+u*c+b[15]);return a};g.SIMD.translate=function(a,b,c){var d=SIMD.Float32x4.load(b,0),e=SIMD.Float32x4.load(b,4),f=SIMD.Float32x4.load(b,8),h=SIMD.Float32x4.load(b,12);c=SIMD.Float32x4(c[0],c[1],c[2],0);b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11]);d=SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,0,0,0,0));e=SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(c,
1,1,1,1));f=SIMD.Float32x4.mul(f,SIMD.Float32x4.swizzle(c,2,2,2,2));b=SIMD.Float32x4.add(d,SIMD.Float32x4.add(e,SIMD.Float32x4.add(f,h)));SIMD.Float32x4.store(a,12,b);return a};g.translate=k.USE_SIMD?g.SIMD.translate:g.scalar.translate;g.scalar.scale=function(a,b,c){var d=c[0],e=c[1];c=c[2];a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};g.SIMD.scale=
function(a,b,c){var d;c=SIMD.Float32x4(c[0],c[1],c[2],0);d=SIMD.Float32x4.load(b,0);SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,0,0,0,0)));d=SIMD.Float32x4.load(b,4);SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,1,1,1,1)));d=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,2,2,2,2)));a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};g.scale=k.USE_SIMD?g.SIMD.scale:g.scalar.scale;g.rotate=function(a,
b,c,d){var e=d[0],f=d[1];d=d[2];var h=Math.sqrt(e*e+f*f+d*d),m,l,n,p,g,r,q,t,x,u,w,v,y,z,A,C,F,G,J,E;if(Math.abs(h)<k.EPSILON)return null;h=1/h;e*=h;f*=h;d*=h;m=Math.sin(c);l=Math.cos(c);n=1-l;c=b[0];h=b[1];p=b[2];g=b[3];r=b[4];q=b[5];t=b[6];x=b[7];u=b[8];w=b[9];v=b[10];y=b[11];z=e*e*n+l;A=f*e*n+d*m;C=d*e*n-f*m;F=e*f*n-d*m;G=f*f*n+l;J=d*f*n+e*m;E=e*d*n+f*m;e=f*d*n-e*m;f=d*d*n+l;a[0]=c*z+r*A+u*C;a[1]=h*z+q*A+w*C;a[2]=p*z+t*A+v*C;a[3]=g*z+x*A+y*C;a[4]=c*F+r*G+u*J;a[5]=h*F+q*G+w*J;a[6]=p*F+t*G+v*J;a[7]=
g*F+x*G+y*J;a[8]=c*E+r*e+u*f;a[9]=h*E+q*e+w*f;a[10]=p*E+t*e+v*f;a[11]=g*E+x*e+y*f;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a};g.scalar.rotateX=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[4],f=b[5],h=b[6],m=b[7],l=b[8],n=b[9],p=b[10],g=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=e*c+l*d;a[5]=f*c+n*d;a[6]=h*c+p*d;a[7]=m*c+g*d;a[8]=l*c-e*d;a[9]=n*c-f*d;a[10]=p*c-h*d;a[11]=g*c-m*d;return a};g.SIMD.rotateX=
function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var e=SIMD.Float32x4.load(b,4);b=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(e,c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),SIMD.Float32x4.mul(e,d)));return a};g.rotateX=k.USE_SIMD?g.SIMD.rotateX:g.scalar.rotateX;g.scalar.rotateY=
function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],h=b[2],m=b[3],l=b[8],n=b[9],p=b[10],g=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c-l*d;a[1]=f*c-n*d;a[2]=h*c-p*d;a[3]=m*c-g*d;a[8]=e*d+l*c;a[9]=f*d+n*c;a[10]=h*d+p*c;a[11]=m*d+g*c;return a};g.SIMD.rotateY=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],
a[14]=b[14],a[15]=b[15]);var e=SIMD.Float32x4.load(b,0);b=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(e,d),SIMD.Float32x4.mul(b,c)));return a};g.rotateY=k.USE_SIMD?g.SIMD.rotateY:g.scalar.rotateY;g.scalar.rotateZ=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],h=b[2],m=b[3],l=b[4],n=b[5],p=b[6],g=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=
b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c+l*d;a[1]=f*c+n*d;a[2]=h*c+p*d;a[3]=m*c+g*d;a[4]=l*c-e*d;a[5]=n*c-f*d;a[6]=p*c-h*d;a[7]=g*c-m*d;return a};g.SIMD.rotateZ=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var e=SIMD.Float32x4.load(b,0);b=SIMD.Float32x4.load(b,4);SIMD.Float32x4.store(a,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(e,c),
SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),SIMD.Float32x4.mul(e,d)));return a};g.rotateZ=k.USE_SIMD?g.SIMD.rotateZ:g.scalar.rotateZ;g.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};g.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=
1;return a};g.fromRotation=function(a,b,c){var d=c[0],e=c[1];c=c[2];var f=Math.sqrt(d*d+e*e+c*c),h;if(Math.abs(f)<k.EPSILON)return null;f=1/f;d*=f;e*=f;c*=f;f=Math.sin(b);b=Math.cos(b);h=1-b;a[0]=d*d*h+b;a[1]=e*d*h+c*f;a[2]=c*d*h-e*f;a[3]=0;a[4]=d*e*h-c*f;a[5]=e*e*h+b;a[6]=c*e*h+d*f;a[7]=0;a[8]=d*c*h+e*f;a[9]=e*c*h-d*f;a[10]=c*c*h+b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};g.fromXRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=d;a[6]=c;a[7]=
0;a[8]=0;a[9]=-c;a[10]=d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};g.fromYRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=d;a[1]=0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=c;a[9]=0;a[10]=d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};g.fromZRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=d;a[1]=c;a[2]=0;a[3]=0;a[4]=-c;a[5]=d;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};g.fromRotationTranslation=function(a,b,c){var d=
b[0],e=b[1],f=b[2],h=b[3],m=d+d,l=e+e,n=f+f;b=d*m;var p=d*l,d=d*n,g=e*l,e=e*n,f=f*n,m=h*m,l=h*l,h=h*n;a[0]=1-(g+f);a[1]=p+h;a[2]=d-l;a[3]=0;a[4]=p-h;a[5]=1-(b+f);a[6]=e+m;a[7]=0;a[8]=d+l;a[9]=e-m;a[10]=1-(b+g);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};g.getTranslation=function(a,b){a[0]=b[12];a[1]=b[13];a[2]=b[14];return a};g.getRotation=function(a,b){var c=b[0]+b[5]+b[10],d=0;0<c?(d=2*Math.sqrt(c+1),a[3]=0.25*d,a[0]=(b[6]-b[9])/d,a[1]=(b[8]-b[2])/d,a[2]=(b[1]-b[4])/d):b[0]>b[5]&
b[0]>b[10]?(d=2*Math.sqrt(1+b[0]-b[5]-b[10]),a[3]=(b[6]-b[9])/d,a[0]=0.25*d,a[1]=(b[1]+b[4])/d,a[2]=(b[8]+b[2])/d):b[5]>b[10]?(d=2*Math.sqrt(1+b[5]-b[0]-b[10]),a[3]=(b[8]-b[2])/d,a[0]=(b[1]+b[4])/d,a[1]=0.25*d,a[2]=(b[6]+b[9])/d):(d=2*Math.sqrt(1+b[10]-b[0]-b[5]),a[3]=(b[1]-b[4])/d,a[0]=(b[8]+b[2])/d,a[1]=(b[6]+b[9])/d,a[2]=0.25*d);return a};g.fromRotationTranslationScale=function(a,b,c,d){var e=b[0],f=b[1],h=b[2],m=b[3],l=e+e,n=f+f,p=h+h;b=e*l;var g=e*n,e=e*p,r=f*n,f=f*p,h=h*p,l=m*l,n=m*n,m=m*p,
p=d[0],q=d[1];d=d[2];a[0]=(1-(r+h))*p;a[1]=(g+m)*p;a[2]=(e-n)*p;a[3]=0;a[4]=(g-m)*q;a[5]=(1-(b+h))*q;a[6]=(f+l)*q;a[7]=0;a[8]=(e+n)*d;a[9]=(f-l)*d;a[10]=(1-(b+r))*d;a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};g.fromRotationTranslationScaleOrigin=function(a,b,c,d,e){var f=b[0],h=b[1],m=b[2],l=b[3],n=f+f,p=h+h,g=m+m;b=f*n;var r=f*p,f=f*g,q=h*p,h=h*g,m=m*g,n=l*n,p=l*p,l=l*g,g=d[0],t=d[1];d=d[2];var k=e[0],u=e[1];e=e[2];a[0]=(1-(q+m))*g;a[1]=(r+l)*g;a[2]=(f-p)*g;a[3]=0;a[4]=(r-l)*t;a[5]=
(1-(b+m))*t;a[6]=(h+n)*t;a[7]=0;a[8]=(f+p)*d;a[9]=(h-n)*d;a[10]=(1-(b+q))*d;a[11]=0;a[12]=c[0]+k-(a[0]*k+a[4]*u+a[8]*e);a[13]=c[1]+u-(a[1]*k+a[5]*u+a[9]*e);a[14]=c[2]+e-(a[2]*k+a[6]*u+a[10]*e);a[15]=1;return a};g.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=c+c,m=d+d,l=e+e,c=c*h,n=d*h,d=d*m,p=e*h,g=e*m,e=e*l,h=f*h,m=f*m,f=f*l;a[0]=1-d-e;a[1]=n+f;a[2]=p-m;a[3]=0;a[4]=n-f;a[5]=1-c-e;a[6]=g+h;a[7]=0;a[8]=p+m;a[9]=g-h;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};g.frustum=
function(a,b,c,d,e,f,h){var m=1/(c-b),l=1/(e-d),n=1/(f-h);a[0]=2*f*m;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*f*l;a[6]=0;a[7]=0;a[8]=(c+b)*m;a[9]=(e+d)*l;a[10]=(h+f)*n;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*(h*f)*n;a[15]=0;return a};g.perspective=function(a,b,c,d,e){b=1/Math.tan(b/2);var f=1/(d-e);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(e+d)*f;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*e*d*f;a[15]=0;return a};g.perspectiveFromFieldOfView=function(a,b,c,d){var e=Math.tan(b.upDegrees*
Math.PI/180),f=Math.tan(b.downDegrees*Math.PI/180),h=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var m=2/(h+b),l=2/(e+f);a[0]=m;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=l;a[6]=0;a[7]=0;a[8]=-(0.5*(h-b)*m);a[9]=0.5*(e-f)*l;a[10]=d/(c-d);a[11]=-1;a[12]=0;a[13]=0;a[14]=d*c/(c-d);a[15]=0;return a};g.ortho=function(a,b,c,d,e,f,h){var m=1/(b-c),l=1/(d-e),n=1/(f-h);a[0]=-2*m;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*l;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*n;a[11]=0;a[12]=(b+c)*m;a[13]=(e+
d)*l;a[14]=(h+f)*n;a[15]=1;return a};g.lookAt=function(a,b,c,d){var e,f,h,m,l,n,p,s,r=b[0],q=b[1];b=b[2];h=d[0];m=d[1];f=d[2];p=c[0];d=c[1];e=c[2];if(Math.abs(r-p)<k.EPSILON&&Math.abs(q-d)<k.EPSILON&&Math.abs(b-e)<k.EPSILON)return g.identity(a);c=r-p;d=q-d;p=b-e;s=1/Math.sqrt(c*c+d*d+p*p);c*=s;d*=s;p*=s;e=m*p-f*d;f=f*c-h*p;h=h*d-m*c;(s=Math.sqrt(e*e+f*f+h*h))?(s=1/s,e*=s,f*=s,h*=s):h=f=e=0;m=d*h-p*f;l=p*e-c*h;n=c*f-d*e;(s=Math.sqrt(m*m+l*l+n*n))?(s=1/s,m*=s,l*=s,n*=s):n=l=m=0;a[0]=e;a[1]=m;a[2]=c;
a[3]=0;a[4]=f;a[5]=l;a[6]=d;a[7]=0;a[8]=h;a[9]=n;a[10]=p;a[11]=0;a[12]=-(e*r+f*q+h*b);a[13]=-(m*r+l*q+n*b);a[14]=-(c*r+d*q+p*b);a[15]=1;return a};g.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};g.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],
2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};g.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];a[9]=b[9]+c[9];a[10]=b[10]+c[10];a[11]=b[11]+c[11];a[12]=b[12]+c[12];a[13]=b[13]+c[13];a[14]=b[14]+c[14];a[15]=b[15]+c[15];return a};g.subtract=function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-
c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];a[9]=b[9]-c[9];a[10]=b[10]-c[10];a[11]=b[11]-c[11];a[12]=b[12]-c[12];a[13]=b[13]-c[13];a[14]=b[14]-c[14];a[15]=b[15]-c[15];return a};g.sub=g.subtract;g.multiplyScalar=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12]*c;a[13]=b[13]*c;a[14]=b[14]*c;a[15]=b[15]*c;return a};g.multiplyScalarAndAdd=
function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;a[4]=b[4]+c[4]*d;a[5]=b[5]+c[5]*d;a[6]=b[6]+c[6]*d;a[7]=b[7]+c[7]*d;a[8]=b[8]+c[8]*d;a[9]=b[9]+c[9]*d;a[10]=b[10]+c[10]*d;a[11]=b[11]+c[11]*d;a[12]=b[12]+c[12]*d;a[13]=b[13]+c[13]*d;a[14]=b[14]+c[14]*d;a[15]=b[15]+c[15]*d;return a};g.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===
b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]};g.equals=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],h=a[4],m=a[5],l=a[6],n=a[7],p=a[8],g=a[9],r=a[10],q=a[11],t=a[12],x=a[13],u=a[14],w=a[15],v=b[0],y=b[1],z=b[2],A=b[3],C=b[4],F=b[5],G=b[6],J=b[7],E=b[8],H=b[9],N=b[10],L=b[11],I=b[12],D=b[13],B=b[14],K=b[15];return Math.abs(c-v)<=k.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(d-y)<=k.EPSILON*Math.max(1,Math.abs(d),Math.abs(y))&&Math.abs(e-z)<=k.EPSILON*Math.max(1,Math.abs(e),
Math.abs(z))&&Math.abs(f-A)<=k.EPSILON*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(h-C)<=k.EPSILON*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(m-F)<=k.EPSILON*Math.max(1,Math.abs(m),Math.abs(F))&&Math.abs(l-G)<=k.EPSILON*Math.max(1,Math.abs(l),Math.abs(G))&&Math.abs(n-J)<=k.EPSILON*Math.max(1,Math.abs(n),Math.abs(J))&&Math.abs(p-E)<=k.EPSILON*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(g-H)<=k.EPSILON*Math.max(1,Math.abs(g),Math.abs(H))&&Math.abs(r-N)<=k.EPSILON*Math.max(1,Math.abs(r),Math.abs(N))&&
Math.abs(q-L)<=k.EPSILON*Math.max(1,Math.abs(q),Math.abs(L))&&Math.abs(t-I)<=k.EPSILON*Math.max(1,Math.abs(t),Math.abs(I))&&Math.abs(x-D)<=k.EPSILON*Math.max(1,Math.abs(x),Math.abs(D))&&Math.abs(u-B)<=k.EPSILON*Math.max(1,Math.abs(u),Math.abs(B))&&Math.abs(w-K)<=k.EPSILON*Math.max(1,Math.abs(w),Math.abs(K))};return g})},"esri/layers/vectorTiles/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(k,g,a,b){var c;(function(a){a[a.BEFORE=
0]="BEFORE";a[a.ATTACHING=1]="ATTACHING";a[a.DETACHING=2]="DETACHING";a[a.RENDERING=3]="RENDERING";a[a.AFTER=4]="AFTER";a[a.DONE=5]="DONE"})(c||(c={}));return function(b){function e(){b.apply(this,arguments);this._childrenToAttach=[];this._childrenToDetach=[];this._renderPhase=c.DONE;this.children=[]}a(e,b);Object.defineProperty(e.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0});e.prototype.attach=function(a){return!0};e.prototype.detach=function(a){var b=
this.children;a=this.prepareChildrenRenderParameters(a);for(var c=0,d=b.length;c<d;c++){var e=b[c];e.attached&&(this.detachChild(e,a),e.attached=!1,e.parent=null)}};e.prototype.render=function(a){var b=this.prepareChildrenRenderParameters(a);this._renderPhase=c.BEFORE;this.beforeRenderChildren(a,b);this._renderPhase=c.ATTACHING;this.attachChildren(b)||this.requestRender();this._renderPhase=c.DETACHING;for(var d=this._childrenToDetach;0<d.length;){var e=d.shift();this.detachChild(e,b);e.attached=!1;
e.parent=null}this._renderPhase=c.RENDERING;this.renderChildren(b);this._renderPhase=c.AFTER;this.afterRenderChildren(a,b);this._renderPhase=c.DONE};e.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};e.prototype.addChildAt=function(a,b){void 0===b&&(b=this.numChildren);if(this.contains(a))return a;var d=a.parent;d&&d!==this&&d.removeChild(a);b>=this.numChildren?this.children.push(a):this.children.splice(b,0,a);d=this._childrenToDetach.indexOf(a);-1<d&&this._childrenToDetach.splice(d,
1);this._childrenToAttach.push(a);this._renderPhase>=c.RENDERING&&this.requestRender();return a};e.prototype.contains=function(a){return-1<this.getChildIndex(a)};e.prototype.getChildIndex=function(a){return this.children.indexOf(a)};e.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]};e.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)};e.prototype.removeChild=function(a){var b=this.getChildIndex(a);return-1<b?this.removeChildAt(b):
a};e.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];if(a.attached)this._childrenToDetach.push(a),this._renderPhase>=c.RENDERING&&this.requestRender();else{var b=this._childrenToAttach.indexOf(a);-1<b&&this._childrenToAttach.splice(b,1)}return a};e.prototype.requestChildRender=function(a){a&&(a.parent===this&&this._renderPhase>=c.RENDERING)&&this.requestRender()};e.prototype.setChildIndex=function(a,b){var d=this.getChildIndex(a);-1<d&&
(this.children.splice(d,1),this.children.splice(b,0,a),this._renderPhase>=c.RENDERING&&this.requestRender())};e.prototype.sortChildren=function(a){this._renderPhase>c.RENDERING&&this.requestRender();return this.children.sort(a)};e.prototype.attachChildren=function(a){var b=this._childrenToAttach;if(0===b.length)return!0;for(var c=a.budget,d=c.done||0===b.length;!d;)d=b.shift(),this.attachChild(d,a)&&(d.attached=!0,d.parent=this),d=c.done||0===b.length;return 0===b.length};e.prototype.renderChildren=
function(a){for(var b=this.children,c=0,d=b.length;c<d;c++){var e=b[c];e.attached&&e.visible&&this.renderChild(e,a)}};e.prototype.beforeRenderChildren=function(a,b){};e.prototype.afterRenderChildren=function(a,b){};return e}(b)})},"esri/layers/vectorTiles/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper"],function(k,g,a){var b=0;return function(){function a(){this.attached=!1;this._visible=!0;Object.defineProperty(this,"uid",{writable:!1,
configurable:!1,value:Date.now().toString(16)+"-do-"+b++})}Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0});a.prototype.requestRender=function(){this.parent&&this.parent.requestChildRender(this)};return a}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/Renderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../GeometryUtils ./BackgroundRenderer ./LineRenderer ./FillRenderer ./SymbolRenderer ./TileInfoRenderer ./FadeRecorder".split(" "),
function(k,g,a,b,c,d,e,f,h,m){return function(){function l(a,b){this._extrudeRotateVector=new Float32Array([0,0,1]);this._extrudeScaleVector=new Float32Array([1,1,1]);this._pixelRatio=1;this._SpriteMosaic=a;this._glyphMosaic=b;this._backgroundRenderer=new c;this._lineRenderer=new d;this._fillRenderer=new e;this._symbolRenderer=new f;this._tileInfoRenderer=new h;this._fadeRecorder=new m.FadeRecorder(300);this._extrudeMatrix=new Float32Array(16);this._extrudeNoRotationMatrix=new Float32Array(16);this._backgroundColor=
new Float32Array([1,0,0,1])}l.prototype.setStateParams=function(c,d,e){this._state=c;this._pixelRatio=d;this._fadeRecorder.recordLevel(e);this._extrudeScaleVector[0]=2/c.width;this._extrudeScaleVector[1]=-2/c.height;a.identity(this._extrudeMatrix);a.rotate(this._extrudeMatrix,this._extrudeMatrix,-c.rotation*b.C_DEG_TO_RAD,this._extrudeRotateVector);a.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector);a.transpose(this._extrudeMatrix,this._extrudeMatrix);a.identity(this._extrudeNoRotationMatrix);
a.scale(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix,this._extrudeScaleVector);a.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix)};l.prototype.drawClippingMasks=function(a,b){if(0!==b.length){a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setClearStencil(0);a.clear(a.gl.STENCIL_BUFFER_BIT);for(var c=0;c<b.length;c++){var d=b[c];d.attached&&d.visible&&
(a.setStencilFunctionSeparate(1032,519,d.stencilData.reference,d.stencilData.mask),a.setStencilWriteMask(d.stencilData.mask),this._backgroundRenderer.renderSolidColor(a,{u_matrix:d.tileTransform.transform,u_normalized_origin:d.tileTransform.displayCoord,u_coord_range:d.coordRange,u_depth:0,u_color:this._backgroundColor}))}a.setColorMask(!0,!0,!0,!0);a.setBlendingEnabled(!0);a.setStencilWriteMask(255)}};l.prototype.renderDebug=function(a,b){var c=b.key;this._backgroundColor.set([c.col%2,c.row%2,0===
c.col%2&&0===c.row%2?1:0,0.5]);this._backgroundRenderer.renderSolidColor(a,{u_matrix:b.tileTransform.transform,u_normalized_origin:b.tileTransform.displayCoord,u_coord_range:b.coordRange,u_depth:0,u_color:this._backgroundColor})};l.prototype.renderBucket=function(a,b,c,d,e,f,h){switch(b.type){case 0:2!==e&&this._renderBackground(a,c,e,f,h);break;case 1:2!==e&&this._renderFill(a,b,c,e,f,h);break;case 2:1===e&&this._renderLine(a,b,c,f,h);break;case 3:2===e&&this._renderSymbol(a,b,c,d,f,h)}};l.prototype.renderTileInfo=
function(a,b){this._tileInfoRenderer.render(a,b)};l.prototype.needsRedraw=function(){return this._fadeRecorder.needsRedraw()};l.prototype._renderBackground=function(a,b,c,d,e){this._backgroundRenderer.render(a,b,c,d,e,this._SpriteMosaic,this._SpriteMosaic.pixelRatio)};l.prototype._renderLine=function(a,b,c,d,e){this._lineRenderer.render(a,b,c,this._state,d,e,this._extrudeMatrix,this._SpriteMosaic.pixelRatio)};l.prototype._renderFill=function(a,b,c,d,e,f){this._fillRenderer.render(a,b,c,this._state.rotation,
d,e,f,this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio)};l.prototype._renderSymbol=function(a,b,c,d,e,f){var h=!0;d===e.key.level&&(h=!1);a.setStencilTestEnabled(h);this._symbolRenderer.render(a,b,c,this._state.rotation,this._fadeRecorder.getFadeValues(),e,f,this._SpriteMosaic,this._glyphMosaic,this._extrudeMatrix,this._extrudeNoRotationMatrix,this._SpriteMosaic.pixelRatio)};return l}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/BackgroundRenderer":function(){define("require exports dojo/text!./shaders/background.vs.glsl dojo/text!./shaders/background.fs.glsl dojo/text!./shaders/patternFillShader.vs.glsl dojo/text!./shaders/patternFillShader.fs.glsl ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l){return function(){function n(){this._patternMatrix=e.create();this._color=f.create();this._initialized=!1}n.prototype.renderSolidColor=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix4fv("u_transformMatrix",b.u_matrix);this._solidProgram.setUniform2fv("u_normalized_origin",b.u_normalized_origin);this._solidProgram.setUniform1f("u_coord_range",b.u_coord_range||
4096);this._solidProgram.setUniform1f("u_depth",b.u_depth||0);this._solidProgram.setUniform4fv("u_color",b.u_color||new Float32Array([1,0,0,1]));a.drawArrays(5,0,4);a.bindVAO()};n.prototype.render=function(a,b,c,d,f,h,l){this._initialized||this._initialize(a);var m=f.getPaintValue("background-color",b),n=f.getPaintValue("background-opacity",b),g=f.getPaintValue("background-pattern",b),k=void 0!==g,A=m[3]*n,C=k||1>A;if(!(C&&0===c)&&(C||1!==c)){if(k){a.bindVAO(this._patternVertexArrayObject);a.bindProgram(this._patternProgram);
c=h.getMosaicItemPosition(g,!0);if(!c)return;b=d.coordRange/512/Math.pow(2,Math.floor(b)-d.key.level)/l;e.identity(this._patternMatrix);l=1/(c.size[1]*b);this._patternMatrix[0]=1/(c.size[0]*b);this._patternMatrix[4]=l;h.bind(a,9729,0);this._patternProgram.setUniformMatrix4fv("u_transformMatrix",d.tileTransform.transform);this._patternProgram.setUniform2fv("u_normalized_origin",d.tileTransform.displayCoord);this._patternProgram.setUniform1f("u_depth",f.z);this._patternProgram.setUniformMatrix3fv("u_pattern_matrix",
this._patternMatrix);this._patternProgram.setUniform1f("u_opacity",n);this._patternProgram.setUniform2f("u_pattern_tl",c.tl[0],c.tl[1]);this._patternProgram.setUniform2f("u_pattern_br",c.br[0],c.br[1]);this._patternProgram.setUniform1i("u_texture",0)}else this._color[0]=m[0],this._color[1]=m[1],this._color[2]=m[2],this._color[3]=A,a.bindVAO(this._solidVertexArrayObject),a.bindProgram(this._solidProgram),this._solidProgram.setUniformMatrix4fv("u_transformMatrix",d.tileTransform.transform),this._solidProgram.setUniform2fv("u_normalized_origin",
d.tileTransform.displayCoord),this._solidProgram.setUniform1f("u_coord_range",d.coordRange),this._solidProgram.setUniform1f("u_depth",f.z||0),this._solidProgram.setUniform4fv("u_color",this._color);a.drawArrays(5,0,4);a.bindVAO()}};n.prototype._initialize=function(e){if(this._initialized)return!0;var f={a_pos:0},n=new h(e,a,b,f);if(!n)return!1;var g=new h(e,c,d,f);if(!g)return!1;var t={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},k=new Int8Array([0,0,1,0,
0,1,1,1]),u=l.createVertex(e,35044,k),u=new m(e,f,t,{geometry:u}),k=new Int16Array([0,0,4096,0,0,4096,4096,4096]),k=l.createVertex(e,35044,k);e=new m(e,f,{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:k});this._solidProgram=n;this._patternProgram=g;this._vertexAttributes=t;this._solidVertexArrayObject=u;this._patternVertexArrayObject=e;return this._initialized=!0};return n}()})},"esri/layers/vectorTiles/core/libs/gl-matrix/mat3":function(){define(["./common"],
function(k){var g={create:function(){var a=new k.ARRAY_TYPE(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},fromMat4:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a},clone:function(a){var b=new k.ARRAY_TYPE(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];
a[8]=b[8];return a},fromValues:function(a,b,c,d,e,f,h,m,l){var n=new k.ARRAY_TYPE(9);n[0]=a;n[1]=b;n[2]=c;n[3]=d;n[4]=e;n[5]=f;n[6]=h;n[7]=m;n[8]=l;return n},set:function(a,b,c,d,e,f,h,m,l,n){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=h;a[6]=m;a[7]=l;a[8]=n;return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(a===b){var c=b[1],d=b[2],e=b[5];a[1]=b[3];a[2]=b[6];a[3]=c;a[5]=b[7];a[6]=d;a[7]=e}else a[0]=b[0],a[1]=b[3],a[2]=b[6],
a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},invert:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=b[4],m=b[5],l=b[6],n=b[7],p=b[8],g=p*h-m*n,r=-p*f+m*l,q=n*f-h*l,t=c*g+d*r+e*q;if(!t)return null;t=1/t;a[0]=g*t;a[1]=(-p*d+e*n)*t;a[2]=(m*d-e*h)*t;a[3]=r*t;a[4]=(p*c-e*l)*t;a[5]=(-m*c+e*f)*t;a[6]=q*t;a[7]=(-n*c+d*l)*t;a[8]=(h*c-d*f)*t;return a},adjoint:function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=b[4],m=b[5],l=b[6],n=b[7],p=b[8];a[0]=h*p-m*n;a[1]=e*n-d*p;a[2]=d*m-e*h;a[3]=
m*l-f*p;a[4]=c*p-e*l;a[5]=e*f-c*m;a[6]=f*n-h*l;a[7]=d*l-c*n;a[8]=c*h-d*f;return a},determinant:function(a){var b=a[3],c=a[4],d=a[5],e=a[6],f=a[7],h=a[8];return a[0]*(h*c-d*f)+a[1]*(-h*b+d*e)+a[2]*(f*b-c*e)},multiply:function(a,b,c){var d=b[0],e=b[1],f=b[2],h=b[3],m=b[4],l=b[5],n=b[6],p=b[7];b=b[8];var g=c[0],r=c[1],q=c[2],t=c[3],k=c[4],u=c[5],w=c[6],v=c[7];c=c[8];a[0]=g*d+r*h+q*n;a[1]=g*e+r*m+q*p;a[2]=g*f+r*l+q*b;a[3]=t*d+k*h+u*n;a[4]=t*e+k*m+u*p;a[5]=t*f+k*l+u*b;a[6]=w*d+v*h+c*n;a[7]=w*e+v*m+c*p;
a[8]=w*f+v*l+c*b;return a}};g.mul=g.multiply;g.translate=function(a,b,c){var d=b[0],e=b[1],f=b[2],h=b[3],m=b[4],l=b[5],n=b[6],p=b[7];b=b[8];var g=c[0];c=c[1];a[0]=d;a[1]=e;a[2]=f;a[3]=h;a[4]=m;a[5]=l;a[6]=g*d+c*h+n;a[7]=g*e+c*m+p;a[8]=g*f+c*l+b;return a};g.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],h=b[3],m=b[4],l=b[5],n=b[6],p=b[7];b=b[8];var g=Math.sin(c);c=Math.cos(c);a[0]=c*d+g*h;a[1]=c*e+g*m;a[2]=c*f+g*l;a[3]=c*h-g*d;a[4]=c*m-g*e;a[5]=c*l-g*f;a[6]=n;a[7]=p;a[8]=b;return a};g.scale=function(a,
b,c){var d=c[0];c=c[1];a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=c*b[3];a[4]=c*b[4];a[5]=c*b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};g.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=b[0];a[7]=b[1];a[8]=1;return a};g.fromRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=d;a[1]=c;a[2]=0;a[3]=-c;a[4]=d;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};g.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=b[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};g.fromMat2d=function(a,
b){a[0]=b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a};g.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=c+c,m=d+d,l=e+e,c=c*h,n=d*h,d=d*m,p=e*h,g=e*m,e=e*l,h=f*h,m=f*m,f=f*l;a[0]=1-d-e;a[3]=n-f;a[6]=p+m;a[1]=n+f;a[4]=1-c-e;a[7]=g-h;a[2]=p-m;a[5]=g+h;a[8]=1-c-d;return a};g.normalFromMat4=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=b[4],m=b[5],l=b[6],n=b[7],p=b[8],g=b[9],r=b[10],q=b[11],t=b[12],k=b[13],u=b[14],w=b[15],v=c*m-d*h,y=c*l-e*h,z=c*n-f*
h,A=d*l-e*m,C=d*n-f*m,F=e*n-f*l,G=p*k-g*t,J=p*u-r*t,p=p*w-q*t,E=g*u-r*k,g=g*w-q*k,r=r*w-q*u,q=v*r-y*g+z*E+A*p-C*J+F*G;if(!q)return null;q=1/q;a[0]=(m*r-l*g+n*E)*q;a[1]=(l*p-h*r-n*J)*q;a[2]=(h*g-m*p+n*G)*q;a[3]=(e*g-d*r-f*E)*q;a[4]=(c*r-e*p+f*J)*q;a[5]=(d*p-c*g-f*G)*q;a[6]=(k*F-u*C+w*A)*q;a[7]=(u*z-t*F-w*y)*q;a[8]=(t*C-k*z+w*v)*q;return a};g.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};g.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};g.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];return a};g.subtract=function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];return a};g.sub=g.subtract;g.multiplyScalar=
function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;return a};g.multiplyScalarAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;a[4]=b[4]+c[4]*d;a[5]=b[5]+c[5]*d;a[6]=b[6]+c[6]*d;a[7]=b[7]+c[7]*d;a[8]=b[8]+c[8]*d;return a};g.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]};g.equals=function(a,
b){var c=a[0],d=a[1],e=a[2],f=a[3],h=a[4],m=a[5],l=a[6],n=a[7],p=a[8],g=b[0],r=b[1],q=b[2],t=b[3],x=b[4],u=b[5],w=a[6],v=b[7],y=b[8];return Math.abs(c-g)<=k.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(d-r)<=k.EPSILON*Math.max(1,Math.abs(d),Math.abs(r))&&Math.abs(e-q)<=k.EPSILON*Math.max(1,Math.abs(e),Math.abs(q))&&Math.abs(f-t)<=k.EPSILON*Math.max(1,Math.abs(f),Math.abs(t))&&Math.abs(h-x)<=k.EPSILON*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(m-u)<=k.EPSILON*Math.max(1,Math.abs(m),Math.abs(u))&&
Math.abs(l-w)<=k.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(n-v)<=k.EPSILON*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(p-y)<=k.EPSILON*Math.max(1,Math.abs(p),Math.abs(y))};return g})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec4":function(){define(["./common"],function(k){var g={create:function(){var a=new k.ARRAY_TYPE(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},clone:function(a){var b=new k.ARRAY_TYPE(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},fromValues:function(a,b,c,
d){var e=new k.ARRAY_TYPE(4);e[0]=a;e[1]=b;e[2]=c;e[3]=d;return e},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},set:function(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];return a}};g.sub=g.subtract;g.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];a[3]=b[3]*c[3];return a};g.mul=
g.multiply;g.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];a[3]=b[3]/c[3];return a};g.div=g.divide;g.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);a[3]=Math.ceil(b[3]);return a};g.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);a[3]=Math.floor(b[3]);return a};g.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);a[3]=Math.min(b[3],c[3]);return a};g.max=function(a,
b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);a[3]=Math.max(b[3],c[3]);return a};g.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);a[3]=Math.round(b[3]);return a};g.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;return a};g.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;return a};g.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];
return Math.sqrt(c*c+d*d+e*e+f*f)};g.dist=g.distance;g.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return c*c+d*d+e*e+f*f};g.sqrDist=g.squaredDistance;g.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};g.len=g.length;g.squaredLength=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a};g.sqrLen=g.squaredLength;g.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=-b[3];return a};g.inverse=function(a,b){a[0]=
1/b[0];a[1]=1/b[1];a[2]=1/b[2];a[3]=1/b[3];return a};g.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],h=c*c+d*d+e*e+f*f;0<h&&(h=1/Math.sqrt(h),a[0]=c*h,a[1]=d*h,a[2]=e*h,a[3]=f*h);return a};g.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};g.lerp=function(a,b,c,d){var e=b[0],f=b[1],h=b[2];b=b[3];a[0]=e+d*(c[0]-e);a[1]=f+d*(c[1]-f);a[2]=h+d*(c[2]-h);a[3]=b+d*(c[3]-b);return a};g.random=function(a,b){b=b||1;a[0]=k.RANDOM();a[1]=k.RANDOM();a[2]=k.RANDOM();a[3]=k.RANDOM();g.normalize(a,
a);g.scale(a,a,b);return a};g.transformMat4=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];a[0]=c[0]*d+c[4]*e+c[8]*f+c[12]*b;a[1]=c[1]*d+c[5]*e+c[9]*f+c[13]*b;a[2]=c[2]*d+c[6]*e+c[10]*f+c[14]*b;a[3]=c[3]*d+c[7]*e+c[11]*f+c[15]*b;return a};g.transformQuat=function(a,b,c){var d=b[0],e=b[1],f=b[2],h=c[0],m=c[1],l=c[2];c=c[3];var n=c*d+m*f-l*e,p=c*e+l*d-h*f,g=c*f+h*e-m*d,d=-h*d-m*e-l*f;a[0]=n*c+d*-h+p*-l-g*-m;a[1]=p*c+d*-m+g*-h-n*-l;a[2]=g*c+d*-l+n*-m-p*-h;a[3]=b[3];return a};g.forEach=function(){var a=
g.create();return function(b,c,d,e,f,h){c||(c=4);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],a[3]=b[d+3],f(a,a,h),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2],b[d+3]=a[3];return b}}();g.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};g.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]};g.equals=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],h=b[0],m=b[1],l=b[2],g=b[3];return Math.abs(c-h)<=k.EPSILON*Math.max(1,
Math.abs(c),Math.abs(h))&&Math.abs(d-m)<=k.EPSILON*Math.max(1,Math.abs(d),Math.abs(m))&&Math.abs(e-l)<=k.EPSILON*Math.max(1,Math.abs(e),Math.abs(l))&&Math.abs(f-g)<=k.EPSILON*Math.max(1,Math.abs(f),Math.abs(g))};return g})},"esri/layers/vectorTiles/views/webgl/Program":function(){define(["require","exports"],function(k,g){return function(){function a(b,c,d,e,f){this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=!1;this._fShader=this._vShader=null;this._defines=void 0;
this._nameToUniformLocation={};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};b||console.error("RenderingContext isn't initialized!");0===c.length&&console.error("Shaders source should not be empty!");this._context=b;this._vertexShaderSource=c;this._fragmentShaderSource=d;this._defines=f;this._id=a._nextId++;this._locations=e}Object.defineProperty(a.prototype,
"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});a.prototype.dispose=function(){var a=this._context.gl;this._vShader&&(a.deleteShader(this._vShader),this._vShader=null);this._fShader&&(a.deleteShader(this._fShader),this._fShader=null);this._glName&&(a.deleteProgram(this._glName),
this._glName=null)};a.prototype.initialize=function(){if(!this._initialized){this._vShader=this._loadShader(35633);this._fShader=this._loadShader(35632);(!this._vShader||!this._fShader)&&console.error("Error loading shaders!");var a=this._context.gl,c=a.createProgram();a.attachShader(c,this._vShader);a.attachShader(c,this._fShader);for(var d in this._locations)a.bindAttribLocation(c,this._locations[d],d);a.linkProgram(c);a.getProgramParameter(c,a.LINK_STATUS)||console.error("Could not initialize shader\nVALIDATE_STATUS: "+
a.getProgramParameter(c,a.VALIDATE_STATUS)+", gl error ["+a.getError()+"]infoLog: "+a.getProgramInfoLog(c));this._glName=c;this._initialized=!0}};a.prototype.getUniformLocation=function(a){this.initialize();void 0===this._nameToUniformLocation[a]&&(this._nameToUniformLocation[a]=this._context.gl.getUniformLocation(this._glName,a));return this._nameToUniformLocation[a]};a.prototype.hasUniform=function(a){return null!==this.getUniformLocation(a)};a.prototype.getAttribLocation=function(a){this.initialize();
void 0===this._nameToAttribLocation[a]&&(this._nameToAttribLocation[a]=this._context.gl.getAttribLocation(this._glName,a));return this._nameToAttribLocation[a]};a.prototype.setUniform1i=function(a,c){var d=this._nameToUniform1[a];if(void 0===d||c!==d)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(a),c),this._nameToUniform1[a]=c};a.prototype.setUniform1f=function(a,c){var d=this._nameToUniform1[a];if(void 0===d||c!==d)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(a),
c),this._nameToUniform1[a]=c};a.prototype.setUniform2f=function(a,c,d){var e=this._nameToUniform2[a];if(void 0===e||c!==e[0]||d!==e[1])this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(a),c,d),void 0===e?this._nameToUniform2[a]=new Float32Array([c,d]):(e[0]=c,e[1]=d)};a.prototype.setUniform2fv=function(b,c){0!==c.length%2&&console.error("Value array must have even number of elements!");var d=this._nameToUniform2[b];if(void 0===d||!a._arraysEqual(c,d))this._context.bindProgram(this),
this._context.gl.uniform2fv(this.getUniformLocation(b),c),void 0===d?this._nameToUniform2[b]=new Float32Array(c):d.set(c)};a.prototype.setUniform3f=function(a,c,d,e){var f=this._nameToUniform3[a];if(void 0===f||c!==f[0]||d!==f[1]||e!==f[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(a),c,d,e),void 0===f?this._nameToUniform3[a]=new Float32Array([c,d,e]):(f[0]=c,f[1]=d,f[2]=e)};a.prototype.setUniform3fv=function(b,c){0!==c.length%3&&console.error("Value array must contain sets of three values!");
var d=this._nameToUniform3[b];if(void 0===d||!a._arraysEqual(c,d))this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(b),c),void 0===d?this._nameToUniform3[b]=new Float32Array(c):d.set(c)};a.prototype.setUniform4f=function(a,c,d,e,f){var h=this._nameToUniform4[a];if(void 0===h||c!==h[0]||d!==h[1]||e!==h[2]||f!==h[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(a),c,d,e,f),void 0===h?this._nameToUniform4[a]=new Float32Array([c,d,
e,f]):(h[0]=c,h[1]=d,h[2]=e,h[3]=f)};a.prototype.setUniform4fv=function(b,c){0!==c.length%4&&console.error("Value array must contain sets of four values!");var d=this._nameToUniform4[b];if(void 0===d||!a._arraysEqual(c,d))this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(b),c),void 0===d?this._nameToUniform4[b]=new Float32Array(c):d.set(c)};a.prototype.setUniformMatrix3fv=function(b,c,d){void 0===d&&(d=!1);0!==c.length%9&&console.error("Matrix array must contain sets ot 9 elements!");
var e=this._nameToUniformMatrix3[b];if(void 0===e||(9===e.length?!a._matrix3Equal(e,c):!a._arraysEqual(c,e)))this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(b),d,c),void 0===e?this._nameToUniformMatrix3[b]=new Float32Array(c):e.set(c)};a.prototype.setUniformMatrix4fv=function(b,c,d){void 0===d&&(d=!1);0!==c.length%16&&console.error("Matrix array must contain sets ot 16 elements!");var e=this._nameToUniformMatrix4[b];if(void 0===e||(16===e.length?!a._matrix4Equal(e,
c):!a._arraysEqual(c,e)))this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(b),d,c),void 0===e?this._nameToUniformMatrix4[b]=new Float32Array(c):e.set(c)};a._padToThree=function(a){var c=a.toString();1E3>a&&(c=("  "+a).slice(-3));return c};a.prototype._addLineNumbers=function(b){var c=2;return b.replace(/\n/g,function(){return"\n"+a._padToThree(c++)+":"})};a.prototype._loadShader=function(a){var c=35633===a?this._vertexShaderSource:this._fragmentShaderSource;
if(void 0!==this._defines){var d="";if(Array.isArray(this._defines))for(var e=0,f=this._defines;e<f.length;e++)var h=f[e],d=d+("#define "+h+"\n");else for(h in this._defines)d+="#define "+h+"\n";c=d+c}d=this._context.gl;a=d.createShader(a);d.shaderSource(a,c);d.compileShader(a);d.getShaderParameter(a,d.COMPILE_STATUS)||(console.error(d.getShaderInfoLog(a)),console.error(this._addLineNumbers(c)));return a};a._matrix4Equal=function(a,c){(16!==a.length||16!==c.length)&&console.error("Matrix object must contain 16 elements!");
return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]&&a[4]===c[4]&&a[5]===c[5]&&a[6]===c[6]&&a[7]===c[7]&&a[8]===c[8]&&a[9]===c[9]&&a[10]===c[10]&&a[11]===c[11]&&a[12]===c[12]&&a[13]===c[13]&&a[14]===c[14]&&a[15]===c[15]};a._matrix3Equal=function(a,c){(9!==a.length||9!==c.length)&&console.error("Matrix object must contain 16 elements!");return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]&&a[4]===c[4]&&a[5]===c[5]&&a[6]===c[6]&&a[7]===c[7]&&a[8]===c[8]};a._arraysEqual=function(a,c){if(a.length!==
c.length)return!1;for(var d=0;d<a.length;++d)if(a[d]!==c[d])return!1;return!0};a._nextId=0;return a}()})},"esri/layers/vectorTiles/views/webgl/VertexArrayObject":function(){define(["require","exports"],function(k,g){return function(){function a(b,c,d,e,f){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=!1;this._context=b;this._layout=d;this._buffers=e;this._locations=c;f&&(this._indexBuffer=f);this._id=a._nextId++}Object.defineProperty(a.prototype,
"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"layout",{get:function(){return this._layout},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});a.prototype.dispose=function(a){void 0===a&&(a=!0);var c=this._context.extensions.vao;c&&this._glName&&(c.deleteVertexArrayOES(this._glName),this._glName=null);this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(a){for(var d in this._buffers)this._buffers[d].dispose(),delete this._buffers[d];this._indexBuffer&&(this._indexBuffer.dispose(),
this._indexBuffer=null)}};a.prototype.initialize=function(){if(!this._initialized){var a=this._context.extensions.vao;if(a){var c=a.createVertexArrayOES();a.bindVertexArrayOES(c);this._bindLayout();a.bindVertexArrayOES(null);this._glName=c}this._initialized=!0}};a.prototype.bind=function(){this.initialize();var a=this._context.extensions.vao;a?a.bindVertexArrayOES(this.glName):(this._context.bindVAO(null),this._bindLayout())};a.prototype._bindLayout=function(){var a=this._buffers,c=this._context.extensions.vao,
d=this._layout,e=this._indexBuffer;a||console.error("Vertex buffer dictionary is empty!");var f=this._context.gl,h,m,l=0,g;for(g in a){(h=a[g])||console.error("Vertex buffer is uninitialized!");(m=d[g])||console.error("Vertex element descriptor is empty!");this._context.bindBuffer(h);for(l=0;l<m.length;++l){h=m[l];var p=this._locations[h.name];void 0===p&&console.error("There is no location for vertex attribute '"+h.name+" defined.");if(4>=h.count){if(f.enableVertexAttribArray(p),f.vertexAttribPointer(p,
h.count,h.type,h.normalized,h.stride,h.offset),h.divisor&&0<h.divisor){var s=this._context.extensions.angleInstancedArrays;s&&s.vertexAttribDivisorANGLE(p,h.divisor)}}else if(16===h.count&&5126===h.type)for(var r=0;4>r;r++)f.enableVertexAttribArray(p+r),f.vertexAttribPointer(p+r,4,h.type,h.normalized,h.stride,h.offset+16*r),h.divisor&&0<h.divisor&&(s=this._context.extensions.angleInstancedArrays)&&s.vertexAttribDivisorANGLE(p+r,h.divisor);else console.error("Unsupported vertex attribute element count: "+
h.count)}}e&&(c?f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,e.glName):this._context.bindBuffer(e))};a.prototype.unbind=function(){this.initialize();var a=this._context.extensions.vao;a?a.bindVertexArrayOES(null):this._unbindLayout()};a.prototype._unbindLayout=function(){var a=this._buffers,c=this._layout,d=this._locations,e=this._context;a||console.error("Vertex buffer dictionary is empty!");var f=e.gl,h,m,l,g=0,p=0,s;for(s in a){(h=a[s])||console.error("Vertex buffer is uninitialized!");m=c[s];g=0;for(p=
m.length;g<p;++g)l=m[g],f.disableVertexAttribArray(d[l.name]);e.unbindBuffer(h.bufferType)}(a=this._indexBuffer)&&e.unbindBuffer(a.bufferType)};a._nextId=0;return a}()})},"esri/layers/vectorTiles/views/webgl/BufferObject":function(){define(["require","exports"],function(k,g){return function(){function a(b,c,d,e){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=b;this._bufferType=c;this._usage=d;this._id=a._nextId++;this._glName=
this._context.gl.createBuffer();e&&this.setData(e)}a.createIndex=function(b,c,d){return new a(b,34963,c,d)};a.createVertex=function(b,c,d){return new a(b,34962,c,d)};Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0});a.prototype.dispose=
function(){this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null)};a.prototype.setData=function(a){if(a){if("number"===typeof a)0>a&&console.error("Buffer size cannot be negative!"),this._size=a;else{var c=a.byteLength;a instanceof Uint16Array&&(c/=2,this._indexType=5123);a instanceof Uint32Array&&(c/=4,this._indexType=5125);this._size=c}c=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,a,this._usage);
this._context.bindVAO(c)}};a.prototype.setSubData=function(a,c,d,e){void 0===c&&(c=0);void 0===d&&(d=0);if(a){(0>c||c>=this._size)&&console.error("offset is out of range!");var f=c,h=d,m=e,l=a.byteLength;a instanceof Uint16Array&&(l/=2,f*=2,h*=2,m*=2);a instanceof Uint32Array&&(l/=4,f*=4,h*=4,m*=2);void 0===e&&(e=l-1);d>=e&&console.error("end must be bigger than start!");c+d-e>this._size&&console.error("An attempt to write beyond the end of the buffer!");c=this._context.getBoundVAO();this._context.bindVAO(null);
this._context.bindBuffer(this);this._context.gl.bufferSubData(this._bufferType,f,(a instanceof ArrayBuffer?a:a.buffer).slice(h,m));this._context.bindVAO(c)}};a._nextId=0;return a}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/LineRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 ../../../core/libs/gl-matrix/vec2 dojo/text!./shaders/lineShader.vs.glsl dojo/text!./shaders/lineShader.fs.glsl dojo/text!./shaders/lineJoinShader.vs.glsl dojo/text!./shaders/lineJoinShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l,n,p){return function(){function g(){this._joinAttributeLocations={a_pos:0,a_vertexOffset:1};this._triangleAttributeLocations={a_pos:0,a_offset:1,a_accumulatedDistance:2};this._initialized=!1;this._viewProjMat=a.create();this._offsetVector=c.create();this._screenSize=d.create();this._color=b.create();this._dashArray=d.create()}g.prototype.render=function(b,c,d,e,f,h,l,m){if(0!==c.triangleElementCount){this._initialized||this._initialize(b);var g=f.tileTransform.transform,
n=f.coordRange/512,s=h.getPaintValue("line-translate",d);if(0!==s[0]||0!==s[1]){a.copy(this._viewProjMat,f.tileTransform.transform);var g=s[0],s=s[1],k=0,G=0,G=(1<<f.key.level)/Math.pow(2,d)*n,k=e.rotation;if(1===h.getPaintValue("line-translate-anchor",d))var J=Math.sin(p.C_DEG_TO_RAD*-k),E=Math.cos(p.C_DEG_TO_RAD*-k),k=G*(g*E-s*J),G=G*(g*J+s*E);else k=G*g,G*=s;this._offsetVector[0]=k;this._offsetVector[1]=G;this._offsetVector[2]=0;a.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);
g=this._viewProjMat}k=1/m;s=h.getPaintValue("line-blur",d)+k;G=h.getPaintValue("line-width",d);k=0.5*(G+k);J=h.getPaintValue("line-opacity",d);E=h.getPaintValue("line-color",d);this._color[0]=E[0];this._color[1]=E[1];this._color[2]=E[2];this._color[3]=E[3]*J;if(1<k&&0<c.joinCount&&(this._screenSize[0]=0.5*e.width,this._screenSize[1]=0.5*e.height,e=Math.ceil(2*k),J=k-0.25,E=this._getJoinsVAO(b,f)))b.bindVAO(E),b.bindProgram(this._joinProgram),E=1/(0<m?m:1),this._joinProgram.setUniformMatrix4fv("u_transformMatrix",
g),this._joinProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),this._joinProgram.setUniform1f("u_depth",h.z),this._joinProgram.setUniform2fv("u_screen",this._screenSize),this._joinProgram.setUniform1f("u_size",e),this._joinProgram.setUniform4fv("u_color",this._color),this._joinProgram.setUniform1f("u_lineHalfWidth",J),this._joinProgram.setUniform1f("u_pixelRatio",m),this._joinProgram.setUniform1f("u_oneOverPixelRatio",E),b.drawArrays(0,c.joinStart,c.joinCount),b.bindVAO();
d=h.getPaintValue("line-dasharray",d);2>d.length&&(d=[1,-1]);n*=G;this._dashArray[0]=n*d[0];this._dashArray[1]=n*d[1];if(n=this._getTrianglesVAO(b,f))b.bindVAO(n),b.bindProgram(this._triangleslProgram),this._triangleslProgram.setUniformMatrix4fv("u_transformMatrix",g),this._triangleslProgram.setUniformMatrix4fv("u_extrudeMatrix",l),this._triangleslProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),this._triangleslProgram.setUniform1f("u_depth",h.z),this._triangleslProgram.setUniform4fv("u_color",
this._color),this._triangleslProgram.setUniform1f("u_lineHalfWidth",k),this._triangleslProgram.setUniform2fv("u_dasharray",this._dashArray),this._triangleslProgram.setUniform1f("u_blur",s),b.drawElements(4,c.triangleElementCount,5125,12*c.triangleElementStart),b.bindVAO()}};g.prototype._initialize=function(a){if(this._initialized)return!0;var b=new l(a,e,f,this._triangleAttributeLocations);a=new l(a,h,m,this._joinAttributeLocations);this._triangleslProgram=b;this._trianglesVertexAttributes={geometry:[{name:"a_pos",
count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:1,type:5122,offset:6,stride:8,normalized:!1,divisor:0}]};this._joinProgram=a;this._joinVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};return this._initialized=!0};g.prototype._getTrianglesVAO=function(a,b){if(b.lineTrianglesVertexArrayObject)return b.lineTrianglesVertexArrayObject;
var c=b.lineVertexBuffer,d=b.lineTrianglesIndexBuffer;if(!c||!d)return null;b.lineTrianglesVertexArrayObject=new n(a,this._triangleAttributeLocations,this._trianglesVertexAttributes,{geometry:c},d);return b.lineTrianglesVertexArrayObject};g.prototype._getJoinsVAO=function(a,b){if(b.lineJoinsVertexArrayObject)return b.lineJoinsVertexArrayObject;var c=b.lineJoinVertexBuffer;if(!c)return null;b.lineJoinsVertexArrayObject=new n(a,this._joinAttributeLocations,this._joinVertexAttributes,{geometry:c});return b.lineJoinsVertexArrayObject};
return g}()})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec2":function(){define(["./common"],function(k){var g={create:function(){var a=new k.ARRAY_TYPE(2);a[0]=0;a[1]=0;return a},clone:function(a){var b=new k.ARRAY_TYPE(2);b[0]=a[0];b[1]=a[1];return b},fromValues:function(a,b){var c=new k.ARRAY_TYPE(2);c[0]=a;c[1]=b;return c},copy:function(a,b){a[0]=b[0];a[1]=b[1];return a},set:function(a,b,c){a[0]=b;a[1]=c;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return a},subtract:function(a,
b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a}};g.sub=g.subtract;g.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return a};g.mul=g.multiply;g.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];return a};g.div=g.divide;g.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);return a};g.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);return a};g.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);return a};g.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);
a[1]=Math.max(b[1],c[1]);return a};g.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);return a};g.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;return a};g.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;return a};g.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)};g.dist=g.distance;g.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return c*c+d*d};g.sqrDist=g.squaredDistance;g.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*
b+a*a)};g.len=g.length;g.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};g.sqrLen=g.squaredLength;g.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];return a};g.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};g.normalize=function(a,b){var c=b[0],d=b[1],c=c*c+d*d;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a};g.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};g.cross=function(a,b,c){b=b[0]*c[1]-b[1]*c[0];a[0]=a[1]=0;a[2]=b;return a};g.lerp=function(a,b,c,d){var e=b[0];b=b[1];
a[0]=e+d*(c[0]-e);a[1]=b+d*(c[1]-b);return a};g.random=function(a,b){b=b||1;var c=2*k.RANDOM()*Math.PI;a[0]=Math.cos(c)*b;a[1]=Math.sin(c)*b;return a};g.transformMat2=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b;a[1]=c[1]*d+c[3]*b;return a};g.transformMat2d=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a};g.transformMat3=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[3]*b+c[6];a[1]=c[1]*d+c[4]*b+c[7];return a};g.transformMat4=function(a,b,c){var d=
b[0];b=b[1];a[0]=c[0]*d+c[4]*b+c[12];a[1]=c[1]*d+c[5]*b+c[13];return a};g.forEach=function(){var a=g.create();return function(b,c,d,e,f,h){c||(c=2);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],f(a,a,h),b[d]=a[0],b[d+1]=a[1];return b}}();g.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};g.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]};g.equals=function(a,b){var c=a[0],d=a[1],e=b[0],f=b[1];return Math.abs(c-e)<=k.EPSILON*Math.max(1,Math.abs(c),Math.abs(e))&&
Math.abs(d-f)<=k.EPSILON*Math.max(1,Math.abs(d),Math.abs(f))};return g})},"esri/layers/vectorTiles/views/vectorTiles/renderers/FillRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 dojo/text!./shaders/solidFillShader.vs.glsl dojo/text!./shaders/solidFillShader.fs.glsl dojo/text!./shaders/patternFillShader.vs.glsl dojo/text!./shaders/patternFillShader.fs.glsl dojo/text!./shaders/fillOutlineShader.vs.glsl dojo/text!./shaders/fillOutlineShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l,n,p,s,r){var q=1/65536;return function(){function g(){this._outlineAttributeLocations={a_pos:0,a_offset:1,a_xnormal:2};this._fillAttributeLocations={a_pos:0};this._initialized=!1;this._viewProjMat=a.create();this._offsetVector=d.create();this._patternMatrix=b.create();this._color=c.create();this._outlineColor=c.create()}g.prototype.render=function(c,d,e,f,h,l,m,g,p,n){this._initialized||this._initialize(c);var s=m.getPaintValue("fill-pattern",e),t=void 0!==s;if(!(t&&
0===h)){var k=m.getPaintValue("fill-antialias",e)&&!t,N=m.getPaintValue("fill-opacity",e),L=m.getPaintValue("fill-color",e),I=!1;if(!t){var D=L[3]*N;1===D&&0===h&&(I=!0);1>D&&1===h&&(I=!0)}if(I||0!==h){var D=l.tileTransform.transform,B=l.coordRange/512,K=m.getPaintValue("fill-translate",e);if(0!==K[0]||0!==K[1]){a.copy(this._viewProjMat,l.tileTransform.transform);var D=K[0],K=K[1],P=0,M=0,B=(1<<l.key.level)/Math.pow(2,e)*B;1===m.getPaintValue("fill-translate-anchor",e)?(M=Math.sin(r.C_DEG_TO_RAD*
-f),f=Math.cos(r.C_DEG_TO_RAD*-f),P=B*(D*f-K*M),M=B*(D*M+K*f)):(P=B*D,M=B*K);this._offsetVector[0]=P;this._offsetVector[1]=M;this._offsetVector[2]=0;a.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);D=this._viewProjMat}if(f=this._getTrianglesVAO(c,l)){c.bindVAO(f);if(t){if(1===h&&(s=g.getMosaicItemPosition(s,!0)))B=l.coordRange/512/Math.pow(2,Math.round(e)-l.key.level)/n,b.identity(this._patternMatrix),t=1/(s.size[1]*B),this._patternMatrix[0]=1/(s.size[0]*B),this._patternMatrix[4]=
t,g.bind(c,9729,0),c.bindProgram(this._patternFillProgram),this._patternFillProgram.setUniformMatrix4fv("u_transformMatrix",D),this._patternFillProgram.setUniform2fv("u_normalized_origin",l.tileTransform.displayCoord),this._patternFillProgram.setUniform1f("u_depth",m.z),this._patternFillProgram.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix),this._patternFillProgram.setUniform1f("u_opacity",N),this._patternFillProgram.setUniform2f("u_pattern_tl",s.tl[0],s.tl[1]),this._patternFillProgram.setUniform2f("u_pattern_br",
s.br[0],s.br[1]),this._patternFillProgram.setUniform1i("u_texture",0),c.drawElements(4,d.triangleElementCount,5125,12*d.triangleElementStart)}else I&&(this._color[0]=L[0],this._color[1]=L[1],this._color[2]=L[2],this._color[3]=L[3]*N,c.bindProgram(this._solidFillProgram),this._solidFillProgram.setUniformMatrix4fv("u_transformMatrix",D),this._solidFillProgram.setUniform2fv("u_normalized_origin",l.tileTransform.displayCoord),this._solidFillProgram.setUniform1f("u_depth",m.z+q),this._solidFillProgram.setUniform4fv("u_color",
this._color),c.drawElements(4,d.triangleElementCount,5125,12*d.triangleElementStart)),c.bindVAO();if(k&&0<d.outlineElementCount&&1===h){e=m.getPaintValue("fill-outline-color",e);if(0===e[3]){if(1!==this._color[3])return;e=L}n=0.75/n;this._outlineColor[0]=e[0];this._outlineColor[1]=e[1];this._outlineColor[2]=e[2];this._outlineColor[3]=e[3]*N;if(N=this._getOutlineVAO(c,l))c.bindVAO(N),c.bindProgram(this._outlineProgram),this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",D),this._outlineProgram.setUniformMatrix4fv("u_extrudeMatrix",
p),this._outlineProgram.setUniform2fv("u_normalized_origin",l.tileTransform.displayCoord),this._outlineProgram.setUniform1f("u_depth",m.z),this._outlineProgram.setUniform1f("u_outline_width",n),this._outlineProgram.setUniform4fv("u_color",this._outlineColor),c.drawElements(4,d.outlineElementCount,5125,12*d.outlineElementStart),c.bindVAO()}}}}};g.prototype._initialize=function(a){if(this._initialized)return!0;var b=new p(a,e,f,{a_pos:0});if(!b)return!1;var c=new p(a,h,m,this._fillAttributeLocations);
if(!c)return!1;a=new p(a,l,n,this._outlineAttributeLocations);this._solidFillProgram=b;this._patternFillProgram=c;this._trianglesVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};this._outlineProgram=a;this._outlineVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,
normalized:!1,divisor:0}]};return this._initialized=!0};g.prototype._getTrianglesVAO=function(a,b){if(b.polygonTrianglesVertexArrayObject)return b.polygonTrianglesVertexArrayObject;var c=b.polygonTrianglesVertexBuffer,d=b.polygonTrianglesIndexBuffer;if(!c||!d)return null;b.polygonTrianglesVertexArrayObject=new s(a,this._fillAttributeLocations,this._trianglesVertexAttributes,{geometry:c},d);return b.polygonTrianglesVertexArrayObject};g.prototype._getOutlineVAO=function(a,b){if(b.polygonOutlineVertexArrayObject)return b.polygonOutlineVertexArrayObject;
var c=b.polygonOutlinesVertexBuffer,d=b.polygonOutlinesIndexBuffer;if(!c||!d)return null;b.polygonOutlineVertexArrayObject=new s(a,this._outlineAttributeLocations,this._outlineVertexAttributes,{geometry:c},d);return b.polygonOutlineVertexArrayObject};return g}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/SymbolRenderer":function(){define(["require","exports","./IconRenderer","./SDFRenderer"],function(k,g,a,b){return function(){function c(){this._iconRenderer=new a;this._sdfRenderer=new b}
c.prototype.render=function(a,b,c,h,m,l,g,p,s,k,q,t){b.hasData()&&(0<b.marketElementCount&&!b.isSDF&&this._iconRenderer.render(a,b,c,h,m,l,g,p,k,q),0<b.textElementCount&&this._sdfRenderer.render(a,b,c,h,m,l,g,s,k,q,t))};return c}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/IconRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec3 dojo/text!./shaders/iconShader.vs.glsl dojo/text!./shaders/iconShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(k,g,a,b,c,d,e,f,h){return function(){function m(){this._attributeLocations={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._spritesTextureSize=new Float32Array(2);this._initialized=!1;this._extrudeMat=a.create();this._scaleVec=b.create()}m.prototype.render=function(b,c,d,e,f,m,g,k,u,w){this._initialized||this._initialize(b);var v=g.getPaintValue("icon-opacity",d),y=g.getLayoutValue("icon-rotation-alignment",d);1===y&&1===g.getLayoutValue("symbol-placement",d)&&!g.hasLayoutProperty("icon-rotation-alignment")&&
(y=0);var z=0===y,y=g.getLayoutValue("icon-keep-upright",d)&&z,A=g.getLayoutValue("icon-size",d);e=h.degToByte(e);this._spritesTextureSize[0]=k.width/4;this._spritesTextureSize[1]=k.height/4;z?a.copy(this._extrudeMat,u):a.copy(this._extrudeMat,w);1!==A&&(this._scaleVec[0]=A,this._scaleVec[1]=A,this._scaleVec[2]=1,a.scale(this._extrudeMat,this._extrudeMat,this._scaleVec));k.bind(b,9728,0);b.bindProgram(this._iconProgram);if(k=this._getIconVAO(b,m))b.bindVAO(k),this._iconProgram.setUniformMatrix4fv("u_transformMatrix",
m.tileTransform.transform),this._iconProgram.setUniformMatrix4fv("u_extrudeMatrix",this._extrudeMat),this._iconProgram.setUniform2fv("u_normalized_origin",m.tileTransform.displayCoord),this._iconProgram.setUniform1f("u_depth",g.z),this._iconProgram.setUniform2fv("u_mosaicSize",this._spritesTextureSize),this._iconProgram.setUniform1f("u_mapRotation",e),this._iconProgram.setUniform1f("u_keepUpright",y?1:0),this._iconProgram.setUniform1f("u_level",10*d),this._iconProgram.setUniform1f("u_fadeSpeed",10*
f.fadeSpeed),this._iconProgram.setUniform1f("u_minfadeLevel",10*f.minfadeLevel),this._iconProgram.setUniform1f("u_maxfadeLevel",10*f.maxfadeLevel),this._iconProgram.setUniform1f("u_fadeChange",10*(d+f.fadeChange)),this._iconProgram.setUniform1f("u_opacity",v),this._iconProgram.setUniform1i("u_texture",0),b.drawElements(4,c.marketElementCount,5125,12*c.markerElementStart),b.bindVAO()};m.prototype._initialize=function(a){if(this._initialized)return!0;this._iconProgram=new e(a,c,d,this._attributeLocations);
this._iconVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};return this._initialized=!0};m.prototype._getIconVAO=function(a,b){if(b.iconVertexArrayObject)return b.iconVertexArrayObject;var c=b.iconVertexBuffer,
d=b.iconIndexBuffer;if(!c||!d)return null;b.iconVertexArrayObject=new f(a,this._attributeLocations,this._iconVertexAttributes,{geometry:c},d);return b.iconVertexArrayObject};return m}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/SDFRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 dojo/text!./shaders/sdfShader.vs.glsl dojo/text!./shaders/sdfShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(k,g,a,b,c,d,e,f,h,m){return function(){function l(){this._attributeLocations={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._initialized=!1;this._extrudeMat=a.create();this._haloColor=b.create();this._sdfColor=b.create();this._scaleVec=c.create()}l.prototype.render=function(b,c,d,e,f,h,l,g,k,v,y){this._initialized||this._initialize(b);var z=l.getLayoutValue("text-size",d),A=z/24;e=m.degToByte(e);var C=l.getLayoutValue("text-rotation-alignment",d);1===C&&1===l.getLayoutValue("symbol-placement",
d)&&!l.hasLayoutProperty("text-rotation-alignment")&&(C=0);var F=0===C,C=l.getLayoutValue("text-keep-upright",d)&&F;y=0.1*24/z/y;z=l.getPaintValue("text-opacity",d);this._glyphTextureSize||(this._glyphTextureSize=new Float32Array([g.width/4,g.height/4]));F?a.copy(this._extrudeMat,k):a.copy(this._extrudeMat,v);this._scaleVec[0]=A;this._scaleVec[1]=A;this._scaleVec[2]=1;a.scale(this._extrudeMat,this._extrudeMat,this._scaleVec);g.bind(b,9729,0);b.bindProgram(this._sdfProgram);if(g=this._getSDFVAO(b,
h))b.bindVAO(g),this._sdfProgram.setUniformMatrix4fv("u_transformMatrix",h.tileTransform.transform),this._sdfProgram.setUniformMatrix4fv("u_extrudeMatrix",this._extrudeMat),this._sdfProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._sdfProgram.setUniform1f("u_depth",l.z),this._sdfProgram.setUniform2fv("u_mosaicSize",this._glyphTextureSize),this._sdfProgram.setUniform1f("u_mapRotation",e),this._sdfProgram.setUniform1f("u_keepUpright",C?1:0),this._sdfProgram.setUniform1f("u_level",
10*d),this._sdfProgram.setUniform1f("u_fadeSpeed",10*f.fadeSpeed),this._sdfProgram.setUniform1f("u_minfadeLevel",10*f.minfadeLevel),this._sdfProgram.setUniform1f("u_maxfadeLevel",10*f.maxfadeLevel),this._sdfProgram.setUniform1f("u_fadeChange",10*(d+f.fadeChange)),this._sdfProgram.setUniform1f("u_opacity",z),this._sdfProgram.setUniform1i("u_texture",0),f=l.getPaintValue("text-halo-color",d),0<f[3]&&(this._haloColor[0]=f[0],this._haloColor[1]=f[1],this._haloColor[2]=f[2],this._haloColor[3]=f[3]*z,f=
y+l.getPaintValue("text-halo-blur",d)/A/8,A=0.75-l.getPaintValue("text-halo-width",d)/A/8,this._sdfProgram.setUniform4fv("u_color",this._haloColor),this._sdfProgram.setUniform1f("u_edgeDistance",A),this._sdfProgram.setUniform1f("u_edgeWidth",f),b.drawElements(4,c.textElementCount,5125,12*c.textElementStart)),d=l.getPaintValue("text-color",d),0<d[3]&&(this._sdfColor[0]=d[0],this._sdfColor[1]=d[1],this._sdfColor[2]=d[2],this._sdfColor[3]=d[3]*z,this._sdfProgram.setUniform4fv("u_color",this._sdfColor),
this._sdfProgram.setUniform1f("u_edgeDistance",0.75),this._sdfProgram.setUniform1f("u_edgeWidth",y),b.drawElements(4,c.textElementCount,5125,12*c.textElementStart),b.bindVAO())};l.prototype._initialize=function(a){if(this._initialized)return!0;this._sdfProgram=new f(a,d,e,this._attributeLocations);this._sdfVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",
count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};return this._initialized=!0};l.prototype._getSDFVAO=function(a,b){if(b.textVertexArrayObject)return b.textVertexArrayObject;var c=b.textVertexBuffer,d=b.textIndexBuffer;if(!c||!d)return null;b.textVertexArrayObject=new h(a,this._attributeLocations,this._sdfVertexAttributes,{geometry:c},d);return b.textVertexArrayObject};return l}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/TileInfoRenderer":function(){define("require exports dojo/text!./shaders/background.vs.glsl dojo/text!./shaders/background.fs.glsl dojo/text!./shaders/tileInfo.vs.glsl dojo/text!./shaders/tileInfo.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject ../../webgl/Texture ../GeometryUtils".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l){return function(){function g(){this._initialized=!1;this._maxWidth=0;this._color=new Float32Array([1,0,0,1])}g.prototype.render=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform);this._outlineProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord);this._outlineProgram.setUniform1f("u_coord_range",
b.coordRange);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.setLineWidth(2);a.drawArrays(3,0,4);a.bindVAO();var c=this._getTexture(a,b);c&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(c,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord),this._tileInfoProgram.setUniform1f("u_depth",
0),this._tileInfoProgram.setUniform1f("u_coord_ratio",b.coordRange/512),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",c.descriptor.width,c.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())};g.prototype._initialize=function(l){if(this._initialized)return!0;var m={a_pos:0},g=new e(l,a,b,m),n=new e(l,c,d,m),k={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},x=new Int8Array([0,0,1,0,1,1,0,1]),x=h.createVertex(l,
35044,x),x=new f(l,m,k,{geometry:x}),u=new Int8Array([0,0,1,0,0,1,1,1]),u=h.createVertex(l,35044,u);l=new f(l,m,k,{geometry:u});this._outlineProgram=g;this._tileInfoProgram=n;this._vertexAttributes=k;this._outlineVertexArrayObject=x;this._tileInfoVertexArrayObject=l;return this._initialized=!0};g.prototype._getTexture=function(a,b){if(b.texture)return b.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width",
"256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var c=b.key.id,d=this._canvas.getContext("2d");d.font="24px sans-serif";d.textAlign="left";d.textBaseline="middle";var e=d.measureText(c),e=Math.pow(2,Math.ceil(l.log2(e.width+2)));e>this._maxWidth&&(this._maxWidth=e);d.clearRect(0,0,this._maxWidth,32);d.fillStyle=b.key.level>b.refKey.level?"red":"blue";d.fillText(c,0,16);b.texture=new m(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},
this._canvas);return b.texture};return g}()})},"esri/layers/vectorTiles/views/webgl/Texture":function(){define(["require","exports"],function(k,g){return function(){function a(b,c,d){this._glName=this._context=null;this._id=-1;this._desc=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._context=b;this._desc={pixelFormat:c.pixelFormat,dataType:c.dataType,target:c.target?c.target:3553,samplingMode:c.samplingMode?c.samplingMode:9729,wrapMode:c.wrapMode?c.wrapMode:10497,maxAnisotropy:c.maxAnisotropy,
flipped:void 0!==c.flipped?c.flipped:!1,hasMipmap:void 0!==c.hasMipmap?c.hasMipmap:!1,level:void 0!==c.level?c.level:0,unpackAlignment:c.unpackAlignment?c.unpackAlignment:4,width:c.width,height:c.height};this._id=++a._nextId;this.setData(d)}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"descriptor",
{get:function(){return this._desc},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this._context&&this._glName&&(this._context.gl.deleteTexture(this._glName),this._glName=null)};a.prototype.resize=function(a,c){var d=this._desc;d.width===a&&d.height===c||(d.width=a,d.height=c,this.setData(null))};a.prototype.setData=function(b){var c=this._context.gl;this._glName||(this._glName=c.createTexture());void 0===b&&(b=null);null===b&&(this._desc.width=this._desc.width||4,this._desc.height=
this._desc.height||4);var d=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var e=this._desc;a._validateTexture(e);c.pixelStorei(c.UNPACK_ALIGNMENT,e.unpackAlignment);c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,e.flipped?1:0);b instanceof ImageData||b instanceof HTMLImageElement||b instanceof HTMLCanvasElement||b instanceof HTMLVideoElement?(e.width&&e.height&&console.assert(b.width===e.width&&b.height===e.height),c.texImage2D(c.TEXTURE_2D,e.level,e.pixelFormat,e.pixelFormat,e.dataType,
b),void 0===this._desc.width&&(this._desc.width=b.width),void 0===this._desc.height&&(this._desc.height=b.height)):((null==e.width||null==e.height)&&console.error("Width and height must be specified!"),c.texImage2D(c.TEXTURE_2D,e.level,e.pixelFormat,e.width,e.height,0,e.pixelFormat,e.dataType,b));e.hasMipmap&&this.generateMipmap();a._applySamplingMode(c,this._desc);a._applyWrapMode(c,this._desc);a._applyAnisotropicFilteringParameters(this._context,this._desc);this._context.bindTexture(d,0)};a.prototype.updateData=
function(a,c,d,e,f,h){h||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");var m=this._context.gl,l=this._desc;this._context.bindTexture(this);(0>c||0>d||e>l.width||f>l.height||c+e>l.width||d+f>l.height)&&console.error("An attempt to update out of bounds of the texture!");h instanceof ImageData||h instanceof HTMLImageElement||h instanceof HTMLCanvasElement||h instanceof HTMLVideoElement?(console.assert(h.width===e&&h.height===
f),m.texSubImage2D(m.TEXTURE_2D,a,c,d,l.pixelFormat,l.dataType,h)):m.texSubImage2D(m.TEXTURE_2D,a,c,d,e,f,l.pixelFormat,l.dataType,h)};a.prototype.generateMipmap=function(){var b=this._desc;b.hasMipmap||(b.hasMipmap=!0,a._validateTexture(b));9729===b.samplingMode?(this._samplingModeDirty=!0,b.samplingMode=9985):9728===b.samplingMode&&(this._samplingModeDirty=!0,b.samplingMode=9984);b=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var c=this._context.gl;c.generateMipmap(c.TEXTURE_2D);
this._context.bindTexture(b,0)};a.prototype.setSamplingMode=function(b){b!==this._desc.samplingMode&&(this._desc.samplingMode=b,a._validateTexture(this._desc),this._samplingModeDirty=!0)};a.prototype.setWrapMode=function(b){b!==this._desc.wrapMode&&(this._desc.wrapMode=b,a._validateTexture(this._desc),this._wrapModeDirty=!0)};a.prototype.applyChanges=function(){var b=this._context.gl,c=this._desc;this._samplingModeDirty&&(a._applySamplingMode(b,c),this._samplingModeDirty=!1);this._wrapModeDirty&&
(a._applyWrapMode(b,c),this._wrapModeDirty=!1)};a._isPowerOfTwo=function(a){return 0===(a&a-1)};a._validateTexture=function(b){(0>b.width||0>b.height)&&console.error("Negative dimension parameters are not allowed!");if(!a._isPowerOfTwo(b.width)||!a._isPowerOfTwo(b.height))33071!==b.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),b.hasMipmap&&console.error("Mipmapping requires power-of-two textures!")};a._applySamplingMode=function(a,c){var d=c.samplingMode;
if(9985===d||9987===d)d=9729;else if(9984===d||9986===d)d=9728;a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,d);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,c.samplingMode)};a._applyWrapMode=function(a,c){a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,c.wrapMode);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,c.wrapMode)};a._applyAnisotropicFilteringParameters=function(a,c){if(null!=c.maxAnisotropy){var d=a.extensions.textureFilterAnisotropic;if(d){var e=a.gl;e.texParameterf(e.TEXTURE_2D,d.TEXTURE_MAX_ANISOTROPY_EXT,
c.maxAnisotropy)}}};a._nextId=0;return a}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/FadeRecorder":function(){define(["require","exports","../../../core/now"],function(k,g,a){(function(){return function(a,c){this.level=a;this.now=c}})();k=function(){return function(a,c,d,e){this.fadeSpeed=a;this.minfadeLevel=c;this.maxfadeLevel=d;this.fadeChange=e}}();g.FadeProperties=k;k=function(){function b(a){void 0===a&&(a=300);this._levelSnapshots=[];this._duration=a}b.prototype.recordLevel=function(b){var d=
a(),e=this._levelSnapshots;0===e.length&&(e.push({level:b,now:0}),e.push({level:b,now:0}));(2===e.length||e[0].level!==b)&&e.push({level:b,now:d})};b.prototype.needsRedraw=function(){if(0===this._levelSnapshots.length)return!1;for(var a=this._duration,b=this._levelSnapshots,e=b.length,f=b[e-1],h=-1;e>h+1&&b[h+1].now+a<f.now;)h++;for(0>h&&(h=0);h<e;h++)if(b[h].level!==f.level)return!0;return!1};b.prototype.getFadeValues=function(){for(var b=this._duration,d=a(),e=this._levelSnapshots;3<e.length&&e[1].now+
b<d;)e.shift();e[1].now+b<d&&(e[0].level=e[1].level);var f=e[0].level,h=e[e.length-1],m=h.level,l=Math.min(f,m),f=Math.max(f,m),e=(h.level-e[1].level)/((h.now-e[1].now)/b);return{fadeSpeed:e,minfadeLevel:l,maxfadeLevel:f,fadeChange:(d-h.now)/b*e}};return b}();g.FadeRecorder=k})},"esri/layers/vectorTiles/core/now":function(){define(["require","exports"],function(k,g){var a=Function("return this")();return function(){var b=a.performance||{};if(b.now)return function(){return b.now()};if(b.webkitNow)return function(){return b.webkitNow()};
if(b.mozNow)return function(){return b.mozNow()};if(b.msNow)return function(){return b.msNow()};if(b.oNow)return function(){return b.oNow()};var c;c=b.timing&&b.timing.navigationStart?b.timing.navigationStart:Date.now();return function(){return Date.now()-c}}()})},"esri/layers/vectorTiles/views/vectorTiles/StencilClipGenerator":function(){define(["require","exports","./GeometryUtils"],function(k,g,a){var b=function(){function a(b){this.children=[];this.stageTile=b}a.prototype.tryAdd=function(b){if(a.isChildOf(b,
this.stageTile.key)){for(var e=0,f=this.children;e<f.length;e++)if(a.isChildOf(b,f[e]))return;this.children.push(b)}};a.prototype.equals=function(a){if(this.stageTile.key.id!==a.stageTile.key.id||this.children.length!==a.children.length)return!1;for(var b=0;b<this.children.length;b++)if(this.children[b].id!==a.children[b].id)return!1;return!0};a.isChildOf=function(a,b){if(a.level<=b.level)return!1;var c=a.level-b.level,h=a.col>>c;return a.row>>c===b.row&&h===b.col};return a}();return function(){function c(){this._tileGroups=
[];this._bitOffset=0}c.prototype.update=function(c){this._tileGroups=[];this._bitOffset=0;if(0!==c.length){for(var e=[],f=c.length,h=0;h<f;h++)if(c[h].attached&&c[h].visible){for(var m=new b(c[h]),l=h+1;l<f;l++)m.tryAdd(c[l].key);m.children.sort(function(a,b){return a.level<b.level?-1:1});this._reuseExisting(m)||e.push(m)}if(0<e.length){c=Math.ceil(a.log2(e.length+1));f=(1<<c)-1<<this._bitOffset;h=1;m=void 0;for(l=0;l<e.length;l++){var g=e[l],m=h++<<this._bitOffset;g.stageTile.stencilData.mask=f;
g.stageTile.stencilData.reference=m}this._bitOffset+=c;this._tileGroups.push(e)}}};c.prototype._reuseExisting=function(a){for(var b=0,c=this._tileGroups;b<c.length;b++)for(var h=0,m=c[b];h<m.length;h++){var l=m[h];if(l.equals(a)&&l.stageTile.stencilData.mask===a.stageTile.stencilData.mask&&l.stageTile.stencilData.reference===a.stageTile.stencilData.reference)return!0}return!1};return c}()})},"esri/layers/vectorTiles/views/vectorTiles/TileHandler":function(){define("require exports module dojo/Deferred dojo/promise/all ../../core/workers ../../core/promiseUtils ../../core/requireUtils ../../request ../2d/layers/support/TileKey ./TileIndex ./SpriteMosaic ./SpriteSource ./GlyphMosaic ./GlyphSource ./VectorTileDisplayObject ./GeometryUtils".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l,n,p,s,r,q,t){return function(){function g(a,b){this._tileIndex=this._connection=this._glyphMosaic=this._spriteMosaic=null;this._vectorTileLayer=a;this._requestUpdate=b;this.devicePixelRatio=window.devicePixelRatio||1}g.prototype.destroy=function(){this.stop();this._vectorTileLayer=this._requestUpdate=null};Object.defineProperty(g.prototype,"spriteMosaic",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"glyphMosaic",
{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});g.prototype.start=function(){var e=this;this.stop();var h=this._vectorTileLayer.styleRepository,l=new p(h.sprite,this.devicePixelRatio);l.devicePixelRatio=devicePixelRatio;var m=l.load().then(function(){e._spriteMosaic=new n(1024,1024);e._spriteMosaic.setSpriteSource(l)}),g=new r(h.glyphs);this._glyphMosaic=new s(1024,1024,g);var t=this._fetchTileMap(this._vectorTileLayer.tileIndexUrl),q=d.open(this,f.getAbsMid("./WorkerTileHandler",
k,a)).then(function(a){e._connection=a}),x=new b(function(a){m.isFulfilled()||m.cancel();t.isFulfilled()||t.cancel();q.isFulfilled()||q.cancel()});c([m,t,q]).then(function(a){c(e._connection.broadcast("setLayers",h.styleJSON)).then(function(){x.resolve()})});return this._broadcastPromise=x.promise};g.prototype.stop=function(){this._broadcastPromise&&!this._broadcastPromise.isFulfilled()&&this._broadcastPromise.cancel();this._connection&&(this._connection.close(),this._connection=null)};g.prototype.updateTile=
function(a,b){if(!this._broadcastPromise.isFulfilled()||!this._connection)return e.reject(Error("no connection"));var c=Math.round(t.degToByte(b.state.rotation));if(a.rotation===c)return null;a.rotation=c;return this._connection.invoke("update",{key:a.id,rotation:c},[],{id:a.workerID}).then(function(b){a.updateSymbolData(b);return a})};g.prototype.getVectorTile=function(a,b){var c=this;if(!this._broadcastPromise.isFulfilled()||!this._connection)return e.reject(Error("no connection"));var d=this._vectorTileLayer.tileInfo,
f=Math.round(b.state.rotation);if(d.lods.length<=a.level)return e.reject("Cannot create tile for the requested level");var h=this._tileIndex?this._tileIndex.dataKey(a):a;return!h?e.reject(Error("no data")):this._getTileData(this._connection,a,h,f).then(function(e){var f=d.size[0]*d.lods[a.level].resolution,l=d.origin,m=l.x+a.col*f+a.world*c._vectorTileLayer.fullExtent.width,g=m+f,l=l.y-a.row*f,f=l-f;c._requestUpdate();return new q(a,h,[m,l,g,f],c._vectorTileLayer.tileInfo.size[1],4096,Math.round(t.degToByte(b.state.rotation)),
e.tileData,c._vectorTileLayer.styleRepository,c._glyphMosaic,e.workerId,c._connection)}).otherwise(function(a){return e.reject(a)})};g.prototype.fetchTileData=function(a){a=m.fromId(a);a=this._vectorTileLayer.getTileUrl(a.level,a.row,a.col);return h(a,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){return{data:{protobuff:a.data},buffers:[a.data]}})};g.prototype.getSprites=function(a){return e.resolve({data:{spriteItems:this._spriteMosaic.getSpriteItems(a.sprites)}})};
g.prototype.getGlyphs=function(a){return this._glyphMosaic.getGlyphItems(a.tileID,a.font,a.codePoints).then(function(a){return{data:{glyphItems:a}}})};g.prototype.getStyleRepository=function(){return this._vectorTileLayer.styleRepository};g.prototype.getTileIndex=function(){return this._tileIndex};g.prototype._getTileData=function(a,b,c,d){var e={id:null};return this._connection.invoke("getTile",{key:b.id,refKey:c.id,rotation:d},[],e).then(function(a){return{tileData:a,workerId:e.id}})};g.prototype._fetchTileMap=
function(a){var b=this;return!a?null:h(a,{callbackParamName:"callback",responseType:"json"}).then(function(a){b._tileIndex=new l(a.data)})};return g}()})},"esri/layers/vectorTiles/core/workers":function(){define("require exports dojo/Deferred dojo/promise/all ./promiseUtils ./workers/Connection ./workers/JobProxy".split(" "),function(k,g,a,b,c,d,e){function f(a,c){for(var d=[],e=0,f=p.length;e<f;e++)d.push(p[e].openConnection(a,c));return b(d).then(function(a){})}function h(a){s[a]=!0;if(!n&&s.every(function(a){return a})){for(var b in x)(a=
t[b])&&x[b].resolve(a);x={};n=!0}}function m(b){var c=q++;b=new d(b,c);var e=new a;t[c]=b;n?e.resolve(b):x[c]=e;return e.promise}var l=Math.max((navigator.hardwareConcurrency||2)-1,2),n=!1,p=[],s=[],r=0,q=0,t={},x={},u=!1;g.open=function(a,b){if(!1===u){for(var d=0;d<l;++d){var g=new e(t,d,h);p.push(g);s.push(!1)}u=!0}return m(a).then(function(a){return f(b,a.id).then(function(){return a}).otherwise(function(a){return c.reject(a)})})};g.terminate=function(){for(var a=0,b=p.length;a<b;a++)p[a].terminate();
p=[];s=[];n=!1};g.closeConnection=function(a){if(a)if(t[a.id]&&delete t[a.id],n)for(var b=0,c=p.length;b<c;b++)p[b].closeConnection(a.id);else if(b=x[a.id])b.promise.cancel(),delete x[a.id]};g.invoke=function(a,b,d,e,f){var h=null;e&&(h=e.id);if(null===h&&(h=r=(r+1)%p.length,!s[h]&&!p.some(function(a,b,c){h=(h+1)%c.length;return s[h]})))return c.reject(Error("No worker available"));a=p[h].invoke(a,b,d,f);e&&(e.id=h);return a};g.broadcast=function(a,b,c,d){for(var e=[],f=0,h=p.length;f<h;f++)s[f]&&
e.push(p[f].invoke(a,b,c,d));return e}})},"esri/layers/vectorTiles/core/workers/Connection":function(){define(["require","exports","../workers"],function(k,g,a){return function(){function b(a,b){this.client=a;this.id=b}b.prototype.invoke=function(b,d,e,f){return a.invoke(b,d,e,f,this.id)};b.prototype.broadcast=function(b,d,e){return a.broadcast(b,d,e,this.id)};b.prototype.close=function(){a.closeConnection(this)};return b}()})},"esri/layers/vectorTiles/core/workers/JobProxy":function(){define("require exports dojo/_base/kernel dojo/_base/url dojo/Deferred ../../kernel ../../config ../../request ../urlUtils".split(" "),
function(k,g,a,b,c,d,e,f,h){function m(){if(!s){var a=new c,d=new Worker(l);d.onerror=function(a){a.preventDefault()};a.resolve(d);return a.promise}r||(a=new b(l),e.defaults?e.defaults.io.corsEnabledServers.push(a.host):e.request.corsEnabledServers.push(a.host),r=f(l,{responseType:"text"}));return r.then(function(a){a=new Worker(URL.createObjectURL(new Blob([a.data],{type:"text/javascript"})));a.onerror=function(a){a.preventDefault()};return a})}var l=h.makeAbsolute(k.toUrl("./worker.js")),n=h.makeAbsolute(k.toUrl("./worker-init.js")),
p=h.makeAbsolute("../../../../../../",n)+"/",s=!h.hasSameOrigin(l,location.href),r=null;return function(){function b(a,c,d){var e=this;this.connections=a;this.index=c;this.workerInitCallback=d;this.msgCount=0;this.outgoingJobs={};this.incomingJobs={};this.incomingStaticJobs={};m().then(function(a){e.worker=a;e.worker.addEventListener("message",e.message.bind(e),!1)})}b.prototype.terminate=function(){this.worker.terminate()};b.prototype.openConnection=function(a,b){return this.invoke("\x3copen-connection\x3e",
{path:a},void 0,b)};b.prototype.closeConnection=function(a){this.invoke("\x3cclose-connection\x3e",void 0,void 0,a)};b.prototype.postConfigMessage=function(b){b=JSON.parse(JSON.stringify(b));this.worker.postMessage({type:"\x3cconfigure\x3e",configure:{esriConfig:b,dojoConfig:{async:!0,baseUrl:p,locale:a.locale,has:{"esri-cors":1,"dojo-test-sniff":0,"config-deferredInstrumentation":0},paths:{esri:"esri",dojo:"dojo",dojox:"dojox",dstore:"dstore",moment:"moment"}},loaderUrl:n}})};b.prototype.invoke=
function(a,b,d,e){var f=this,h=++this.msgCount,l=new c(function(a){f.worker.postMessage({type:"\x3ccancel\x3e",id:h,connection:e,data:{reason:a}});f.outgoingJobs[h]&&delete f.outgoingJobs[h]});this.outgoingJobs[h]=l;this.worker.postMessage({type:a,id:h,connection:e,data:b},d);return l.promise};b.prototype.message=function(a){var b=this;if(a&&a.data){var c=a.data.type;if(c){var f=a.data,h=a.data.id;if("\x3cresponse\x3e"===c&&h){if(a=this.outgoingJobs[h])delete this.outgoingJobs[h],f.error?a.reject(f.error):
a.resolve(f.data)}else if("\x3cworker-loaded\x3e"===c)this.postConfigMessage(e);else if("\x3cworker-configured\x3e"===c)this.workerInitCallback&&("function"===typeof this.workerInitCallback&&"number"===typeof this.index)&&this.workerInitCallback(this.index);else if("\x3ccancel\x3e"===c&&h)(a=this.incomingJobs[h])&&a.cancel(f.data.reason),f.staticMsg&&(a=this.incomingStaticJobs[h])&&a.cancel(f.data.reason);else if("\x3cstatic-message\x3e"===c){var l=f.staticMsg;a=d.workerMessages[l];!a||"function"!==
typeof a?this.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:l,id:h,error:a+" message type is not available on the kernel!"}):(f=a.call(this,f.data),this.incomingStaticJobs[h]=f,f.then(function(a){b.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:l,id:h,data:a.data},a.buffers)}).otherwise(function(a){a||(a="Error encountered at method"+l);(!a.dojoType||"cancel"!==a.dojoType)&&b.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:l,id:h,error:a})}).always(function(){delete b.incomingStaticJobs[h]}))}else{var m=
f.connection;if(a=this.connections[m])if(a=a.client){var g=a[c];"function"===typeof g&&(f=g.call(a,f.data),this.incomingJobs[h]=f,f.then(function(a){b.worker.postMessage({type:"\x3cresponse\x3e",id:h,connection:m,error:a.error,data:a.data},a.buffers)}).otherwise(function(a){a||(a="Error encountered at method"+c);(!a.dojoType||"cancel"!==a.dojoType)&&b.worker.postMessage({type:"\x3cresponse\x3e",id:h,connection:m,error:a})}).always(function(){delete b.incomingJobs[h]}))}}}}};return b}()})},"esri/layers/vectorTiles/kernel":function(){define(["require",
"exports"],function(k,g){g.workerMessages={}})},"esri/layers/vectorTiles/config":function(){define(["require","exports","esri/config"],function(k,g,a){return a})},"esri/layers/vectorTiles/core/requireUtils":function(){define(["require","exports","dojo/Deferred"],function(k,g,a){function b(c,d){if(Array.isArray(d)){var e=new a;c(d,function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];e.resolve(a)});return e.promise}return b(c,[d]).then(function(a){return a[0]})}g.when=b;g.getAbsMid=
function(a,b,e){return b.toAbsMid?b.toAbsMid(a):e.id.replace(/\/[^\/]*$/ig,"/")+a}})},"esri/layers/vectorTiles/views/2d/layers/support/TileKey":function(){define(["require","exports"],function(k,g){return function(){function a(a,c,d,e){this.level=a;this.row=c;this.col=d;this.world=e}a.from=function(b,c,d,e){var f=typeof b;return"object"===f?b:"string"===f?a.fromId(b):new a(b,c,d,e)};a.fromId=function(b){b=b.split("/");var c=b[1],d=b[2],e=b[3];return new a(parseFloat(b[0]),parseFloat(c),parseFloat(d),
parseFloat(e))};a.getId=function(a,c,d,e){return"object"===typeof a?a.level+"/"+a.row+"/"+a.col+"/"+a.world:a+"/"+c+"/"+d+"/"+e};Object.defineProperty(a.prototype,"id",{get:function(){return a.getId(this)},enumerable:!0,configurable:!0});return a}()})},"esri/layers/vectorTiles/views/vectorTiles/TileIndex":function(){define(["require","exports","../2d/layers/support/TileKey"],function(k,g,a){return function(){function b(a){this._tilemap=a.index}b.prototype.dataKey=function(b){for(var d=[b];0!==b.level;)b=
new a(b.level-1,b.row>>1,b.col>>1,b.world),d.push(b);b=this._tilemap;for(var e=d.pop(),f,h;d.length;){f=d.pop();h=e.level+1;var m=2*e.row,l=2*e.col;h=[a.getId(h,m,l,f.world),a.getId(h,m,l+1,f.world),a.getId(h,m+1,l,f.world),a.getId(h,m+1,l+1,f.world)].indexOf(f.id);if(b)if(0===b[h]){e=null;break}else if(1===b[h]){e=f;break}else e=f,b=b[h]}return e};b.prototype.forEach=function(a,b,e,f,h){this._callback=h;this._maxLevel=b+a;this._forEach(this._tilemap,b,e,f)};b.prototype._forEach=function(a,b,e,f){0!==
a&&(this._callback(b,e,f),b!==this._maxLevel&&"object"===typeof a&&(this._forEach(a[0],b+1,2*e,2*f),this._forEach(a[1],b+1,2*e,2*f+1),this._forEach(a[2],b+1,2*e+1,2*f),this._forEach(a[3],b+1,2*e+1,2*f+1)))};return b}()})},"esri/layers/vectorTiles/views/vectorTiles/SpriteMosaic":function(){define(["require","exports","./Rect","./RectangleBinPack","../webgl/Texture"],function(k,g,a,b,c){return function(){function d(a,c){this._height=this._width=0;this._mosaicRects={};this._dirty=!1;this.pixelRatio=
1;(0>=a||0>=c)&&console.error("Sprites mosaic width and height must be greater than zero!");this._width=a;this._height=c;this._binPack=new b(a,c)}Object.defineProperty(d.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});d.prototype.setSpriteSource=function(a){this._dispose();this.pixelRatio=a.devicePixelRatio;this._mosaicData||(this._binPack=new b(this._width,
this._height),this._mosaicData=new Uint32Array(Math.floor(this._width)*Math.floor(this._height)));this._sprites=a};d.prototype.getSpriteItem=function(a,b){void 0===b&&(b=!1);var c=this._mosaicRects[a];if(c)return c;if(!this._sprites||"loaded"!==this._sprites.loadStatus)return null;var d=this._sprites.getSpritePosition(a);if(!d||!d.width||!d.height)return null;var l=this._allocateImage(d.width,d.height);if(0>=l.width)return null;c={rect:l,width:d.width,height:d.height,sdf:d.sdf,pixelRatio:d.pixelRatio};
this._copy(l,d,b);return this._mosaicRects[a]=c};d.prototype.getSpriteItems=function(a){for(var b={},c=0;c<a.length;c++){var d=a[c];b[d]=this.getSpriteItem(d)}return b};d.prototype.getMosaicItemPosition=function(a,b){var c=this.getSpriteItem(a,b),d=c&&c.rect;if(!d)return null;d.width=c.width;d.height=c.height;return{size:[c.width,c.height],tl:[(d.x+1)/this._width,(d.y+1)/this._height],br:[(d.x+1+c.width)/this._width,(d.y+1+c.height)/this._height]}};d.prototype.bind=function(a,b,d){void 0===d&&(d=
0);this._texture||(this._texture=new c(a,{pixelFormat:6408,dataType:5121,width:this._width,height:this._height},new Uint8Array(this._mosaicData.buffer)));this._texture.setSamplingMode(b);a.bindTexture(this._texture,d);this._dirty&&this._texture.updateData(0,0,0,this._width,this._height,new Uint8Array(this._mosaicData.buffer));this._dirty=!1};d._copyBits=function(a,b,c,d,l,g,p,k,r,q){c=d*b+c;p=k*g+p;for(k=0;k<q;k++){for(d=0;d<r;d++)l[p+d]=a[c+d];c+=b;p+=g}};d.prototype._copy=function(a,b,c){if(this._sprites&&
"loaded"===this._sprites.loadStatus){c=new Uint32Array(this._sprites.image.buffer);var m=this._mosaicData;(!m||!c)&&console.error("Source or target images are uninitialized!");d._copyBits(c,this._sprites.width,b.x,b.y,m,this._width,a.x+1,a.y+1,b.width,b.height);this._dirty=!0}};d.prototype._allocateImage=function(b,c){b+=2;c+=2;var d=this._binPack.allocate(b+(b%4?4-b%4:0),c+(c%4?4-c%4:0));0>=d.width&&(console.warn("Out of sprite mosaic space!"),d=new a(0,0,0,0));return d};d.prototype._dispose=function(){this._binPack=
this._mosaicData=null;this._mosaicRects={};this._dirty=!0};return d}()})},"esri/layers/vectorTiles/views/vectorTiles/Rect":function(){define(["require","exports"],function(k,g){return function(){function a(a,c,d,e){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=0);void 0===e&&(e=0);this.x=a;this.y=c;this.width=d;this.height=e}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});return a}()})},"esri/layers/vectorTiles/views/vectorTiles/RectangleBinPack":function(){define(["require",
"exports","./Rect"],function(k,g,a){return function(){function b(b,d){this._height=this._width=0;this._free=[];this._width=b;this._height=d;this._free.push(new a(0,0,b,d))}b.prototype.allocate=function(b,d){for(var e=null,f=-1,h=0;h<this._free.length;++h){var m=this._free[h];if(b<=m.width&&d<=m.height&&(null===e||m.y<=e.y&&m.x<=e.x))e=m,f=h}if(null===e)return new a;this._free.splice(f,1);e.width<e.height?(e.width>b&&this._free.push(new a(e.x+b,e.y,e.width-b,d)),e.height>d&&this._free.push(new a(e.x,
e.y+d,e.width,e.height-d))):(e.width>b&&this._free.push(new a(e.x+b,e.y,e.width-b,e.height)),e.height>d&&this._free.push(new a(e.x,e.y+d,b,e.height-d)));return new a(e.x,e.y,b,d)};b.prototype.release=function(a){for(var b=this._free.length,e=0;e<b;++e){var f=this._free[e];if(f.y===a.y&&f.height===a.height&&f.x+f.width===a.x)f.width+=a.width;else if(f.x===a.x&&f.width===a.width&&f.y+f.height===a.y)f.height+=a.height;else if(a.y===f.y&&a.height===f.height&&a.x+a.width===f.x)f.x=a.x,f.width+=a.width;
else if(a.x===f.x&&a.width===f.width&&a.y+a.height===f.y)f.y=a.y,f.height+=a.height;else continue;this._free.splice(e,1);this.release(a)}this._free.push(a)};return b}()})},"esri/layers/vectorTiles/views/vectorTiles/SpriteSource":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper dojo/Deferred dojo/promise/all ../../request ../../identity/IdentityManager ../../core/promiseUtils".split(" "),function(k,g,a,b,c,d,e,f,h){return function(){function a(b,
c){this.baseURL=b;this.devicePixelRatio=c;this._isRetina=!1;this._spritesData={};this.height=this.width=this.image=null;this.loadStatus="not-loaded"}a.prototype.getSpritePosition=function(a){return this._spritesData[a]};a.prototype.load=function(){var a=this;this.loadStatus="loading";return this._loadSprites().then(function(){a.loadStatus="loaded";return a}).otherwise(function(b){a.loadStatus="failed";return h.reject(b)})};a.prototype._loadSprites=function(){var a=this;this._isRetina=1.15<this.devicePixelRatio?
!0:!1;var b=this.baseURL,h=this._isRetina?"@2x":"",m=e(b+h+".json",{callbackParamName:"callback",responseType:"json"}).then(function(b){a._spritesData=b.data}),g=new c,k=new Image;k.crossOrigin="anonymous";k.onload=function(){k.onload=null;a.width=k.width;a.height=k.height;var b=document.createElement("canvas");b.width=k.width;b.height=k.height;b=b.getContext("2d");b.drawImage(k,0,0,k.width,k.height);b=b.getImageData(0,0,k.width,k.height);a.image=new Uint8Array(b.data);g.resolve()};b=""+b+h+".png";
(h=f.findCredential(b))&&h.token&&(b+="?token\x3d"+h.token);k.src=b;return d([m,g.promise])};return a}()})},"esri/layers/vectorTiles/identity/IdentityManager":function(){define(["require","exports","esri/IdentityManager"],function(k,g,a){g.findCredential=function(b){return a.findCredential(b)}})},"esri/IdentityManager":function(){define(["./IdentityManagerDialog","./kernel","./OAuthSignInHandler","dojo/_base/declare"],function(k,g,a,b){k=new k;g.id=b.safeMixin(k,a);return g.id})},"esri/IdentityManagerDialog":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/has dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ./kernel ./lang ./domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/jsapi dojo/query dijit/form/Button dijit/form/Form dijit/form/ValidationTextBox".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l,n,p,s,r,q){g=g([r],{declaredClass:"esri.IdentityManager",_eventMap:{"dialog-cancel":["info"]},constructor:function(a){c.mixin(this,a);this.registerConnectEvents()},_dialogContent:"\x3cdiv data-dojo-type\x3d'dijit.form.Form' data-dojo-props\x3d'\"class\":\"esriIdForm\"'\x3e\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblUser}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblPwd}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
onDialogCreate:function(){},onDialogCancel:function(){},signIn:function(c,d,f){this._nls||(this._nls=q.identity);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.onDialogCreate());var h=this._loginDialog,l=f&&f.error,m=f&&f.token,g=new b(function(){h.onCancel()});if(h.open)return c=Error("BUSY"),c.code="IdentityManager.1",c.log=a.isDebug,g.errback(c),g;p.hide(h.errMsg_);l&&(403==l.code&&m)&&(e.set(h.errMsg_,"innerHTML",this._nls.forbidden),p.show(h.errMsg_));h.dfd_=
g;h.serverInfo_=d;h.resUrl_=c;h.admin_=f&&f.isAdmin;e.set(h.resLink_,{title:c,innerHTML:"("+(this.getResourceName(c)||this._nls.lblItem)+")"});e.set(h.serverLink_,{title:d.server,innerHTML:(-1!==d.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":d.server)+" "});h.txtPwd_.set("value","");h.show();return g},_createLoginDialog:function(){var b=this._nls,c=n.substitute(b,this._dialogContent),c=n.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",
server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},c),d=new m({title:b.title,content:c,"class":"esriSignInDialog",style:"width: 18em;",esriIdMgr_:this,keypressed_:function(a){a.charOrCode===f.ENTER&&this.execute_()},execute_:function(){var a=this.txtUser_.get("value"),c=this.txtPwd_.get("value"),d=this.dfd_,f=this;if(this.form_.validate()&&a&&c){this.btnSubmit_.set("label",b.lblSigning);var h=l.id.findCredential(f.resUrl_,a),g=function(c){f.btnSubmit_.set("label",
b.lblOk);f.btnSubmit_.set("disabled",!1);p.hide(f.errMsg_);f.hide();m._DialogLevelManager.hide(f);var e=f.serverInfo_;f.dfd_=f.serverInfo_=f.generateDfd_=f.resUrl_=null;var l,g,k=h,q;c&&(l=c.token,g=n.isDefined(c.expires)?Number(c.expires):null,q=!!c.ssl,k?(k.userId=a,k.token=l,k.expires=g,k.validity=c.validity,k.ssl=q,k.creationTime=(new Date).getTime()):k=new s({userId:a,server:e.server,token:l,expires:g,ssl:q,isAdmin:f.admin_,validity:c.validity}));d.callback(k)};h&&!h._enqueued?g():(f.btnSubmit_.set("disabled",
!0),f.generateDfd_=l.id.generateToken(this.serverInfo_,{username:a,password:c},{isAdmin:this.admin_}).addCallback(g).addErrback(function(a){f.btnSubmit_.set("disabled",!1);f.generateDfd_=null;f.btnSubmit_.set("label",b.lblOk);e.set(f.errMsg_,"innerHTML",a&&a.code?b.invalidUser:b.noAuthService);p.show(f.errMsg_)}))}},cancel_:function(){d.generateDfd_&&d.generateDfd_.cancel();var b=d.dfd_,c=d.resUrl_,e=d.serverInfo_;d.btnSubmit_.set("disabled",!1);d.dfd_=d.serverInfo_=d.generateDfd_=d.resUrl_=null;
p.hide(d.errMsg_);m._DialogLevelManager.hide(d);d.esriIdMgr_.onDialogCancel({resourceUrl:c,serverInfo:e});c=Error("ABORTED");c.code="IdentityManager.2";c.log=a.isDebug;b.errback(c)}}),c=d.domNode;d.form_=h.byNode(k.query(".esriIdForm",c)[0]);d.txtUser_=h.byNode(k.query(".esriIdUser",c)[0]);d.txtPwd_=h.byNode(k.query(".esriIdPwd",c)[0]);d.btnSubmit_=h.byNode(k.query(".esriIdSubmit",c)[0]);d.btnCancel_=h.byNode(k.query(".esriIdCancel",c)[0]);d.resLink_=k.query(".resLink",c)[0];d.serverLink_=k.query(".serverLink",
c)[0];d.errMsg_=k.query(".esriErrorMsg",c)[0];d.connect(d.txtUser_,"onKeyPress",d.keypressed_);d.connect(d.txtPwd_,"onKeyPress",d.keypressed_);d.connect(d.btnSubmit_,"onClick",d.execute_);d.connect(d.btnCancel_,"onClick",d.onCancel);d.connect(d,"onCancel",d.cancel_);return d}});d("extend-esri")&&(l.IdentityManagerDialog=l.IdentityManager=g);return g})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l,n,p,s,r,q,t,x,u,w,v,y,z,A,C,F,G,J,E,H){function N(){}var L=new c;L.resolve(!0);v=b("dijit._DialogBase"+(q("dojo-bidi")?"_NoBidi":""),[z,C,F,A],{templateString:H,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:v.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(a){this._set("draggable",a)},maxRatio:0.9,
closable:!0,_setClosableAttr:function(a){this.closeButtonNode.style.display=a?"":"none";this._set("closable",a)},postMixInProperties:function(){var a=l.getLocalization("dijit","common");p.mixin(this,a);this.inherited(arguments)},postCreate:function(){h.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);a.after(this,"onExecute",p.hitch(this,"hide"),!0);a.after(this,"onCancel",p.hitch(this,"hide"),!0);this._modalconnects=
[]},onLoad:function(){this.resize();this._position();this.autofocus&&D.isTop(this)&&(this._getFocusItems(),w.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();w.focus(this._firstFocusItem)},_endDrag:function(){var a=f.position(this.domNode),b=t.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,0),b.h-a.h);a.x=Math.min(Math.max(a.x,0),b.w-a.w);this._relativePosition=a;this._position()},_setup:function(){var b=this.domNode;this.titleBar&&this.draggable?
(this._moveable=new (6==q("ie")?u:x)(b,{handle:this.titleBar}),a.after(this._moveable,"onMoveStop",p.hitch(this,"_endDrag"),!0)):e.add(b,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":g.map(this["class"].split(/\s/),function(a){return a+"_underlay"}).join(" "),_onKeyDown:p.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!e.contains(this.ownerDocumentBody,"dojoMove")){var a=this.domNode,b=t.getBox(this.ownerDocument),
c=this._relativePosition,d=f.position(a),l=Math.floor(b.l+(c?Math.min(c.x,b.w-d.w):(b.w-d.w)/2)),b=Math.floor(b.t+(c?Math.min(c.y,b.h-d.h):(b.h-d.h)/2));h.set(a,{left:l+"px",top:b+"px"})}},_onKey:function(a){if(a.keyCode==n.TAB){this._getFocusItems();var b=a.target;this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):b==this._firstFocusItem&&a.shiftKey?(w.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):b==this._lastFocusItem&&!a.shiftKey&&(w.focus(this._firstFocusItem),
a.stopPropagation(),a.preventDefault())}else this.closable&&a.keyCode==n.ESCAPE&&(this.onCancel(),a.stopPropagation(),a.preventDefault())},show:function(){if(this.open)return L.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),D.hide(this));var a=t.get(this.ownerDocument);this._modalconnects.push(s(a,"scroll",p.hitch(this,"resize",null)));this._modalconnects.push(s(this.domNode,"keydown",
p.hitch(this,"_onKey")));h.set(this.domNode,{opacity:0,display:""});this._set("open",!0);this._onShow();this.resize();this._position();var b;this._fadeInDeferred=new c(p.hitch(this,function(){b.stop();delete this._fadeInDeferred}));this._fadeInDeferred.then(void 0,N);a=this._fadeInDeferred.promise;b=m.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:p.hitch(this,function(){D.show(this,this.underlayAttrs)}),onEnd:p.hitch(this,function(){this.autofocus&&D.isTop(this)&&(this._getFocusItems(),
w.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();return a},hide:function(){if(!this._alreadyInitialized||!this.open)return L.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();var a;this._fadeOutDeferred=new c(p.hitch(this,function(){a.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(void 0,N);this._fadeOutDeferred.then(p.hitch(this,"onHide"));var b=this._fadeOutDeferred.promise;a=m.fadeOut({node:this.domNode,duration:this.duration,
onEnd:p.hitch(this,function(){this.domNode.style.display="none";D.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();this._scrollConnected&&(this._scrollConnected=!1);for(var d;d=this._modalconnects.pop();)d.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return b},resize:function(a){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!a){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&
(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),g.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode],function(a){a&&h.set(a,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var b=t.getBox(this.ownerDocument);b.w*=this.maxRatio;b.h*=this.maxRatio;var c=f.position(this.domNode);c.w>=b.w||c.h>=b.h?(a={w:Math.min(c.w,b.w),h:Math.min(c.h,b.h)},this._shrunk=!0):this._shrunk=!1}if(a){f.setMarginBox(this.domNode,
a);b=[];this.titleBar&&b.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&b.push({domNode:this.actionBarNode,region:"bottom"});c={domNode:this.containerNode,region:"center"};b.push(c);var d=E.marginBox2contentBox(this.domNode,a);E.layoutChildren(this.domNode,d,b);this._singleChild?(b=E.marginBox2contentBox(this.containerNode,c),this._singleChild.resize({w:b.w,h:b.h})):(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();!q("touch")&&!a&&this._position()}},
_layoutChildren:function(){g.forEach(this.getChildren(),function(a){a.resize&&a.resize()})},destroy:function(){this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var a;a=this._modalconnects.pop();)a.remove();D.hide(this);this.inherited(arguments)}});q("dojo-bidi")&&(v=b("dijit._DialogBase",v,{_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},
_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title))}}));var I=b("dijit.Dialog",[J,v],{});I._DialogBase=v;var D=I._DialogLevelManager={_beginZIndex:950,show:function(a,b){B[B.length-1].focus=w.curNode;var c=B[B.length-1].dialog?B[B.length-1].zIndex+2:I._DialogLevelManager._beginZIndex;h.set(a.domNode,"zIndex",c);G.show(b,c-1);B.push({dialog:a,underlayAttrs:b,zIndex:c})},hide:function(a){if(B[B.length-1].dialog==a){B.pop();var b=B[B.length-
1];1==B.length?G.hide():G.show(b.underlayAttrs,b.zIndex-1);if(a.refocus){a=b.focus;if(b.dialog&&(!a||!d.isDescendant(a,b.dialog.domNode)))b.dialog._getFocusItems(),a=b.dialog._firstFocusItem;if(a)try{a.focus()}catch(c){}}}else b=g.indexOf(g.map(B,function(a){return a.dialog}),a),-1!=b&&B.splice(b,1)},isTop:function(a){return B[B.length-1].dialog==a}},B=I._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];w.watch("curNode",function(a,b,c){a=B[B.length-1].dialog;if(c&&a&&!a._fadeOutDeferred&&
c.ownerDocument==a.ownerDocument){do if(c==a.domNode||e.contains(c,"dijitPopup"))return;while(c=c.parentNode);a.focus()}});q("dijit-legacy-requires")&&r(0,function(){k(["dijit/TooltipDialog"])});return I})},"dojo/dnd/Moveable":function(){define("../_base/array ../_base/declare ../_base/lang ../dom ../dom-class ../Evented ../on ../topic ../touch ./common ./Mover ../_base/window".split(" "),function(k,g,a,b,c,d,e,f,h,m,l,n){return g("dojo.dnd.Moveable",[d],{handle:"",delay:0,skip:!1,constructor:function(c,
d){this.node=b.byId(c);d||(d={});this.handle=d.handle?b.byId(d.handle):null;this.handle||(this.handle=this.node);this.delay=0<d.delay?d.delay:0;this.skip=d.skip;this.mover=d.mover?d.mover:l;this.events=[e(this.handle,h.press,a.hitch(this,"onMouseDown")),e(this.handle,"dragstart",a.hitch(this,"onSelectStart")),e(this.handle,"selectstart",a.hitch(this,"onSelectStart"))]},markupFactory:function(a,b,c){return new c(b,a)},destroy:function(){k.forEach(this.events,function(a){a.remove()});this.events=this.node=
this.handle=null},onMouseDown:function(b){if(!this.skip||!m.isFormElement(b)){if(this.delay)this.events.push(e(this.handle,h.move,a.hitch(this,"onMouseMove")),e(this.handle.ownerDocument,h.release,a.hitch(this,"onMouseUp"))),this._lastX=b.pageX,this._lastY=b.pageY;else this.onDragDetected(b);b.stopPropagation();b.preventDefault()}},onMouseMove:function(a){if(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)this.onMouseUp(a),this.onDragDetected(a);a.stopPropagation();
a.preventDefault()},onMouseUp:function(a){for(var b=0;2>b;++b)this.events.pop().remove();a.stopPropagation();a.preventDefault()},onSelectStart:function(a){if(!this.skip||!m.isFormElement(a))a.stopPropagation(),a.preventDefault()},onDragDetected:function(a){new this.mover(this.node,a,this)},onMoveStart:function(a){f.publish("/dnd/move/start",a);c.add(n.body(),"dojoMove");c.add(this.node,"dojoMoveItem")},onMoveStop:function(a){f.publish("/dnd/move/stop",a);c.remove(n.body(),"dojoMove");c.remove(this.node,
"dojoMoveItem")},onFirstMove:function(){},onMove:function(a,b){this.onMoving(a,b);var c=a.node.style;c.left=b.l+"px";c.top=b.t+"px";this.onMoved(a,b)},onMoving:function(){},onMoved:function(){}})})},"dojo/dnd/common":function(){define(["../sniff","../_base/kernel","../_base/lang","../dom"],function(k,g,a,b){var c=a.getObject("dojo.dnd",!0);c.getCopyKeyState=function(a){return a[k("mac")?"metaKey":"ctrlKey"]};c._uniqueId=0;c.getUniqueId=function(){var a;do a=g._scopeName+"Unique"+ ++c._uniqueId;while(b.byId(a));
return a};c._empty={};c.isFormElement=function(a){a=a.target;3==a.nodeType&&(a=a.parentNode);return 0<=" a button textarea input select option ".indexOf(" "+a.tagName.toLowerCase()+" ")};return c})},"dojo/dnd/Mover":function(){define("../_base/array ../_base/declare ../_base/lang ../sniff ../_base/window ../dom ../dom-geometry ../dom-style ../Evented ../on ../touch ./common ./autoscroll".split(" "),function(k,g,a,b,c,d,e,f,h,m,l,n,p){return g("dojo.dnd.Mover",[h],{constructor:function(b,c,e){function f(a){a.preventDefault();
a.stopPropagation()}this.node=d.byId(b);this.marginBox={l:c.pageX,t:c.pageY};this.mouseButton=c.button;c=this.host=e;b=b.ownerDocument;this.events=[m(b,l.move,a.hitch(this,"onFirstMove")),m(b,l.move,a.hitch(this,"onMouseMove")),m(b,l.release,a.hitch(this,"onMouseUp")),m(b,"dragstart",f),m(b.body,"selectstart",f)];p.autoScrollStart(b);if(c&&c.onMoveStart)c.onMoveStart(this)},onMouseMove:function(a){p.autoScroll(a);var b=this.marginBox;this.host.onMove(this,{l:b.l+a.pageX,t:b.t+a.pageY},a);a.preventDefault();
a.stopPropagation()},onMouseUp:function(a){(b("webkit")&&b("mac")&&2==this.mouseButton?0==a.button:this.mouseButton==a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var b=this.node.style,d,h=this.host;switch(b.position){case "relative":case "absolute":d=Math.round(parseFloat(b.left))||0;b=Math.round(parseFloat(b.top))||0;break;default:b.position="absolute";b=e.getMarginBox(this.node);d=c.doc.body;var l=f.getComputedStyle(d),m=e.getMarginBox(d,l),l=e.getContentBox(d,
l);d=b.l-(l.l-m.l);b=b.t-(l.t-m.t)}this.marginBox.l=d-this.marginBox.l;this.marginBox.t=b-this.marginBox.t;if(h&&h.onFirstMove)h.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){k.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"dojo/dnd/autoscroll":function(){define("../_base/lang ../sniff ../_base/window ../dom-geometry ../dom-style ../window".split(" "),function(k,g,a,b,c,d){var e=
{};k.setObject("dojo.dnd.autoscroll",e);e.getViewport=d.getBox;e.V_TRIGGER_AUTOSCROLL=32;e.H_TRIGGER_AUTOSCROLL=32;e.V_AUTOSCROLL_VALUE=16;e.H_AUTOSCROLL_VALUE=16;var f,h=a.doc,m=Infinity,l=Infinity;e.autoScrollStart=function(b){h=b;f=d.getBox(h);b=a.body(h).parentNode;m=Math.max(b.scrollHeight-f.h,0);l=Math.max(b.scrollWidth-f.w,0)};e.autoScroll=function(b){var c=f||d.getBox(h),g=a.body(h).parentNode,k=0,q=0;b.clientX<e.H_TRIGGER_AUTOSCROLL?k=-e.H_AUTOSCROLL_VALUE:b.clientX>c.w-e.H_TRIGGER_AUTOSCROLL&&
(k=Math.min(e.H_AUTOSCROLL_VALUE,l-g.scrollLeft));b.clientY<e.V_TRIGGER_AUTOSCROLL?q=-e.V_AUTOSCROLL_VALUE:b.clientY>c.h-e.V_TRIGGER_AUTOSCROLL&&(q=Math.min(e.V_AUTOSCROLL_VALUE,m-g.scrollTop));window.scrollBy(k,q)};e._validNodes={div:1,p:1,td:1};e._validOverflow={auto:1,scroll:1};e.autoScrollNodes=function(d){for(var f,h,l,m,k,x,u=0,w=0,v=d.target;v;){if(1==v.nodeType&&v.tagName.toLowerCase()in e._validNodes){l=c.getComputedStyle(v);m=l.overflow.toLowerCase()in e._validOverflow;k=l.overflowX.toLowerCase()in
e._validOverflow;x=l.overflowY.toLowerCase()in e._validOverflow;if(m||k||x)f=b.getContentBox(v,l),h=b.position(v,!0);if(m||k){l=Math.min(e.H_TRIGGER_AUTOSCROLL,f.w/2);k=d.pageX-h.x;if(g("webkit")||g("opera"))k+=a.body().scrollLeft;u=0;0<k&&k<f.w&&(k<l?u=-l:k>f.w-l&&(u=l),v.scrollLeft+=u)}if(m||x){m=Math.min(e.V_TRIGGER_AUTOSCROLL,f.h/2);x=d.pageY-h.y;if(g("webkit")||g("opera"))x+=a.body().scrollTop;w=0;0<x&&x<f.h&&(x<m?w=-m:x>f.h-m&&(w=m),v.scrollTop+=w)}if(u||w)return}try{v=v.parentNode}catch(y){v=
null}}e.autoScroll(d)};return e})},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(k,g){var a=g.prototype.onMove;return k("dojo.dnd.TimedMoveable",g,{timeout:40,constructor:function(a,c){c||(c={});c.timeout&&("number"==typeof c.timeout&&0<=c.timeout)&&(this.timeout=c.timeout)},onMoveStop:function(b){b._timer&&(clearTimeout(b._timer),a.call(this,b,b._leftTop));g.prototype.onMoveStop.apply(this,arguments)},onMove:function(b,c){b._leftTop=c;if(!b._timer){var d=this;
b._timer=setTimeout(function(){b._timer=null;a.call(d,b,b._leftTop)},this.timeout)}}})})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),function(k,g,a,b,c,d,e,f,h,m,l,n,p){function s(){}function r(b){return function(c,d,f,h){return c&&"string"==typeof d&&c[d]==s?c.on(d.substring(2).toLowerCase(),
e.hitch(f,h)):b.apply(a,arguments)}}k.around(a,"connect",r);d.connect&&k.around(d,"connect",r);k=b("dijit._Widget",[l,n,p],{onClick:s,onDblClick:s,onKeyDown:s,onKeyPress:s,onKeyUp:s,onMouseDown:s,onMouseMove:s,onMouseOut:s,onMouseOver:s,onMouseLeave:s,onMouseEnter:s,onMouseUp:s,constructor:function(a){this._toConnect={};for(var b in a)this[b]===s&&(this._toConnect[b.replace(/^on/,"").toLowerCase()]=a[b],delete a[b])},postCreate:function(){this.inherited(arguments);for(var a in this._toConnect)this.on(a,
this._toConnect[a]);delete this._toConnect},on:function(b,c){return this[this._onMap(b)]===s?a.connect(this.domNode,b.toLowerCase(),this,c):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(a,b){d.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(a,b)},attr:function(a,b){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,arguments):this.get(a)},getDescendants:function(){d.deprecated(this.declaredClass+
"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?f("[widgetId]",this.containerNode).map(m.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});c("dijit-legacy-requires")&&h(0,function(){require(["dijit/_base"])});return k})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l,n,p,s,r,q,t,x,u,w,v,y,z){function A(a){return function(b){f[b?"set":"remove"](this.domNode,a,b);this._set(a,b)}}p.add("dijit-legacy-requires",!s.isAsync);p.add("dojo-bidi",!1);p("dijit-legacy-requires")&&t(0,function(){k(["dijit/_base/manager"])});var C={};b=d("dijit._WidgetBase",[x,v],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:A("lang"),dir:"",_setDirAttr:A("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",a)},attributeMap:{},_blankGif:b.blankGif||k.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var b=a.prototype,c=a._setterAttrs=[],a=a._onMap={},d;for(d in b.attributeMap)c.push(d);for(d in b)/^on/.test(d)&&(a[d.substring(2).toLowerCase()]=d),/^_set[A-Z](.*)Attr$/.test(d)&&(d=d.charAt(4).toLowerCase()+
d.substr(5,d.length-9),(!b.attributeMap||!(d in b.attributeMap))&&c.push(d))}},postscript:function(a,b){this.create(a,b)},create:function(a,b){this._introspect();this.srcNodeRef=e.byId(b);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&(this.srcNodeRef.id&&"string"==typeof this.srcNodeRef.id)&&(this.id=this.srcNodeRef.id);a&&(this.params=a,r.mixin(this,a));this.postMixInProperties();this.id||(this.id=z.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);
this.ownerDocument=this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=w.body(this.ownerDocument);z.add(this);this.buildRendering();var c;if(this.domNode){this._applyAttributes();var d=this.srcNodeRef;d&&(d.parentNode&&this.domNode!==d)&&(d.parentNode.replaceChild(this.domNode,d),c=!0);this.domNode.setAttribute("widgetId",this.id)}this.postCreate();c&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},b;for(b in this.params||
{})a[b]=this._get(b);g.forEach(this.constructor._setterAttrs,function(b){if(!(b in a)){var c=this._get(b);c&&this.set(b,c)}},this);for(b in a)this.set(b,a[b])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var a=this.baseClass.split(" ");this.isLeftToRight()||(a=a.concat(g.map(a,function(a){return a+"Rtl"})));h.add(this.domNode,a)}},postCreate:function(){},startup:function(){this._started||
(this._started=!0,g.forEach(this.getChildren(),function(a){!a._started&&(!a._destroyed&&r.isFunction(a.startup))&&(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function b(c){c.destroyRecursive?c.destroyRecursive(a):c.destroy&&c.destroy(a)}this._beingDestroyed=!0;this.uninitialize();g.forEach(this._connects,r.hitch(this,"disconnect"));g.forEach(this._supportingWidgets,b);this.domNode&&g.forEach(z.findWidgets(this.domNode,
this.containerNode),b);this.destroyRendering(a);z.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);this.domNode&&(a?f.remove(this.domNode,"widgetId"):m.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||m.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){g.forEach(this.getChildren(),function(b){b.destroyRecursive&&b.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(a){var b=
this.domNode;r.isObject(a)?n.set(b,a):b.style.cssText=b.style.cssText?b.style.cssText+("; "+a):a;this._set("style",a)},_attrToDom:function(a,b,c){c=3<=arguments.length?c:this.attributeMap[a];g.forEach(r.isArray(c)?c:[c],function(c){var d=this[c.node||c||"domNode"];switch(c.type||"attribute"){case "attribute":r.isFunction(b)&&(b=r.hitch(this,b));c=c.attribute?c.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;d.tagName?f.set(d,c,b):d.set(c,b);break;case "innerText":d.innerHTML="";d.appendChild(this.ownerDocument.createTextNode(b));
break;case "innerHTML":d.innerHTML=b;break;case "class":h.replace(d,b,this[a]);break;case "toggleClass":h.toggle(d,c.className||a,b)}},this)},get:function(a){var b=this._getAttrNames(a);return this[b.g]?this[b.g]():this._get(a)},set:function(a,b){if("object"===typeof a){for(var c in a)this.set(c,a[c]);return this}c=this._getAttrNames(a);var d=this[c.s];if(r.isFunction(d))var e=d.apply(this,Array.prototype.slice.call(arguments,1));else{var d=this.focusNode&&!r.isFunction(this.focusNode)?"focusNode":
"domNode",f=this[d]&&this[d].tagName,h;if(h=f)if(!(h=C[f])){h=this[d];var l={},m;for(m in h)l[m.toLowerCase()]=!0;h=C[f]=l}m=h;c=a in this.attributeMap?this.attributeMap[a]:c.s in this?this[c.s]:m&&c.l in m&&"function"!=typeof b||/^aria-|^data-|^role$/.test(a)?d:null;null!=c&&this._attrToDom(a,b,c);this._set(a,b)}return e||this},_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;if(b[a])return b[a];var c=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});
return b[a]={n:a+"Node",s:"_set"+c+"Attr",g:"_get"+c+"Attr",l:c.toLowerCase()}},_set:function(a,b){var c=this[a];this[a]=b;if(this._created&&!(c===b||c!==c&&b!==b))this._watchCallbacks&&this._watchCallbacks(a,c,b),this.emit("attrmodified-"+a,{detail:{prevValue:c,newValue:b}})},_get:function(a){return this[a]},emit:function(a,b,c){b=b||{};void 0===b.bubbles&&(b.bubbles=!0);void 0===b.cancelable&&(b.cancelable=!0);b.detail||(b.detail={});b.detail.widget=this;var d,e=this["on"+a];e&&(d=e.apply(this,
c?c:[b]));this._started&&!this._beingDestroyed&&q.emit(this.domNode,a.toLowerCase(),b);return d},on:function(b,c){var d=this._onMap(b);return d?a.after(this,d,c,!0):this.own(q(this.domNode,b,c))[0]},_onMap:function(a){var b=this.constructor,c=b._onMap;if(!c){var c=b._onMap={},d;for(d in b.prototype)/^on/.test(d)&&(c[d.replace(/^on/,"").toLowerCase()]=d)}return c["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?
z.findWidgets(this.containerNode):[]},getParent:function(){return z.getEnclosingWidget(this.domNode.parentNode)},connect:function(a,b,d){return this.own(c.connect(a,b,this,d))[0]},disconnect:function(a){a.remove()},subscribe:function(a,b){return this.own(u.subscribe(a,r.hitch(this,b)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():l.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=n.get(this.domNode,"display")},
placeAt:function(a,b){var c=!a.tagName&&z.byId(a);c&&c.addChild&&(!b||"number"===typeof b)?c.addChild(this,b):(c=c&&"domNode"in c?c.containerNode&&!/after|before|replace/.test(b||"")?c.containerNode:c.domNode:e.byId(a,this.ownerDocument),m.place(this.domNode,c,b),!this._started&&(this.getParent()||{})._started&&this.startup());return this},defer:function(a,b){var c=setTimeout(r.hitch(this,function(){c&&(c=null,this._destroyed||r.hitch(this,a)())}),b||0);return{remove:function(){c&&(clearTimeout(c),
c=null);return null}}}});p("dojo-bidi")&&b.extend(y);return b})},"dijit/Destroyable":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(k,g,a){return a("dijit.Destroyable",null,{destroy:function(a){this._destroyed=!0},own:function(){var a=["destroyRecursive","destroy","remove"];k.forEach(arguments,function(c){function d(){f.remove();k.forEach(h,function(a){a.remove()})}var e,f=g.before(this,"destroy",function(a){c[e](a)}),h=[];c.then?(e="cancel",c.then(d,d)):k.forEach(a,
function(a){"function"===typeof c[a]&&(e||(e=a),h.push(g.after(c,a,d,!0)))})},this);return arguments}})})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),function(k,g,a,b,c,d){k=b("dijit._OnDijitClickMixin",null,{connect:function(a,b,c){return this.inherited(arguments,[a,"ondijitclick"==b?d:b,c])}});k.a11yclick=d;return k})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],
function(k,g,a,b){b.extend(g,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return a("dijit._FocusMixin",null,{_focusManager:k})})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(k,g,a,b){a(function(){g("highcontrast")&&k.add(b.body(),"dijit_a11y")});return g})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),
function(k,g,a,b,c,d,e){c.add("highcontrast",function(){var a=e.doc.createElement("div");try{a.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+(g.blankGif||k.toUrl("./resources/blank.gif"))+'");';e.body().appendChild(a);var d=b.getComputedStyle(a),m=d.backgroundImage;return d.borderTopColor==d.borderRightColor||m&&("none"==m||"url(invalid-url:)"==m)}catch(l){return console.warn("hccss: exception detecting high-contrast mode, document is likely hidden: "+
l.toString()),!1}finally{8>=c("ie")?a.outerHTML="":e.body().removeChild(a)}});d(function(){c("highcontrast")&&a.add(e.body(),"dj_a11y")});return c})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(k,g,a,b,c,d,e,f){var h=g("dijit._TemplatedMixin",f,{templateString:null,templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(a){var c=this.declaredClass,
d=this;return e.substitute(a,this,function(a,e){"!"==e.charAt(0)&&(a=b.getObject(e.substr(1),!1,d));if("undefined"==typeof a)throw Error(c+" template:"+e);return null==a?"":"!"==e.charAt(0)?a:this._escapeValue(""+a)},this)},_escapeValue:function(a){return a.replace(/["'<>&]/g,function(a){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[a]})},buildRendering:function(){if(!this._rendered){this.templateString||(this.templateString=k(this.templatePath,{sanitize:!0}));
var c=h.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),d;if(b.isString(c)){if(d=a.toDom(this._stringRepl(c),this.ownerDocument),1!=d.nodeType)throw Error("Invalid template: "+c);}else d=c.cloneNode(!0);this.domNode=d}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(a){var b=this.containerNode;if(a&&b)for(;a.hasChildNodes();)b.appendChild(a.firstChild)}});h._templateCache={};h.getCachedTemplate=function(b,
c,d){var f=h._templateCache,g=b,k=f[g];if(k){try{if(!k.ownerDocument||k.ownerDocument==(d||document))return k}catch(q){}a.destroy(k)}b=e.trim(b);if(c||b.match(/\$\{([^\}]+)\}/g))return f[g]=b;c=a.toDom(b,d);if(1!=c.nodeType)throw Error("Invalid template: "+b);return f[g]=c};d("ie")&&c(window,"unload",function(){var b=h._templateCache,c;for(c in b){var d=b[c];"object"==typeof d&&a.destroy(d);delete b[c]}});return h})},"dojo/cache":function(){define(["./_base/kernel","./text"],function(k){return k.cache})},
"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(k,g,a,b,c,d,e,f,h){var m=c.delegate(f,{mouseenter:d.enter,mouseleave:d.leave,keypress:a._keypress}),l;a=b("dijit._AttachMixin",null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);this._beforeFillContent()},
_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var b=a;;)if(1==b.nodeType&&(this._processTemplateNode(b,function(a,b){return a.getAttribute(b)},this._attach)||this.searchContainerNode)&&b.firstChild)b=b.firstChild;else{if(b==a)break;for(;!b.nextSibling;)if(b=b.parentNode,b==a)return;b=b.nextSibling}},_processTemplateNode:function(a,b,d){var e=!0,f=this.attachScope||this,h=b(a,"dojoAttachPoint")||b(a,"data-dojo-attach-point");if(h)for(var l=h.split(/\s*,\s*/);h=l.shift();)c.isArray(f[h])?
f[h].push(a):f[h]=a,e="containerNode"!=h,this._attachPoints.push(h);if(b=b(a,"dojoAttachEvent")||b(a,"data-dojo-attach-event")){h=b.split(/\s*,\s*/);for(l=c.trim;b=h.shift();)if(b){var m=null;-1!=b.indexOf(":")?(m=b.split(":"),b=l(m[0]),m=l(m[1])):b=l(b);m||(m=b);this._attachEvents.push(d(a,b,c.hitch(f,m)))}}return e},_attach:function(a,b,c){b=b.replace(/^on/,"").toLowerCase();b="dijitclick"==b?l||(l=k("./a11yclick")):m[b]||b;return e(a,b,c)},_detachTemplateNodes:function(){var a=this.attachScope||
this;g.forEach(this._attachPoints,function(b){delete a[b]});this._attachPoints=[];g.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});c.extend(h,{dojoAttachEvent:"",dojoAttachPoint:""});return a})},"dijit/_CssStateMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-class dojo/has dojo/_base/lang dojo/on dojo/domReady dojo/touch dojo/_base/window ./a11yclick ./registry".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l,n){g=g("dijit._CssStateMixin",[],{hovering:!1,active:!1,_applyAttributes:function(){this.inherited(arguments);k.forEach("disabled readOnly checked selected focused state hovering active _opened".split(" "),function(a){this.watch(a,d.hitch(this,"_setStateClass"))},this);for(var a in this.cssStateNodes||{})this._trackMouseState(this[a],this.cssStateNodes[a]);this._trackMouseState(this.domNode,this.baseClass);this._setStateClass()},_cssMouseEvent:function(a){if(!this.disabled)switch(a.type){case "mouseover":case "MSPointerOver":case "pointerover":this._set("hovering",
!0);this._set("active",this._mouseDown);break;case "mouseout":case "MSPointerOut":case "pointerout":this._set("hovering",!1);this._set("active",!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":this._set("active",!0);break;case "mouseup":case "dojotouchend":case "MSPointerUp":case "pointerup":case "keyup":this._set("active",!1)}},_setStateClass:function(){function a(c){b=b.concat(k.map(b,function(a){return a+c}),"dijit"+c)}var b=this.baseClass.split(" ");
this.isLeftToRight()||a("Rtl");var c="mixed"==this.checked?"Mixed":this.checked?"Checked":"";this.checked&&a(c);this.state&&a(this.state);this.selected&&a("Selected");this._opened&&a("Opened");this.disabled?a("Disabled"):this.readOnly?a("ReadOnly"):this.active?a("Active"):this.hovering&&a("Hover");this.focused&&a("Focused");var c=this.stateNode||this.domNode,d={};k.forEach(c.className.split(" "),function(a){d[a]=!0});"_stateClasses"in this&&k.forEach(this._stateClasses,function(a){delete d[a]});k.forEach(b,
function(a){d[a]=!0});var e=[],f;for(f in d)e.push(f);c.className=e.join(" ");this._stateClasses=b},_subnodeCssMouseEvent:function(a,c,d){function e(d){b.toggle(a,c+"Active",d)}if(!this.disabled&&!this.readOnly)switch(d.type){case "mouseover":case "MSPointerOver":case "pointerover":b.toggle(a,c+"Hover",!0);break;case "mouseout":case "MSPointerOut":case "pointerout":b.toggle(a,c+"Hover",!1);e(!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":e(!0);
break;case "mouseup":case "MSPointerUp":case "pointerup":case "dojotouchend":case "keyup":e(!1);break;case "focus":case "focusin":b.toggle(a,c+"Focused",!0);break;case "blur":case "focusout":b.toggle(a,c+"Focused",!1)}},_trackMouseState:function(a,b){a._cssState=b}});f(function(){function b(c,d,e){if(!e||!a.isDescendant(e,d))for(;d&&d!=e;d=d.parentNode)if(d._cssState){var f=n.getEnclosingWidget(d);f&&(d==f.domNode?f._cssMouseEvent(c):f._subnodeCssMouseEvent(d,d._cssState,c))}}var c=m.body(),d;e(c,
h.over,function(a){b(a,a.target,a.relatedTarget)});e(c,h.out,function(a){b(a,a.target,a.relatedTarget)});e(c,l.press,function(a){d=a.target;b(a,d)});e(c,l.release,function(a){b(a,d);d=null});e(c,"focusin, focusout",function(a){var b=a.target;if(b._cssState&&!b.getAttribute("widgetId")){var c=n.getEnclosingWidget(b);c&&c._subnodeCssMouseEvent(b,b._cssState,a)}})});return g})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),
function(k,g,a,b,c,d){return g("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(a){var b=[];k.forEach(a||this.getChildren(),function(a){"value"in a?b.push(a):b=b.concat(this._getDescendantFormWidgets(a.getChildren()))},this);return b},reset:function(){k.forEach(this._getDescendantFormWidgets(),function(a){a.reset&&a.reset()})},validate:function(){var a=!1;return k.every(k.map(this._getDescendantFormWidgets(),function(b){b._hasBeenBlurred=!0;var c=b.disabled||!b.validate||
b.validate();!c&&!a&&(d.scrollIntoView(b.containerNode||b.domNode),b.focus(),a=!0);return c}),function(a){return a})},setValues:function(b){a.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",b)},_setValueAttr:function(a){var c={};k.forEach(this._getDescendantFormWidgets(),function(a){a.name&&(c[a.name]||(c[a.name]=[])).push(a)});for(var d in c)if(c.hasOwnProperty(d)){var m=c[d],l=b.getObject(d,!1,a);void 0!==l&&(l=[].concat(l),
"boolean"==typeof m[0].checked?k.forEach(m,function(a){a.set("value",-1!=k.indexOf(l,a._get("value")))}):m[0].multiple?m[0].set("value",l):k.forEach(m,function(a,b){a.set("value",l[b])}))}},getValues:function(){a.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},_getValueAttr:function(){var a={};k.forEach(this._getDescendantFormWidgets(),function(c){var d=c.name;if(d&&!c.disabled){var m=c.get("value");"boolean"==typeof c.checked?
/Radio/.test(c.declaredClass)?!1!==m?b.setObject(d,m,a):(m=b.getObject(d,!1,a),void 0===m&&b.setObject(d,null,a)):(c=b.getObject(d,!1,a),c||(c=[],b.setObject(d,c,a)),!1!==m&&c.push(m)):(c=b.getObject(d,!1,a),"undefined"!=typeof c?b.isArray(c)?c.push(m):b.setObject(d,[c,m],a):b.setObject(d,m,a))}});return a},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var a=k.map(this._descendants,function(a){return a.get("state")||""});return 0<=k.indexOf(a,"Error")?
"Error":0<=k.indexOf(a,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(a){this._descendants=this._getDescendantFormWidgets();k.forEach(this._descendants,function(a){a._started||a.startup()});a||this._onChildChange()},_onChildChange:function(a){(!a||"state"==a||"disabled"==a)&&this._set("state",this._getState());if(!a||"value"==a||"disabled"==a||"checked"==a)this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;
this._set("value",this.get("value"))},10)},startup:function(){this.inherited(arguments);this._descendants=this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var a=this;this.own(c(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(b){b.target!=a.domNode&&a._onChildChange(b.type.replace("attrmodified-",""))}));this.watch("state",function(a,b,c){this.onValidStateChange(""==c)})},destroy:function(){this.inherited(arguments)}})})},
"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(k,g){return k("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var a=g._getTabNavigable(this.domNode);this._firstFocusItem=a.lowest||a.first||this.closeButtonNode||this.domNode;this._lastFocusItem=a.last||a.highest||this._firstFocusItem}})})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l,n){var p=k("dijit.DialogUnderlay",[f,h],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(a){b.set(this.node,"id",a+"_underlay");this._set("dialogId",a)},_setClassAttr:function(a){this.node.className="dijitDialogUnderlay "+a;this._set("class",a)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(d(this.domNode,"keydown",g.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var a=this.node.style,b=this.domNode.style;b.display="none";var c=e.getBox(this.ownerDocument);b.top=c.t+"px";b.left=c.l+"px";a.width=c.w+"px";a.height=c.h+"px";b.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new m(this.domNode);var a=e.get(this.ownerDocument);this._modalConnects=[l.on("resize",g.hitch(this,"layout")),d(a,"scroll",
g.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});p.show=function(a,b){var d=p._singleton;!d||d._destroyed?d=n._underlay=p._singleton=new p(a):a&&d.set(a);c.set(d.domNode,"zIndex",b);d.open||d.show()};p.hide=function(){var a=
p._singleton;a&&!a._destroyed&&a.hide()};return p})},"dijit/BackgroundIframe":function(){define("require ./main dojo/_base/config dojo/dom-construct dojo/dom-style dojo/_base/lang dojo/on dojo/sniff".split(" "),function(k,g,a,b,c,d,e,f){f.add("config-bgIframe",f("ie")&&!/IEMobile\/10\.0/.test(navigator.userAgent)||f("trident")&&/Windows NT 6.[01]/.test(navigator.userAgent));var h=new function(){var d=[];this.pop=function(){var e;d.length?(e=d.pop(),e.style.display=""):(9>f("ie")?(e="\x3ciframe src\x3d'"+
(a.dojoBlankHtmlUrl||k.toUrl("dojo/resources/blank.html")||'javascript:""')+"' role\x3d'presentation' style\x3d'position: absolute; left: 0px; top: 0px;z-index: -1; filter:Alpha(Opacity\x3d\"0\");'\x3e",e=document.createElement(e)):(e=b.create("iframe"),e.src='javascript:""',e.className="dijitBackgroundIframe",e.setAttribute("role","presentation"),c.set(e,"opacity",0.1)),e.tabIndex=-1);return e};this.push=function(a){a.style.display="none";d.push(a)}};g.BackgroundIframe=function(a){if(!a.id)throw Error("no id");
if(f("config-bgIframe")){var b=this.iframe=h.pop();a.appendChild(b);7>f("ie")||f("quirks")?(this.resize(a),this._conn=e(a,"resize",d.hitch(this,"resize",a))):c.set(b,{width:"100%",height:"100%"})}};d.extend(g.BackgroundIframe,{resize:function(a){this.iframe&&c.set(this.iframe,{width:a.offsetWidth+"px",height:a.offsetHeight+"px"})},destroy:function(){this._conn&&(this._conn.remove(),this._conn=null);this.iframe&&(this.iframe.parentNode.removeChild(this.iframe),h.push(this.iframe),delete this.iframe)}});
return g.BackgroundIframe})},"dijit/Viewport":function(){define(["dojo/Evented","dojo/on","dojo/domReady","dojo/sniff","dojo/window"],function(k,g,a,b,c){var d=new k,e;a(function(){var a=c.getBox();d._rlh=g(window,"resize",function(){var b=c.getBox();a.h==b.h&&a.w==b.w||(a=b,d.emit("resize"))});if(8==b("ie")){var h=screen.deviceXDPI;setInterval(function(){screen.deviceXDPI!=h&&(h=screen.deviceXDPI,d.emit("resize"))},500)}b("ios")&&(g(document,"focusin",function(a){e=a.target}),g(document,"focusout",
function(a){e=null}))});d.getEffectiveBox=function(a){a=c.getBox(a);var d=e&&e.tagName&&e.tagName.toLowerCase();if(b("ios")&&e&&!e.readOnly&&("textarea"==d||"input"==d&&/^(color|email|number|password|search|tel|text|url)$/.test(e.type)))a.h*=0==orientation||180==orientation?0.66:0.4,d=e.getBoundingClientRect(),a.h=Math.max(a.h,d.top+d.height);return a};return d})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when dojo/i18n!../nls/loading".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l,n,p,s,r,q){return h("dijit.layout.ContentPane",[a,b,c],{href:"",content:"",extractContent:!1,parseOnLoad:!0,parserScope:k._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",
isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(a,b,c){var d=new c(a,b);return!d.href&&d._contentSetter&&d._contentSetter.parseDeferred&&!d._contentSetter.parseDeferred.isFulfilled()?d._contentSetter.parseDeferred.then(function(){return d}):d},create:function(a,b){if((!a||!a.template)&&b&&!("href"in a)&&!("content"in a)){b=l.byId(b);for(var c=b.ownerDocument.createDocumentFragment();b.firstChild;)c.appendChild(b.firstChild);
a=g.delegate(a,{content:c})}this.inherited(arguments,[a,b])},postMixInProperties:function(){this.inherited(arguments);var a=r.getLocalization("dijit","loading",this.lang);this.loadingMessage=d.substitute(this.loadingMessage,a);this.errorMessage=d.substitute(this.errorMessage,a)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&f.forEach(this._contentSetter.parseResults,
function(a){!a._started&&(!a._destroyed&&g.isFunction(a.startup))&&(a.startup(),a._started=!0)},this)},_startChildren:function(){f.forEach(this.getChildren(),function(a){!a._started&&(!a._destroyed&&g.isFunction(a.startup))&&(a.startup(),a._started=!0)});this._contentSetter&&f.forEach(this._contentSetter.parseResults,function(a){!a._started&&(!a._destroyed&&g.isFunction(a.startup))&&(a.startup(),a._started=!0)},this)},setHref:function(a){k.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.",
"","2.0");return this.set("href",a)},_setHrefAttr:function(a){this.cancel();this.onLoadDeferred=new m(g.hitch(this,"cancel"));this.onLoadDeferred.then(g.hitch(this,"onLoad"));this._set("href",a);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(a){k.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",a)},_setContentAttr:function(a){this._set("href",
"");this.cancel();this.onLoadDeferred=new m(g.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(g.hitch(this,"onLoad"));this._setContent(a||"");this._isDownloaded=!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(a){this._beingDestroyed||
this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},refresh:function(){this.cancel();this.onLoadDeferred=new m(g.hitch(this,"cancel"));this.onLoadDeferred.then(g.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var a=this,b={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};
g.isObject(this.ioArgs)&&g.mixin(b,this.ioArgs);var c=this._xhrDfd=(this.ioMethod||s.get)(b),d;c.then(function(b){d=b;try{return a._isDownloaded=!0,a._setContent(b,!1)}catch(c){a._onError("Content",c)}},function(b){c.canceled||a._onError("Download",b);delete a._xhrDfd;return b}).then(function(){a.onDownloadEnd();delete a._xhrDfd;return d});delete this._hrefChanged},_onLoadHandler:function(a){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(a)}catch(b){console.error("Error "+this.widgetId+
" running custom onLoad code: "+b.message)}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(a){console.error("Error "+this.widgetId+" running custom onUnload code: "+a.message)}},destroyDescendants:function(a){this.isLoaded&&this._onUnloadHandler();var b=this._contentSetter;f.forEach(this.getChildren(),function(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a);b._destroyed=!0});b&&(f.forEach(b.parseResults,function(b){b._destroyed||(b.destroyRecursive?
b.destroyRecursive(a):b.destroy&&b.destroy(a),b._destroyed=!0)}),delete b.parseResults);a||p.empty(this.containerNode);delete this._singleChild},_setContent:function(a,b){a=this.preprocessContent(a);this.destroyDescendants();var c=this._contentSetter;c&&c instanceof e._ContentSetter||(c=this._contentSetter=new e._ContentSetter({node:this.containerNode,_onError:g.hitch(this,this._onError),onContentError:g.hitch(this,function(a){a=this.onContentError(a);try{this.containerNode.innerHTML=a}catch(b){console.error("Fatal "+
this.id+" could not change content due to "+b.message,b)}})}));var d=g.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!a.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{}),d=c.set(g.isObject(a)&&a.domNode?a.domNode:a,d),f=this;return q(d&&d.then?d:c.parseDeferred,function(){delete f._contentSetterParams;b||(f._started&&(f._startChildren(),f._scheduleLayout()),f._onLoadHandler(a))})},
preprocessContent:function(a){return a},_onError:function(a,b,c){this.onLoadDeferred.reject(b);a=this["on"+a+"Error"].call(this,b);c?console.error(c,b):a&&this._setContent(a,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/_Container":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/kernel"],
function(k,g,a,b){return g("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode)},addChild:function(b,d){var e=this.containerNode;if(0<d){for(e=e.firstChild;0<d;)1==e.nodeType&&d--,e=e.nextSibling;e?d="before":(e=this.containerNode,d="last")}a.place(b.domNode,e,d);this._started&&!b._started&&b.startup()},removeChild:function(a){"number"==typeof a&&(a=this.getChildren()[a]);a&&(a=a.domNode)&&a.parentNode&&a.parentNode.removeChild(a)},
hasChildren:function(){return 0<this.getChildren().length},_getSiblingOfChild:function(a,b){var e=this.getChildren(),f=k.indexOf(e,a);return e[f+b]},getIndexOfChild:function(a){return k.indexOf(this.getChildren(),a)}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),function(k,g,a,b,c,d,e,f,h,m){return g("dijit.layout._ContentPaneResizeMixin",
null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var a=this.getParent();this._childOfLayoutWidget=a&&a.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(h.on("resize",d.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var b=[],c=!1;e("\x3e *",this.containerNode).some(function(a){var d=f.byNode(a);d&&d.resize?b.push(d):!/script|link|style/i.test(a.nodeName)&&
a.offsetHeight&&(c=!0)});this._singleChild=1==b.length&&!c?b[0]:null;a.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(a,b){this._resizeCalled=!0;this._scheduleLayout(a,b)},_scheduleLayout:function(a,b){this._isShown()?this._layout(a,b):(this._needLayout=!0,this._changeSize=a,this._resultSize=b)},_layout:function(a,c){delete this._needLayout;!this._wasShown&&!1!==this.open&&this._onShow();a&&b.setMarginBox(this.domNode,a);var e=this.containerNode;if(e===
this.domNode){var f=c||{};d.mixin(f,a||{});if(!("h"in f)||!("w"in f))f=d.mixin(b.getMarginBox(e),f);this._contentBox=m.marginBox2contentBox(e,f)}else this._contentBox=b.getContentBox(e);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var a=this._contentBox||b.getContentBox(this.containerNode);this._singleChild.resize({w:a.w,h:a.h})}else for(var a=this.getChildren(),c,d=0;c=a[d++];)c.resize&&c.resize()},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&
"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var b=this.domNode,c=this.domNode.parentNode;return"none"!=b.style.display&&"hidden"!=b.style.visibility&&!a.contains(b,"dijitHidden")&&c&&c.style&&"none"!=c.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dijit/layout/utils":function(){define(["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],
function(k,g,a,b,c){function d(b,d){var e=b.resize?b.resize(d):a.setMarginBox(b.domNode,d);e?c.mixin(b,e):(c.mixin(b,a.getMarginBox(b.domNode)),c.mixin(b,d))}var e={marginBox2contentBox:function(c,d){var e=b.getComputedStyle(c),l=a.getMarginExtents(c,e),g=a.getPadBorderExtents(c,e);return{l:b.toPixelValue(c,e.paddingLeft),t:b.toPixelValue(c,e.paddingTop),w:d.w-(l.w+g.w),h:d.h-(l.h+g.h)}},layoutChildren:function(a,b,e,l,n){b=c.mixin({},b);g.add(a,"dijitLayoutContainer");e=k.filter(e,function(a){return"center"!=
a.region&&"client"!=a.layoutAlign}).concat(k.filter(e,function(a){return"center"==a.region||"client"==a.layoutAlign}));k.forEach(e,function(a){var c=a.domNode,e=a.region||a.layoutAlign;if(!e)throw Error("No region setting for "+a.id);var f=c.style;f.left=b.l+"px";f.top=b.t+"px";f.position="absolute";g.add(c,"dijitAlign"+(e.substring(0,1).toUpperCase()+e.substring(1)));c={};l&&l==a.id&&(c["top"==a.region||"bottom"==a.region?"h":"w"]=n);"leading"==e&&(e=a.isLeftToRight()?"left":"right");"trailing"==
e&&(e=a.isLeftToRight()?"right":"left");"top"==e||"bottom"==e?(c.w=b.w,d(a,c),b.h-=a.h,"top"==e?b.t+=a.h:f.top=b.t+b.h+"px"):"left"==e||"right"==e?(c.h=b.h,d(a,c),b.w-=a.w,"left"==e?b.l+=a.w:f.left=b.l+b.w+"px"):("client"==e||"center"==e)&&d(a,b)})}};c.setObject("dijit.layout.utils",e);return e})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),function(k,g,a,b,c,d,e){var f=0,h={_secureForInnerHtml:function(a){return a.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,
"")},_emptyNode:d.empty,_setNodeContent:function(a,b){d.empty(a);if(b)if("number"==typeof b&&(b=b.toString()),"string"==typeof b&&(b=d.toDom(b,a.ownerDocument)),!b.nodeType&&g.isArrayLike(b))for(var c=b.length,e=0;e<b.length;e=c==b.length?e+1:0)d.place(b[e],a,"last");else d.place(b,a,"last");return a},_ContentSetter:b("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:k._scopeName,startup:!0,constructor:function(a,b){g.mixin(this,
a||{});b=this.node=c.byId(this.node||b);this.id||(this.id=["Setter",b?b.id||b.tagName:"",f++].join("_"))},set:function(a,b){void 0!==a&&(this.content=a);b&&this._mixin(b);this.onBegin();this.setContent();var c=this.onEnd();return c&&c.then?c:this.node},setContent:function(){var a=this.node;if(!a)throw Error(this.declaredClass+": setContent given no node");try{a=h._setNodeContent(a,this.content)}catch(b){var c=this.onContentError(b);try{a.innerHTML=c}catch(d){console.error("Fatal "+this.declaredClass+
".setContent could not change content due to "+d.message,d)}}this.node=a},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(a.forEach(this.parseResults,function(a){a.destroy&&a.destroy()}),delete this.parseResults);d.empty(this.node)},onBegin:function(){var a=this.content;if(g.isString(a)&&(this.cleanContent&&(a=h._secureForInnerHtml(a)),this.extractContent)){var b=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);
b&&(a=b[1])}this.empty();this.content=a;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(a){return"Error occurred setting content: "+a},onExecError:function(a){return"Error occurred executing scripts: "+a},_mixin:function(a){var b={},c;for(c in a)c in b||(this[c]=a[c])},_parse:function(){var b=this.node;try{var c={};a.forEach(["dir",
"lang","textDir"],function(a){this[a]&&(c[a]=this[a])},this);var d=this;this.parseDeferred=e.parse({rootNode:b,noStart:!this.startup,inherited:c,scope:this.parserScope}).then(function(a){return d.parseResults=a},function(a){d._onError("Content",a,"Error parsing in _ContentSetter#"+this.id)})}catch(f){this._onError("Content",f,"Error parsing in _ContentSetter#"+this.id)}},_onError:function(a,b,c){a=this["on"+a+"Error"].call(this,b);c?console.error(c,b):a&&h._setNodeContent(this.node,a,!0)}}),set:function(a,
b,c){void 0==b&&(console.warn("dojo.html.set: no cont argument provided, using empty string"),b="");"number"==typeof b&&(b=b.toString());return c?(new h._ContentSetter(g.mixin(c,{content:b,node:a}))).set():h._setNodeContent(a,b,!0)}};g.setObject("dojo.html",h);return h})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(k,
g,a,b,c,d,e,f,h,m,l,n,p,s,r,q){function t(a){return eval("("+a+")")}function x(a){var b=a._nameCaseMap,c=a.prototype;if(!b||b._extendCnt<w){var b=a._nameCaseMap={},d;for(d in c)"_"!==d.charAt(0)&&(b[d.toLowerCase()]=d);b._extendCnt=w}return b}function u(b,c){c||(c=k);var d=c._dojoParserCtorMap||(c._dojoParserCtorMap={}),e=b.join();if(!d[e]){for(var f=[],h=0,l=b.length;h<l;h++){var g=b[h];f[f.length]=d[g]=d[g]||a.getObject(g)||~g.indexOf("/")&&c(g)}h=f.shift();d[e]=f.length?h.createSubclass?h.createSubclass(f):
h.extend.apply(h,f):h}return d[e]}new Date("X");var w=0;h.after(a,"extend",function(){w++},!0);var v={_clearCache:function(){w++;_ctorMap={}},_functionFromScript:function(a,c){var d="",e="",f=a.getAttribute(c+"args")||a.getAttribute("args"),h=a.getAttribute("with"),f=(f||"").split(/\s*,\s*/);h&&h.length&&b.forEach(h.split(/\s*,\s*/),function(a){d+="with("+a+"){";e+="}"});return new Function(f,d+a.innerHTML+e)},instantiate:function(a,c,d){c=c||{};d=d||{};var e=(d.scope||g._scopeName)+"Type",f="data-"+
(d.scope||g._scopeName)+"-",h=f+"type",l=f+"mixins",m=[];b.forEach(a,function(a){var b=e in c?c[e]:a.getAttribute(h)||a.getAttribute(e);if(b){var d=a.getAttribute(l),b=d?[b].concat(d.split(/\s*,\s*/)):[b];m.push({node:a,types:b})}});return this._instantiate(m,c,d)},_instantiate:function(a,c,d,e){function f(a){!c._started&&!d.noStart&&b.forEach(a,function(a){"function"===typeof a.startup&&!a._started&&a.startup()});return a}a=b.map(a,function(a){var b=a.ctor||u(a.types,d.contextRequire);if(!b)throw Error("Unable to resolve constructor for: '"+
a.types.join()+"'");return this.construct(b,a.node,c,d,a.scripts,a.inherited)},this);return e?m(a).then(f):f(a)},construct:function(c,d,e,m,n,k){function q(b){K&&a.setObject(K,b);for(D=0;D<Q.length;D++)h[Q[D].advice||"after"](b,Q[D].method,a.hitch(b,Q[D].func),!0);for(D=0;D<T.length;D++)T[D].call(b);for(D=0;D<R.length;D++)b.watch(R[D].prop,R[D].func);for(D=0;D<S.length;D++)r(b,S[D].event,S[D].func);return b}var E=c&&c.prototype;m=m||{};var H={};m.defaults&&a.mixin(H,m.defaults);k&&a.mixin(H,k);var u;
p("dom-attributes-explicit")?u=d.attributes:p("dom-attributes-specified-flag")?u=b.filter(d.attributes,function(a){return a.specified}):(k=(/^input$|^img$/i.test(d.nodeName)?d:d.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),u=b.map(k.split(/\s+/),function(a){var b=a.toLowerCase();return{name:a,value:"LI"==d.nodeName&&"value"==a||"enctype"==b?d.getAttribute(b):d.getAttributeNode(b).value}}));var v=m.scope||g._scopeName;
k="data-"+v+"-";var w={};"dojo"!==v&&(w[k+"props"]="data-dojo-props",w[k+"type"]="data-dojo-type",w[k+"mixins"]="data-dojo-mixins",w[v+"type"]="dojotype",w[k+"id"]="data-dojo-id");for(var D=0,B,v=[],K,P;B=u[D++];){var M=B.name,O=M.toLowerCase();B=B.value;switch(w[O]||O){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":P=B;break;case "data-dojo-id":case "jsid":K=B;break;case "data-dojo-attach-point":case "dojoattachpoint":H.dojoAttachPoint=B;break;case "data-dojo-attach-event":case "dojoattachevent":H.dojoAttachEvent=
B;break;case "class":H["class"]=d.className;break;case "style":H.style=d.style&&d.style.cssText;break;default:if(M in E||(M=x(c)[O]||M),M in E)switch(typeof E[M]){case "string":H[M]=B;break;case "number":H[M]=B.length?Number(B):NaN;break;case "boolean":H[M]="false"!=B.toLowerCase();break;case "function":""===B||-1!=B.search(/[^\w\.]+/i)?H[M]=new Function(B):H[M]=a.getObject(B,!1)||new Function(B);v.push(M);break;default:O=E[M],H[M]=O&&"length"in O?B?B.split(/\s*,\s*/):[]:O instanceof Date?""==B?new Date(""):
"now"==B?new Date:l.fromISOString(B):O instanceof f?g.baseUrl+B:t(B)}else H[M]=B}}for(u=0;u<v.length;u++)w=v[u].toLowerCase(),d.removeAttribute(w),d[w]=null;if(P)try{P=t.call(m.propsThis,"{"+P+"}"),a.mixin(H,P)}catch(U){throw Error(U.toString()+" in data-dojo-props\x3d'"+P+"'");}a.mixin(H,e);n||(n=c&&(c._noScript||E._noScript)?[]:s("\x3e script[type^\x3d'dojo/']",d));var Q=[],T=[],R=[],S=[];if(n)for(D=0;D<n.length;D++)w=n[D],d.removeChild(w),e=w.getAttribute(k+"event")||w.getAttribute("event"),m=
w.getAttribute(k+"prop"),P=w.getAttribute(k+"method"),v=w.getAttribute(k+"advice"),u=w.getAttribute("type"),w=this._functionFromScript(w,k),e?"dojo/connect"==u?Q.push({method:e,func:w}):"dojo/on"==u?S.push({event:e,func:w}):H[e]=w:"dojo/aspect"==u?Q.push({method:P,advice:v,func:w}):"dojo/watch"==u?R.push({prop:m,func:w}):T.push(w);c=(n=c.markupFactory||E.markupFactory)?n(H,d,c):new c(H,d);return c.then?c.then(q):q(c)},scan:function(a,c){function d(a){if(!a.inherited){a.inherited={};var b=a.node,c=
d(a.parent),b={dir:b.getAttribute("dir")||c.dir,lang:b.getAttribute("lang")||c.lang,textDir:b.getAttribute(r)||c.textDir},e;for(e in b)b[e]&&(a.inherited[e]=b[e])}return a.inherited}var e=[],f=[],h={},l=(c.scope||g._scopeName)+"Type",m="data-"+(c.scope||g._scopeName)+"-",q=m+"type",r=m+"textdir",m=m+"mixins",s=a.firstChild,t=c.inherited;if(!t){var w=function(a,b){return a.getAttribute&&a.getAttribute(b)||a.parentNode&&w(a.parentNode,b)},t={dir:w(a,"dir"),lang:w(a,"lang"),textDir:w(a,r)},B;for(B in t)t[B]||
delete t[B]}for(var t={inherited:t},K,v;;)if(s)if(1!=s.nodeType)s=s.nextSibling;else if(K&&"script"==s.nodeName.toLowerCase())(x=s.getAttribute("type"))&&/^dojo\/\w/i.test(x)&&K.push(s),s=s.nextSibling;else if(v)s=s.nextSibling;else{var x=s.getAttribute(q)||s.getAttribute(l);B=s.firstChild;if(!x&&(!B||3==B.nodeType&&!B.nextSibling))s=s.nextSibling;else{v=null;if(x){var O=s.getAttribute(m);K=O?[x].concat(O.split(/\s*,\s*/)):[x];try{v=u(K,c.contextRequire)}catch(U){}v||b.forEach(K,function(a){~a.indexOf("/")&&
!h[a]&&(h[a]=!0,f[f.length]=a)});O=v&&!v.prototype._noScript?[]:null;t={types:K,ctor:v,parent:t,node:s,scripts:O};t.inherited=d(t);e.push(t)}else t={node:s,scripts:K,parent:t};K=O;v=s.stopParser||v&&v.prototype.stopParser&&!c.template;s=B}}else{if(!t||!t.node)break;s=t.node.nextSibling;v=!1;t=t.parent;K=t.scripts}var Q=new n;f.length?(p("dojo-debug-messages")&&console.warn("WARNING: Modules being Auto-Required: "+f.join(", ")),(c.contextRequire||k)(f,function(){Q.resolve(b.filter(e,function(a){if(!a.ctor)try{a.ctor=
u(a.types,c.contextRequire)}catch(b){}for(var d=a.parent;d&&!d.types;)d=d.parent;var e=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(e&&e.stopParser&&!c.template);a.instantiate=!d||d.instantiate&&d.instantiateChildren;return a.instantiate}))})):Q.resolve(e);return Q.promise},_require:function(b,c){var d=t("{"+b.innerHTML+"}"),e=[],f=[],h=new n,l=c&&c.contextRequire||k,g;for(g in d)e.push(g),f.push(d[g]);l(f,function(){for(var b=0;b<e.length;b++)a.setObject(e[b],arguments[b]);h.resolve(arguments)});
return h.promise},_scanAmd:function(a,b){var c=new n,d=c.promise;c.resolve(!0);var e=this;s("script[type\x3d'dojo/require']",a).forEach(function(a){d=d.then(function(){return e._require(a,b)});a.parentNode.removeChild(a)});return d},parse:function(b,c){b&&("string"!=typeof b&&!("nodeType"in b))&&(c=b,b=c.rootNode);var f=b?d.byId(b):e.body();c=c||{};var h=c.template?{template:!0}:{},l=[],g=this,m=this._scanAmd(f,c).then(function(){return g.scan(f,c)}).then(function(a){return g._instantiate(a,h,c,!0)}).then(function(a){return l=
l.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});a.mixin(l,m);return l}};g.parser=v;c.parseOnLoad&&q(100,v,"parse");return v})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(k,g){var a={};k.setObject("dojo.date.stamp",a);a.fromISOString=function(b,c){a._isoRegExp||(a._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var d=a._isoRegExp.exec(b),e=null;
if(d){d.shift();d[1]&&d[1]--;d[6]&&(d[6]*=1E3);c&&(c=new Date(c),g.forEach(g.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),function(a){return c["get"+a]()}),function(a,b){d[b]=d[b]||a}));e=new Date(d[0]||1970,d[1]||0,d[2]||1,d[3]||0,d[4]||0,d[5]||0,d[6]||0);100>d[0]&&e.setFullYear(d[0]||1970);var f=0,h=d[7]&&d[7].charAt(0);"Z"!=h&&(f=60*(d[8]||0)+(Number(d[9])||0),"-"!=h&&(f*=-1));h&&(f-=e.getTimezoneOffset());f&&e.setTime(e.getTime()+6E4*f)}return e};a.toISOString=function(a,
c){var d=function(a){return 10>a?"0"+a:a};c=c||{};var e=[],f=c.zulu?"getUTC":"get",h="";"time"!=c.selector&&(h=a[f+"FullYear"](),h=["0000".substr((h+"").length)+h,d(a[f+"Month"]()+1),d(a[f+"Date"]())].join("-"));e.push(h);if("date"!=c.selector){h=[d(a[f+"Hours"]()),d(a[f+"Minutes"]()),d(a[f+"Seconds"]())].join(":");f=a[f+"Milliseconds"]();c.milliseconds&&(h+="."+(100>f?"0":"")+d(f));if(c.zulu)h+="Z";else if("time"!=c.selector)var f=a.getTimezoneOffset(),g=Math.abs(f),h=h+((0<f?"-":"+")+d(Math.floor(g/
60))+":"+d(g%60));e.push(h)}return e.join("T")};return a})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],function(k,g,a,b){k=k(b.Credential,{});g("extend-esri")&&(a.Credential=k);return k})},"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/regexp ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l,n,p,s,r,q,t,x,u,w,v){var y={},z=function(a){var b=(new e(a.owningSystemUrl)).host;a=(new e(a.server)).host;var c=/.+\.arcgis\.com$/i;return c.test(b)&&c.test(a)},A=function(a,c){return!(!z(a)||!c||!b.some(c,function(b){return b.test(a.server)}))},C,F=k(u,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=a.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=
[];this._getOAuthHash()},_defaultOAuthInfo:null,defaultTokenValidity:60,tokenValidity:null,signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,_busy:null,_oAuthHash:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},
{regex:/https?:\/\/dev\.arcgis\.com/i,tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/ig,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer|VectorTileServer)).*/ig,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_createDefaultOAuthInfo:!1,_hasTestedIfAppIsOnPortal:!1,registerServers:function(a){var c=this.serverInfos;c?(a=b.filter(a,function(a){return!this.findServerInfo(a.server)},this),this.serverInfos=c.concat(a)):
this.serverInfos=a;b.forEach(a,function(a){a.owningSystemUrl&&this._portals.push(a.owningSystemUrl);if(a.hasPortal){this._portals.push(a.server);var b=p.defaults.io.corsEnabledServers,c=this._getOrigin(a.tokenServiceUrl);q.canUseXhr(a.server)||b.push(a.server.replace(/^https?:\/\//i,""));q.canUseXhr(c)||b.push(c.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(a){var c=this.oAuthInfos;c?(a=b.filter(a,function(a){return!this.findOAuthInfo(a.portalUrl)},this),this.oAuthInfos=c.concat(a)):
this.oAuthInfos=a},registerToken:function(b){var c=this._sanitizeUrl(b.server),d=this.findServerInfo(c),e=!0,f;d||(d=new r,d.server=this._getServerInstanceRoot(c),d.tokenServiceUrl=this._getTokenSvcUrl(c),d.hasPortal=!0,this.registerServers([d]));(f=this.findCredential(c,b.userId))?(a.mixin(f,b),e=!1):(f=new C({userId:b.userId,server:d.server,token:b.token,expires:b.expires,ssl:b.ssl,scope:this._isServerRsrc(c)?"server":"portal"}),f.resources=[c],this.credentials.push(f));f.onTokenChange(!1);e||f.refreshServerTokens()},
toJson:function(){return s.fixJson({serverInfos:b.map(this.serverInfos,function(a){return a.toJson()}),oAuthInfos:b.map(this.oAuthInfos,function(a){return a.toJson()}),credentials:b.map(this.credentials,function(a){return a.toJson()})})},initialize:function(c){if(c){a.isString(c)&&(c=d.fromJson(c));var e=c.serverInfos,f=c.oAuthInfos;c=c.credentials;if(e){var h=[];b.forEach(e,function(a){a.server&&a.tokenServiceUrl&&h.push(a.declaredClass?a:new r(a))});h.length&&this.registerServers(h)}if(f){var l=
[];b.forEach(f,function(a){a.appId&&l.push(a.declaredClass?a:new v(a))});l.length&&this.registerOAuthInfos(l)}c&&b.forEach(c,function(a){a.userId&&(a.server&&a.token&&a.expires&&a.expires>(new Date).getTime())&&(a=a.declaredClass?a:new C(a),a.onTokenChange(),this.credentials.push(a))},this)}},findServerInfo:function(a){var c;a=this._sanitizeUrl(a);b.some(this.serverInfos,function(b){this._hasSameServerInstance(b.server,a)&&(c=b);return!!c},this);return c},findOAuthInfo:function(a){var c;a=this._sanitizeUrl(a);
b.some(this.oAuthInfos,function(b){this._hasSameServerInstance(b.portalUrl,a)&&(c=b);return!!c},this);return c},findCredential:function(a,c){var d,e;a=this._sanitizeUrl(a);e=this._isServerRsrc(a)?"server":"portal";c?b.some(this.credentials,function(b){this._hasSameServerInstance(b.server,a)&&(c===b.userId&&b.scope===e)&&(d=b);return!!d},this):b.some(this.credentials,function(b){this._hasSameServerInstance(b.server,a)&&(-1!==this._getIdenticalSvcIdx(a,b)&&b.scope===e)&&(d=b);return!!d},this);return d},
getCredential:function(b,d){var e,f,h=!0;s.isDefined(d)&&(a.isObject(d)?(e=!!d.token,f=d.error,h=!1!==d.prompt):e=d);b=this._sanitizeUrl(b);var l=new c(t._dfdCanceller),m=this._isAdminResource(b),n=e&&this._doPortalSignIn(b)?this._getEsriAuthCookie():null;e=e?this.findCredential(b):null;if(n||e)return h=Error("You are currently signed in as: '"+(n&&n.email||e&&e.userId)+"'. You do not have access to this resource: "+b),h.code="IdentityManagerBase.1",h.httpCode=f&&f.httpCode,h.messageCode=f?f.messageCode:
null,h.subcode=f?f.subcode:null,h.details=f?f.details:null,h.log=g.isDebug,l.errback(h),l;if(f=this._findCredential(b,d))return l.callback(f),l;if(f=this.findServerInfo(b))!f.hasServer&&this._isServerRsrc(b)&&(f._restInfoDfd=this._getTokenSvcUrl(b,!0),f.hasServer=!0);else{n=this._getTokenSvcUrl(b);if(!n)return h=Error("Unknown resource - could not find token service endpoint."),h.code="IdentityManagerBase.2",h.log=g.isDebug,l.errback(h),l;f=new r;f.server=this._getServerInstanceRoot(b);a.isString(n)?
(f.tokenServiceUrl=n,f.hasPortal=!0):(f._restInfoDfd=n,f.hasServer=!0);this.registerServers([f])}h&&(f.hasPortal&&void 0===f._selfReq&&!this._findOAuthInfo(b))&&(f._selfReq={owningTenant:d&&d.owningTenant,selfDfd:this._getPortalSelf(f.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),b)});return this._enqueue(b,f,d,l,m)},getResourceName:function(a){return this._isRESTService(a)?a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&
a.replace(this._gwUser,"$1")||this._gwItem.test(a)&&a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""},generateToken:function(b,c,d){var f,h,l,m,k,p,r=this._rePortalTokenSvc.test(b.tokenServiceUrl),s=new e(window.location.href.toLowerCase()),t=this._getEsriAuthCookie(),u,v=!c;m=b.shortLivedTokenValidity;var w;c&&(w=n.id.tokenValidity||m||n.id.defaultTokenValidity,w>m&&(w=m));d&&(f=d.isAdmin,h=d.serverUrl,l=d.token,p=d.ssl,b.customParameters=d.customParameters);
if(f)m=b.adminTokenServiceUrl;else{m=b.tokenServiceUrl;k=new e(m.toLowerCase());t&&(u=(u=t.auth_tier)&&u.toLowerCase());if(("web"===u||b.webTierAuth)&&d&&d.serverUrl&&!p&&"http"===s.scheme&&(q.hasSameOrigin(s.uri,m,!0)||"https"===k.scheme&&s.host===k.host&&"7080"===s.port&&"7443"===k.port))m=m.replace(/^https:/i,"http:").replace(/:7443/i,":7080");v&&r&&(m=m.replace(/\/rest/i,""))}f=a.mixin({url:m,content:a.mixin({request:"getToken",username:c&&c.username,password:c&&c.password,serverUrl:h,token:l,
expiration:w,referer:f||r?window.location.host:null,client:f?"referer":null,f:"json"},b.customParameters),handleAs:"json",callbackParamName:v?"callback":void 0},d&&d.ioArgs);d={usePost:!v,disableIdentityLookup:!0,useProxy:this._useProxy(b,d)};r||(f.withCredentials=!1);r=x(f,d);r.addCallback(function(a){if(!a||!a.token)return a=Error("Unable to generate token"),a.code="IdentityManagerBase.3",a.log=g.isDebug,a;var d=b.server;y[d]||(y[d]={});c&&(y[d][c.username]=c.password);a.validity=w;return a});r.addErrback(function(a){});
return r},isBusy:function(){return!!this._busy},checkSignInStatus:function(a){return this.getCredential(a,{prompt:!1})},setRedirectionHandler:function(a){this._redirectFunc=a},setProtocolErrorHandler:function(a){this._protocolFunc=a},signIn:function(){},oAuthSignIn:function(){},onCredentialCreate:function(){},onCredentialsDestroy:function(){},destroyCredentials:function(){if(this.credentials){var a=this.credentials.slice();b.forEach(a,function(a){a.destroy()})}this.onCredentialsDestroy()},_getOAuthHash:function(){var a=
window.location.hash;if(a){"#"===a.charAt(0)&&(a=a.substring(1));var a=m.queryToObject(a),b=!1;a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username")?(a.state=d.fromJson(a.state),this._oAuthHash=a,b=!0):a.error&&a.error_description&&(console.log("IdentityManager OAuth Error: ",a.error," - ",a.error_description),"access_denied"===a.error&&(b=!0));if(b&&(!f("ie")||8<f("ie")))window.location.hash=""}},_findCredential:function(a,c){var d=-1,e,f,h,l,g=c&&c.token;e=c&&c.resource;var m=this._isServerRsrc(a)?
"server":"portal",n=b.filter(this.credentials,function(b){return this._hasSameServerInstance(b.server,a)&&b.scope===m},this);a=e||a;if(n.length)if(1===n.length)if(e=n[0],h=(f=(l=this.findServerInfo(e.server))&&l.owningSystemUrl)&&this.findCredential(f,e.userId),d=this._getIdenticalSvcIdx(a,e),g)-1!==d&&(e.resources.splice(d,1),this._removeResource(a,h));else return-1===d&&e.resources.push(a),this._addResource(a,h),e;else{var k,p;b.some(n,function(b){p=this._getIdenticalSvcIdx(a,b);return-1!==p?(k=
b,h=(f=(l=this.findServerInfo(k.server))&&l.owningSystemUrl)&&this.findCredential(f,k.userId),d=p,!0):!1},this);if(g)k&&(k.resources.splice(d,1),this._removeResource(a,h));else if(k)return this._addResource(a,h),k}},_findOAuthInfo:function(a){var c=this.findOAuthInfo(a);c||b.some(this.oAuthInfos,function(b){this._isIdProvider(b.portalUrl,a)&&(c=b);return!!c},this);return c},_addResource:function(a,b){b&&-1===this._getIdenticalSvcIdx(a,b)&&b.resources.push(a)},_removeResource:function(a,b){var c=-1;
b&&(c=this._getIdenticalSvcIdx(a,b),-1<c&&b.resources.splice(c,1))},_useProxy:function(a,b){return b&&b.isAdmin&&!q.hasSameOrigin(a.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(a.tokenServiceUrl)&&10.1==a.currentVersion&&!q.hasSameOrigin(a.tokenServiceUrl,window.location.href)},_getOrigin:function(a){a=new e(a);return a.scheme+"://"+a.host+(s.isDefined(a.port)?":"+a.port:"")},_getServerInstanceRoot:function(a){var b=a.toLowerCase(),c=b.indexOf(this._agsRest);-1===c&&this._isAdminResource(a)&&
(c=b.indexOf("/admin"));-1===c&&(c=b.indexOf("/sharing"));-1===c&&"/"===b.substr(-1)&&(c=b.length-1);return-1<c?a.substring(0,c):a},_hasSameServerInstance:function(a,b){a=a.toLowerCase();b=this._getServerInstanceRoot(b).toLowerCase();a=a.substr(a.indexOf(":"));b=b.substr(b.indexOf(":"));return a===b},_sanitizeUrl:function(b){b=q.fixUrl(a.trim(b));var c=(p.defaults.io.proxyUrl||"").toLowerCase(),d=c?b.toLowerCase().indexOf(c+"?"):-1;-1!==d&&(b=b.substring(d+c.length+1));return q.urlToObject(b).path},
_isRESTService:function(a){return-1<a.indexOf(this._agsRest)},_isAdminResource:function(a){return this._agsAdmin.test(a)||this._adminSvcs.test(a)},_isServerRsrc:function(a){return this._isRESTService(a)||this._isAdminResource(a)},_isIdenticalService:function(a,b){var c;if(this._isRESTService(a)&&this._isRESTService(b)){var d=this._getSuffix(a).toLowerCase(),e=this._getSuffix(b).toLowerCase();c=d===e;c||(c=/(.*)\/(MapServer|FeatureServer).*/ig,c=d.replace(c,"$1")===e.replace(c,"$1"))}else this._isAdminResource(a)&&
this._isAdminResource(b)?c=!0:!this._isServerRsrc(a)&&(!this._isServerRsrc(b)&&this._isPortalDomain(a))&&(c=!0);return c},_isPortalDomain:function(c){c=c.toLowerCase();var d=(new e(c)).authority,f=this._portalConfig,h=-1!==d.indexOf(this._agolSuffix);!h&&f&&(h=this._hasSameServerInstance(this._getServerInstanceRoot(f.restBaseUrl),c));if(!h){if(!this._arcgisUrl&&(f=a.getObject("esri.arcgis.utils.arcgisUrl")))this._arcgisUrl=(new e(f)).authority;this._arcgisUrl&&(h=this._arcgisUrl.toLowerCase()===d)}h||
(h=b.some(this._portals,function(a){return this._hasSameServerInstance(a,c)},this));return h=h||this._agsPortal.test(c)},_isIdProvider:function(a,c){var d=-1,e=-1;b.forEach(this._gwDomains,function(b,f){-1===d&&b.regex.test(a)&&(d=f);-1===e&&b.regex.test(c)&&(e=f)});var f=!1;if(-1<d&&-1<e)if(0===d||4===d){if(0===e||4===e)f=!0}else if(1===d){if(1===e||2===e)f=!0}else 2===d?2===e&&(f=!0):3===d&&3===e&&(f=!0);if(!f){var h=this.findServerInfo(c),l=h&&h.owningSystemUrl;l&&(z(h)&&this._isPortalDomain(l)&&
this._isIdProvider(a,l))&&(f=!0)}return f},_isPublic:function(a){a=this._sanitizeUrl(a);return b.some(this._publicUrls,function(b){return b.test(a)})},_getIdenticalSvcIdx:function(a,c){var d=-1;b.some(c.resources,function(b,c){return this._isIdenticalService(a,b)?(d=c,!0):!1},this);return d},_getSuffix:function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(a){var c,d;if((c=this._isRESTService(a))||this._isAdminResource(a))return d=a.toLowerCase().indexOf(c?
this._agsRest:"/admin/"),c=a.substring(0,d)+"/admin/generateToken",a=a.substring(0,d)+"/rest/info",d=x({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),d.adminUrl_=c,d;if(this._isPortalDomain(a)){var f="";b.some(this._gwDomains,function(b){b.regex.test(a)&&(f=b.tokenServiceUrl);return!!f});f||b.some(this._portals,function(b){this._hasSameServerInstance(b,a)&&(f=b+this._gwTokenUrl);return!!f},this);f||(d=a.toLowerCase().indexOf("/sharing"),-1!==d&&(f=a.substring(0,d)+this._gwTokenUrl));
f||(f=this._getOrigin(a)+this._gwTokenUrl);f&&(c=(new e(a)).port,/^http:\/\//i.test(a)&&"7080"===c&&(f=f.replace(/:7080/i,":7443")),f=f.replace(/http:/i,"https:"));return f}if(-1!==a.toLowerCase().indexOf("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"},_getPortalSelf:function(a,b){"https:"===window.location.protocol?a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(b)&&(a=a.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return x({url:a,
content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{crossOrigin:!1,disableIdentityLookup:!0})},_hasPortalSession:function(){return!!this._getEsriAuthCookie()},_getEsriAuthCookie:function(){var a;if(h.isSupported()){var b=this._getAllCookies("esri_auth"),c;for(c=0;c<b.length;c++){var e=d.fromJson(b[c]);if(e.portalApp){a=e;break}}}return a},_getAllCookies:function(a){var b=[],c=document.cookie.match(RegExp("(?:^|; )"+l.escapeString(a)+"\x3d([^;]*)","g"));if(c)for(a=0;a<c.length;a++){var d=
c[a],e=d.indexOf("\x3d");-1<e&&(d=d.substring(e+1),b.push(decodeURIComponent(d)))}return b},_doPortalSignIn:function(a){if(h.isSupported()){var b=this._getEsriAuthCookie(),c=this._portalConfig,d=window.location.href,e=this.findServerInfo(a);if(this.useSignInPage&&(c||this._isPortalDomain(d)||b)&&(e?e.hasPortal||e.owningSystemUrl&&this._isPortalDomain(e.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(d,a)||c&&(this._hasSameServerInstance(this._getServerInstanceRoot(c.restBaseUrl),a)||
this._isIdProvider(c.restBaseUrl,a))||q.hasSameOrigin(d,a,!0)))return!0}return!1},_checkProtocol:function(b,c,d,e){var f=!0;e=e?c.adminTokenServiceUrl:c.tokenServiceUrl;if(0===a.trim(e).toLowerCase().indexOf("https:")&&0!==window.location.href.toLowerCase().indexOf("https:")&&(!p.defaults.io.useCors||!q.canUseXhr(e)&&!q.canUseXhr(q.getProxyUrl(!0).path)))f=this._protocolFunc?!!this._protocolFunc({resourceUrl:b,serverInfo:c}):!1,f||(b=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),
b.code="IdentityManagerBase.4",b.log=g.isDebug,console.log(b.message),d(b));return f},_enqueue:function(a,b,d,e,f,h){e||(e=new c(t._dfdCanceller));e.resUrl_=a;e.sinfo_=b;e.options_=d;e.admin_=f;e.refresh_=h;this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(a),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(e)):this._xoReqs.push(e):this._doSignIn(e);return e},_doSignIn:function(c){this._busy=c;var d=this,e=function(a){var e=
c.options_&&c.options_.resource,f=c.resUrl_,h=c.refresh_,l=!1;-1===b.indexOf(d.credentials,a)&&(h&&-1!==b.indexOf(d.credentials,h)?(h.userId=a.userId,h.token=a.token,h.expires=a.expires,h.validity=a.validity,h.ssl=a.ssl,h.creationTime=a.creationTime,l=!0,a=h):d.credentials.push(a));a.resources||(a.resources=[]);a.resources.push(e||f);a.scope=d._isServerRsrc(f)?"server":"portal";a.onTokenChange();var e=d._soReqs,g={};d._soReqs=[];b.forEach(e,function(b){if(!this._isIdenticalService(f,b.resUrl_)){var c=
this._getSuffix(b.resUrl_);g[c]||(g[c]=!0,a.resources.push(b.resUrl_))}},d);c.callback(a);b.forEach(e,function(b){b.callback(a)});d._busy=c.resUrl_=c.sinfo_=c.refresh_=null;if(!l)d.onCredentialCreate({credential:a});d._soReqs.length&&d._doSignIn(d._soReqs.shift());d._xoReqs.length&&d._doSignIn(d._xoReqs.shift())},f=function(a){c.errback(a);d._busy=c.resUrl_=c.sinfo_=c.refresh_=null;d._soReqs.length&&d._doSignIn(d._soReqs.shift());d._xoReqs.length&&d._doSignIn(d._xoReqs.shift())},h=function(a,b,h,
l){var m=c.sinfo_,n=!c.options_||!1!==c.options_.prompt,k=m.hasPortal&&d._findOAuthInfo(c.resUrl_);d._doPortalSignIn(c.resUrl_)?(a=d._getEsriAuthCookie(),k=d._portalConfig,a?e(new C({userId:a.email,server:m.server,token:a.token,expires:null})):n?(n="",a=window.location.href,n=d.signInPage?d.signInPage:k?k.baseUrl+k.signin:d._isIdProvider(a,c.resUrl_)?d._getOrigin(a)+"/home/signin.html":m.tokenServiceUrl.replace(d._rePortalTokenSvc,"")+"/home/signin.html",n=n.replace(/http:/i,"https:"),k&&!1===k.useSSL&&
(n=n.replace(/https:/i,"http:")),0===a.toLowerCase().replace("https","http").indexOf(n.toLowerCase().replace("https","http"))?(m=Error("Cannot redirect to Sign-In page from within Sign-In page. URL of the resource that triggered this workflow: "+c.resUrl_),m.code="IdentityManagerBase.5",m.log=g.isDebug,f(m)):d._redirectFunc?d._redirectFunc({signInPage:n,returnUrlParamName:"returnUrl",returnUrl:a,resourceUrl:c.resUrl_,serverInfo:m}):window.location=n+"?returnUrl\x3d"+window.escape(a)):(m=Error("User is not signed in."),
m.code="IdentityManagerBase.6",m.log=g.isDebug,f(m))):a?e(new C({userId:a,server:m.server,token:h,expires:s.isDefined(l)?Number(l):null,ssl:!!b})):k?(a=k._oAuthCred,a||(b=new w(k,window.localStorage),h=new w(k,window.sessionStorage),b.isValid()&&h.isValid()?b.expires>h.expires?(a=b,h.destroy()):(a=h,b.destroy()):a=b.isValid()?b:h,k._oAuthCred=a),a.isValid()?e(new C({userId:a.userId,server:m.server,token:a.token,expires:a.expires,ssl:a.ssl,_oAuthCred:a})):d._oAuthHash&&d._oAuthHash.state.portalUrl===
k.portalUrl?(n=d._oAuthHash,m=new C({userId:n.username,server:m.server,token:n.access_token,expires:(new Date).getTime()+1E3*Number(n.expires_in),ssl:"true"===n.ssl,oAuthState:n.state,_oAuthCred:a}),a.storage=n.persist?window.localStorage:window.sessionStorage,a.token=m.token,a.expires=m.expires,a.userId=m.userId,a.ssl=m.ssl,a.save(),d._oAuthHash=null,e(m)):n?c._pendingDfd=d.oAuthSignIn(c.resUrl_,m,k,c.options_).addCallbacks(e,f):(m=Error("User is not signed in."),m.code="IdentityManagerBase.6",m.log=
g.isDebug,f(m))):n?d._checkProtocol(c.resUrl_,m,f,c.admin_)&&(n=c.options_,c.admin_&&(n=n||{},n.isAdmin=!0),c._pendingDfd=d.signIn(c.resUrl_,m,n).addCallbacks(e,f)):(m=Error("User is not signed in."),m.code="IdentityManagerBase.6",m.log=g.isDebug,f(m))},l=function(){var a=c.sinfo_,h=a.owningSystemUrl,l=c.options_,g,m,n;l&&(g=l.token,m=l.error);n=d._findCredential(h,{token:g,resource:c.resUrl_});!n&&z(a)&&b.some(d.credentials,function(a){this._isIdProvider(h,a.server)&&(n=a);return!!n},d);n?(l=d.findCredential(c.resUrl_,
n.userId))?e(l):A(a,d._legacyFed)?(l=n.toJson(),l.server=a.server,l.resources=null,e(new C(l))):(c._pendingDfd=d.generateToken(d.findServerInfo(n.server),null,{serverUrl:c.resUrl_,token:n.token,ssl:n.ssl})).addCallbacks(function(b){e(new C({userId:n.userId,server:a.server,token:b.token,expires:s.isDefined(b.expires)?Number(b.expires):null,ssl:!!b.ssl,isAdmin:c.admin_,validity:b.validity}))},f):(d._busy=null,g&&(c.options_.token=null),(c._pendingDfd=d.getCredential(h.replace(/\/?$/,"/sharing"),{resource:c.resUrl_,
owningTenant:a.owningTenant,token:g,error:m})).addCallbacks(function(a){d._enqueue(c.resUrl_,c.sinfo_,c.options_,c,c.admin_)},function(a){f(a)}))},m=c.sinfo_.owningSystemUrl,n=this._isServerRsrc(c.resUrl_),k=c.sinfo_._restInfoDfd;k?k.addCallbacks(function(b){var e=c.sinfo_;e.adminTokenServiceUrl=e._restInfoDfd.adminUrl_;e._restInfoDfd=null;e.tokenServiceUrl=a.getObject("authInfo.tokenServicesUrl",!1,b)||a.getObject("authInfo.tokenServiceUrl",!1,b)||a.getObject("tokenServiceUrl",!1,b);e.shortLivedTokenValidity=
a.getObject("authInfo.shortLivedTokenValidity",!1,b);e.currentVersion=b.currentVersion;e.owningTenant=b.owningTenant;(b=e.owningSystemUrl=b.owningSystemUrl)&&d._portals.push(b);n&&b?l():h()},function(){c.sinfo_._restInfoDfd=null;var a=Error("Unknown resource - could not find token service endpoint.");a.code="IdentityManagerBase.2";a.log=g.isDebug;f(a)}):n&&m?l():c.sinfo_._selfReq?c.sinfo_._selfReq.selfDfd.then(function(a){var b={},e,f,h,l;a&&(e=a.user&&a.user.username,b.username=e,b.allSSL=a.allSSL,
f=a.supportsOAuth,h=a.currentVersion||"4.3","multitenant"===a.portalMode&&(l=a.customBaseUrl));c.sinfo_.webTierAuth=!!e;return e&&d.normalizeWebTierAuth?d.generateToken(c.sinfo_,null,{ssl:b.allSSL}).always(function(a){b.portalToken=a&&a.token;b.tokenExpiration=a&&a.expires;return b}):!e&&f&&4.3<=parseFloat(h)&&!d._doPortalSignIn(c.resUrl_)?d._generateOAuthInfo({portalUrl:c.sinfo_.server,customBaseUrl:l,owningTenant:c.sinfo_._selfReq.owningTenant}).always(function(){return b}):b}).always(function(a){c.sinfo_._selfReq=
null;a?h(a.username,a.allSSL,a.portalToken,a.tokenExpiration):h()}):h()},_generateOAuthInfo:function(a){var b=this,d,e=a.portalUrl;if(a=!this._defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal){d=window.location.href;var f=d.indexOf("?");-1<f&&(d=d.slice(0,f));f=d.search(/\/(apps|home)\//);d=-1<f?d.slice(0,f):null}a&&d?(this._hasTestedIfAppIsOnPortal=!0,d=x({url:d+"/sharing/rest",content:{f:"json"},handleAs:"json"}).then(function(){b._defaultOAuthInfo=new v({appId:"arcgisonline",
popup:!0,popupCallbackUrl:"/home/oauth-callback.html"})})):(d=new c,d.resolve(),d=d.promise);return d.always(function(){if(b._defaultOAuthInfo){var a=b._defaultOAuthInfo.clone();a.portalUrl=e;b.oAuthInfos.push(a)}})}});C=k(u,{declaredClass:"esri.Credential",tokenRefreshBuffer:2,constructor:function(b){a.mixin(this,b);this.resources=this.resources||[];s.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},_oAuthCred:null,refreshToken:function(){var a=this,c=this.resources&&this.resources[0],
d=n.id.findServerInfo(this.server),e=d&&d.owningSystemUrl,f=!!e&&"server"===this.scope,h=f&&A(d,n.id._legacyFed),l=f&&n.id.findServerInfo(e),g,m=(g=d.webTierAuth)&&n.id.normalizeWebTierAuth,k=y[this.server],k=k&&k[this.userId],p={username:this.userId,password:k},q;if(!g||m)if(f&&!l&&b.some(n.id.serverInfos,function(a){n.id._isIdProvider(e,a.server)&&(l=a);return!!l}),g=l&&n.id.findCredential(l.server,this.userId),!f||g)if(h)g.refreshToken();else{if(f)q={serverUrl:c,token:g&&g.token,ssl:g&&g.ssl};
else if(m)p=null,q={ssl:this.ssl};else if(k)this.isAdmin&&(q={isAdmin:!0});else{var r;c&&(c=n.id._sanitizeUrl(c),this._enqueued=1,r=n.id._enqueue(c,d,null,null,this.isAdmin,this),r.addCallback(function(){a._enqueued=0;a.refreshServerTokens()}).addErrback(function(){a._enqueued=0}));return r}return n.id.generateToken(f?l:d,f?null:p,q).addCallback(function(b){a.token=b.token;a.expires=s.isDefined(b.expires)?Number(b.expires):null;a.creationTime=(new Date).getTime();a.validity=b.validity;a.onTokenChange();
a.refreshServerTokens()}).addErrback(function(){})}},refreshServerTokens:function(){"portal"===this.scope&&b.forEach(n.id.credentials,function(a){var b=n.id.findServerInfo(a.server),c=b&&b.owningSystemUrl;if(a!==this&&a.userId===this.userId&&c&&"server"===a.scope&&(n.id._hasSameServerInstance(this.server,c)||n.id._isIdProvider(c,this.server)))A(b,n.id._legacyFed)?(a.token=this.token,a.expires=this.expires,a.creationTime=this.creationTime,a.validity=this.validity,a.onTokenChange()):a.refreshToken()},
this)},onTokenChange:function(a){clearTimeout(this._refreshTimer);var b=this.server&&n.id.findServerInfo(this.server),c=(b=b&&b.owningSystemUrl)&&n.id.findServerInfo(b);!1!==a&&((!b||"portal"===this.scope||c&&c.webTierAuth&&!n.id.normalizeWebTierAuth)&&(s.isDefined(this.expires)||s.isDefined(this.validity)))&&this._startRefreshTimer()},onDestroy:function(){},destroy:function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),
this._oAuthCred=null);var a=b.indexOf(n.id.credentials,this);-1<a&&n.id.credentials.splice(a,1);this.onTokenChange();this.onDestroy()},toJson:function(){return this._toJson()},_toJson:function(){var a=s.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),b=this.resources;b&&0<b.length&&(a.resources=b);return a},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);
var b=6E4*this.tokenRefreshBuffer,c=(this.validity?this.creationTime+6E4*this.validity:this.expires)-(new Date).getTime();0>c&&(c=0);this._refreshTimer=setTimeout(a.hitch(this,this.refreshToken),c>b?c-b:c)}});F.Credential=C;f("extend-esri")&&(n.IdentityManagerBase=F);return F})},"dojo/cookie":function(){define(["./_base/kernel","./regexp"],function(k,g){k.cookie=function(a,b,c){var d=document.cookie,e;if(1==arguments.length)e=(e=d.match(RegExp("(?:^|; )"+g.escapeString(a)+"\x3d([^;]*)")))?decodeURIComponent(e[1]):
void 0;else{c=c||{};d=c.expires;if("number"==typeof d){var f=new Date;f.setTime(f.getTime()+864E5*d);d=c.expires=f}d&&d.toUTCString&&(c.expires=d.toUTCString());b=encodeURIComponent(b);var d=a+"\x3d"+b,h;for(h in c)d+="; "+h,f=c[h],!0!==f&&(d+="\x3d"+f);document.cookie=d}return e};k.cookie.isSupported=function(){"cookieEnabled"in navigator||(this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled="CookiesAllowed"==this("__djCookieTest__"),navigator.cookieEnabled&&this("__djCookieTest__",
"",{expires:-1}));return navigator.cookieEnabled};return k.cookie})},"esri/ServerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(k,g,a,b,c){k=k(null,{declaredClass:"esri.ServerInfo",constructor:function(a){g.mixin(this,a)},toJson:function(){return c.fixJson({server:this.server,tokenServiceUrl:this.tokenServiceUrl,adminTokenServiceUrl:this.adminTokenServiceUrl,shortLivedTokenValidity:this.shortLivedTokenValidity,owningSystemUrl:this.owningSystemUrl,
owningTenant:this.owningTenant,currentVersion:this.currentVersion,hasPortal:this.hasPortal,hasServer:this.hasServer,webTierAuth:this.webTierAuth})}});a("extend-esri")&&(b.ServerInfo=k);return k})},"esri/OAuthCredential":function(){define(["./kernel","dojo/_base/declare","dojo/has","dojo/json"],function(k,g,a,b){g=g(null,{declaredClass:"esri.OAuthCredential",oAuthInfo:null,storage:null,expires:null,ssl:null,token:null,userId:null,constructor:function(a,b){this.oAuthInfo=a;this.storage=b;this._init()},
isValid:function(){var a=!1;if(this.oAuthInfo&&this.token&&this.userId){var b=(new Date).getTime();this.expires>b&&(this.expires-b)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&(a=!0)}return a},save:function(){if(this.storage){var a=this._load(),d=this.oAuthInfo;if(d&&d.authNamespace&&d.portalUrl){var e=a[d.authNamespace];e||(e=a[d.authNamespace]={});e[d.portalUrl]={expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",b.stringify(a))}catch(f){console.log(f)}}}},
destroy:function(){var a=this._load(),d=this.oAuthInfo;if(d&&d.authNamespace&&d.portalUrl&&this.storage){var e=a[d.authNamespace];if(e){delete e[d.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",b.stringify(a))}catch(f){console.log(f)}}}d&&(this.oAuthInfo=d._oAuthCred=null)},_init:function(){var a=this._load(),b=this.oAuthInfo;if(b&&(b.authNamespace&&b.portalUrl)&&(a=a[b.authNamespace]))if(a=a[b.portalUrl])this.expires=a.expires,this.ssl=a.ssl,this.token=a.token,this.userId=a.userId},_load:function(){var a=
{};if(this.storage){var d=this.storage.getItem("esriJSAPIOAuth");if(d)try{a=b.parse(d)}catch(e){console.log(e)}}return a}});a("extend-esri")&&(k.OAuthCredential=g);return g})},"esri/arcgis/OAuthInfo":function(){define(["../kernel","../lang","dojo/_base/declare","dojo/_base/lang","dojo/has"],function(k,g,a,b,c){var d=a(null,{declaredClass:"esri.arcgis.OAuthInfo",constructor:function(a){b.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",forceLogin:!1,
showSocialLogins:!1,popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d480,width\x3d800,location,resizable,scrollbars,status"},a)},_oAuthCred:null,toJson:function(){return g.fixJson({appId:this.appId,expiration:this.expiration,locale:this.locale,minTimeUntilExpiration:this.minTimeUntilExpiration,portalUrl:this.portalUrl,authNamespace:this.authNamespace,forceLogin:this.forceLogin,showSocialLogins:this.showSocialLogins,popup:this.popup,popupCallbackUrl:this.popupCallbackUrl,
popupWindowFeatures:this.popupWindowFeatures})},clone:function(){return new d(this.toJson())}});c("extend-esri")&&b.setObject("arcgis.OAuthInfo",d,k);return d})},"dijit/form/Button":function(){define("require dojo/_base/declare dojo/dom-class dojo/has dojo/_base/kernel dojo/_base/lang dojo/ready ./_FormWidget ./_ButtonMixin dojo/text!./templates/Button.html ../a11yclick".split(" "),function(k,g,a,b,c,d,e,f,h,m){b("dijit-legacy-requires")&&e(0,function(){k(["dijit/form/DropDownButton","dijit/form/ComboButton",
"dijit/form/ToggleButton"])});e=g("dijit.form.Button"+(b("dojo-bidi")?"_NoBidi":""),[f,h],{showLabel:!0,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:m,_setValueAttr:"valueNode",_setNameAttr:function(a){this.valueNode&&this.valueNode.setAttribute("name",a)},postCreate:function(){this.inherited(arguments);this._setLabelFromContainer()},_setLabelFromContainer:function(){this.containerNode&&!this.label&&(this.label=d.trim(this.containerNode.innerHTML),
this.onLabelSet())},_setShowLabelAttr:function(b){this.containerNode&&a.toggle(this.containerNode,"dijitDisplayNone",!b);this._set("showLabel",b)},setLabel:function(a){c.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},onLabelSet:function(){this.inherited(arguments);!this.showLabel&&!("title"in this.params)&&(this.titleNode.title=d.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});b("dojo-bidi")&&(e=g("dijit.form.Button",
e,{onLabelSet:function(){this.inherited(arguments);this.titleNode.title&&this.applyTextDir(this.titleNode,this.titleNode.title)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this._setLabelAttr(this.label))}}));return e})},"dijit/form/_FormWidget":function(){define("dojo/_base/declare dojo/sniff dojo/_base/kernel dojo/ready ../_Widget ../_CssStateMixin ../_TemplatedMixin ./_FormWidgetMixin".split(" "),function(k,g,a,b,c,d,e,f){g("dijit-legacy-requires")&&b(0,
function(){require(["dijit/form/_FormValueWidget"])});return k("dijit.form._FormWidget",[c,e,d,f],{setDisabled:function(b){a.deprecated("setDisabled("+b+") is deprecated. Use set('disabled',"+b+") instead.","","2.0");this.set("disabled",b)},setValue:function(b){a.deprecated("dijit.form._FormWidget:setValue("+b+") is deprecated.  Use set('value',"+b+") instead.","","2.0");this.set("value",b)},getValue:function(){a.deprecated(this.declaredClass+"::getValue() is deprecated. Use get('value') instead.",
"","2.0");return this.get("value")},postMixInProperties:function(){this.nameAttrSetting=this.name&&!g("msapp")?'name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"";this.inherited(arguments)}})})},"dijit/form/_FormWidgetMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff dojo/window ../a11y".split(" "),function(k,g,a,b,c,d,e,f,h,m){return g("dijit.form._FormWidgetMixin",null,{name:"",alt:"",value:"",type:"text",
"aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(b){this._set("disabled",b);/^(button|input|select|textarea|optgroup|option|fieldset)$/i.test(this.focusNode.tagName)?a.set(this.focusNode,"disabled",b):this.focusNode.setAttribute("aria-disabled",b?"true":"false");this.valueNode&&a.set(this.valueNode,"disabled",b);b?(this._set("hovering",!1),this._set("active",!1),b="tabIndex"in this.attributeMap?
this.attributeMap.tabIndex:"_setTabIndexAttr"in this?this._setTabIndexAttr:"focusNode",k.forEach(c.isArray(b)?b:[b],function(a){a=this[a];f("webkit")||m.hasDefaultTabStop(a)?a.setAttribute("tabIndex","-1"):a.removeAttribute("tabIndex")},this)):""!=this.tabIndex&&this.set("tabIndex",this.tabIndex)},_onFocus:function(a){if("mouse"==a&&this.isFocusable())var b=this.own(e(this.focusNode,"focus",function(){g.remove();b.remove()}))[0],d=f("pointer-events")?"pointerup":f("MSPointer")?"MSPointerUp":f("touch-events")?
"touchend, mouseup":"mouseup",g=this.own(e(this.ownerDocumentBody,d,c.hitch(this,function(a){g.remove();b.remove();this.focused&&("touchend"==a.type?this.defer("focus"):this.focus())})))[0];this.scrollOnFocus&&this.defer(function(){h.scrollIntoView(this.domNode)});this.inherited(arguments)},isFocusable:function(){return!this.disabled&&this.focusNode&&"none"!=b.get(this.domNode,"display")},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},compare:function(a,
b){return"number"==typeof a&&"number"==typeof b?isNaN(a)&&isNaN(b)?0:a-b:a>b?1:a<b?-1:0},onChange:function(){},_onChangeActive:!1,_handleOnChange:function(a,b){if(void 0==this._lastValueReported&&(null===b||!this._onChangeActive))this._resetValue=this._lastValueReported=a;this._pendingOnChange=this._pendingOnChange||typeof a!=typeof this._lastValueReported||0!=this.compare(a,this._lastValueReported);if((this.intermediateChanges||b||void 0===b)&&this._pendingOnChange)this._lastValueReported=a,this._pendingOnChange=
!1,this._onChangeActive&&(this._onChangeHandle&&this._onChangeHandle.remove(),this._onChangeHandle=this.defer(function(){this._onChangeHandle=null;this.onChange(a)}))},create:function(){this.inherited(arguments);this._onChangeActive=!0},destroy:function(){this._onChangeHandle&&(this._onChangeHandle.remove(),this.onChange(this._lastValueReported));this.inherited(arguments)}})})},"dijit/form/_ButtonMixin":function(){define(["dojo/_base/declare","dojo/dom","dojo/has","../registry"],function(k,g,a,b){var c=
k("dijit.form._ButtonMixin"+(a("dojo-bidi")?"_NoBidi":""),null,{label:"",type:"button",__onClick:function(a){a.stopPropagation();a.preventDefault();this.disabled||this.valueNode.click(a);return!1},_onClick:function(a){if(this.disabled)return a.stopPropagation(),a.preventDefault(),!1;!1===this.onClick(a)&&a.preventDefault();var c=a.defaultPrevented;if(!c&&"submit"==this.type&&!(this.valueNode||this.focusNode).form)for(var f=this.domNode;f.parentNode;f=f.parentNode){var h=b.byNode(f);if(h&&"function"==
typeof h._onSubmit){h._onSubmit(a);a.preventDefault();c=!0;break}}return!c},postCreate:function(){this.inherited(arguments);g.setSelectable(this.focusNode,!1)},onClick:function(){return!0},_setLabelAttr:function(a){this._set("label",a);(this.containerNode||this.focusNode).innerHTML=a;this.onLabelSet()},onLabelSet:function(){}});a("dojo-bidi")&&(c=k("dijit.form._ButtonMixin",c,{onLabelSet:function(){this.inherited(arguments);this.applyTextDir(this.containerNode||this.focusNode)}}));return c})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),
function(k,g,a,b,c,d,e,f){return k("dijit.form.Form",[c,d,e,f],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(a){g.set(this.domNode,
"encType",a);b("ie")&&(this.domNode.encoding=a);this._set("encType",a)},reset:function(a){var b={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:a?a.target:this.domNode,target:a?a.target:this.domNode};!1!==this.onReset(b)&&b.returnValue&&this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(a){this.reset(a);a.stopPropagation();a.preventDefault();return!1},_onSubmit:function(b){var c=this.constructor.prototype;if(this.execute!=
c.execute||this.onExecute!=c.onExecute)a.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(b)&&(b.stopPropagation(),b.preventDefault())},onSubmit:function(){return this.isValid()},submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"dijit/form/ValidationTextBox":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/i18n ./TextBox ../Tooltip dojo/text!./templates/ValidationTextBox.html dojo/i18n!./nls/validate".split(" "),
function(k,g,a,b,c,d,e){var f=k("dijit.form.ValidationTextBox",c,{templateString:e,required:!1,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},pattern:".*",regExp:"",regExpGen:function(){},state:"",tooltipPosition:[],_deprecateRegExp:function(a,b){b!=f.prototype[a]&&(g.deprecated("ValidationTextBox id\x3d"+this.id+", set('"+a+"', ...) is deprecated.  Use set('pattern', ...) instead.","","2.0"),this.set("pattern",b))},_setRegExpGenAttr:function(a){this._deprecateRegExp("regExpGen",
a);this._set("regExpGen",this._computeRegexp)},_setRegExpAttr:function(a){this._deprecateRegExp("regExp",a)},_setValueAttr:function(){this.inherited(arguments);this._refreshState()},validator:function(a,b){return RegExp("^(?:"+this._computeRegexp(b)+")"+(this.required?"":"?")+"$").test(a)&&(!this.required||!this._isEmpty(a))&&(this._isEmpty(a)||void 0!==this.parse(a,b))},_isValidSubset:function(){return 0==this.textbox.value.search(this._partialre)},isValid:function(){return this.validator(this.textbox.value,
this.get("constraints"))},_isEmpty:function(a){return(this.trim?/^\s*$/:/^$/).test(a)},getErrorMessage:function(){var a="$_unset_$"==this.invalidMessage?this.messages.invalidMessage:!this.invalidMessage?this.promptMessage:this.invalidMessage,b="$_unset_$"==this.missingMessage?this.messages.missingMessage:!this.missingMessage?a:this.missingMessage;return this.required&&this._isEmpty(this.textbox.value)?b:a},getPromptMessage:function(){return this.promptMessage},_maskValidSubsetError:!0,validate:function(a){var b=
"",c=this.disabled||this.isValid(a);c&&(this._maskValidSubsetError=!0);var d=this._isEmpty(this.textbox.value),e=!c&&a&&this._isValidSubset();this._set("state",c?"":((!this._hasBeenBlurred||a)&&d||e)&&(this._maskValidSubsetError||e&&!this._hasBeenBlurred&&a)?"Incomplete":"Error");this.focusNode.setAttribute("aria-invalid","Error"==this.state?"true":"false");"Error"==this.state?(this._maskValidSubsetError=a&&e,b=this.getErrorMessage(a)):"Incomplete"==this.state?(b=this.getPromptMessage(a),this._maskValidSubsetError=
!this._hasBeenBlurred||a):d&&(b=this.getPromptMessage(a));this.set("message",b);return c},displayMessage:function(a){a&&this.focused?d.show(a,this.domNode,this.tooltipPosition,!this.isLeftToRight()):d.hide(this.domNode)},_refreshState:function(){this._created&&this.validate(this.focused);this.inherited(arguments)},constructor:function(b){this.constraints=a.clone(this.constraints);this.baseClass+=" dijitValidationTextBox"},startup:function(){this.inherited(arguments);this._refreshState()},_setConstraintsAttr:function(a){!a.locale&&
this.lang&&(a.locale=this.lang);this._set("constraints",a);this._refreshState()},_setPatternAttr:function(a){this._set("pattern",a);this._refreshState()},_computeRegexp:function(a){var b=this.pattern;"function"==typeof b&&(b=b.call(this,a));if(b!=this._lastRegExp){var c="";this._lastRegExp=b;".*"!=b&&b.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(a){switch(a.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":c+=a;break;case ")":c+="|$)";break;default:c+=
"(?:"+a+"|$)"}});try{"".search(c)}catch(d){c=this.pattern,console.warn("RegExp error in "+this.declaredClass+": "+this.pattern)}this._partialre="^(?:"+c+")$"}return b},postMixInProperties:function(){this.inherited(arguments);this.messages=b.getLocalization("dijit.form","validate",this.lang);this._setConstraintsAttr(this.constraints)},_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",
a);this._refreshState()},_setMessageAttr:function(a){this._set("message",a);this.displayMessage(a)},reset:function(){this._maskValidSubsetError=!0;this.inherited(arguments)},_onBlur:function(){this.displayMessage("");this.inherited(arguments)},destroy:function(){d.hide(this.domNode);this.inherited(arguments)}});return f})},"dijit/form/TextBox":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-style dojo/_base/kernel dojo/_base/lang dojo/on dojo/sniff ./_FormValueWidget ./_TextBoxMixin dojo/text!./templates/TextBox.html ../main".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l){f=k("dijit.form.TextBox"+(e("dojo-bidi")?"_NoBidi":""),[f,h],{templateString:m,_singleNodeTemplate:'\x3cinput class\x3d"dijit dijitReset dijitLeft dijitInputField" data-dojo-attach-point\x3d"textbox,focusNode" autocomplete\x3d"off" type\x3d"${type}" ${!nameAttrSetting} /\x3e',_buttonInputDisabled:e("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var a=this.type.toLowerCase();if(this.templateString&&"input"==this.templateString.toLowerCase()||
("hidden"==a||"file"==a)&&this.templateString==this.constructor.prototype.templateString)this.templateString=this._singleNodeTemplate;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);9>e("ie")&&this.defer(function(){try{var b=a.getComputedStyle(this.domNode);if(b){var c=b.fontFamily;if(c){var d=this.domNode.getElementsByTagName("INPUT");if(d)for(b=0;b<d.length;b++)d[b].style.fontFamily=c}}}catch(e){}})},_setPlaceHolderAttr:function(a){this._set("placeHolder",a);this._phspan||
(this._attachPoints.push("_phspan"),this._phspan=g.create("span",{className:"dijitPlaceHolder dijitInputField"},this.textbox,"after"),this.own(d(this._phspan,"mousedown",function(a){a.preventDefault()}),d(this._phspan,"touchend, pointerup, MSPointerUp",c.hitch(this,function(){this.focus()}))));this._phspan.innerHTML="";this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(a));this._updatePlaceHolder()},_onInput:function(a){this.inherited(arguments);this._updatePlaceHolder()},_updatePlaceHolder:function(){this._phspan&&
(this._phspan.style.display=this.placeHolder&&!this.textbox.value?"":"none")},_setValueAttr:function(a,b,c){this.inherited(arguments);this._updatePlaceHolder()},getDisplayedValue:function(){b.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");return this.get("displayedValue")},setDisplayedValue:function(a){b.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",
a)},_onBlur:function(a){this.disabled||(this.inherited(arguments),this._updatePlaceHolder(),e("mozilla")&&this.selectOnClick&&(this.textbox.selectionStart=this.textbox.selectionEnd=void 0))},_onFocus:function(a){!this.disabled&&!this.readOnly&&(this.inherited(arguments),this._updatePlaceHolder())}});9>e("ie")&&(f.prototype._isTextSelected=function(){var a=this.ownerDocument.selection.createRange();return a.parentElement()==this.textbox&&0<a.text.length},l._setSelectionRange=h._setSelectionRange=function(a,
b,c){a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),a.moveStart("character",-99999),a.moveStart("character",b),a.moveEnd("character",c-b),a.select())});e("dojo-bidi")&&(f=k("dijit.form.TextBox",f,{_setPlaceHolderAttr:function(a){this.inherited(arguments);this.applyTextDir(this._phspan)}}));return f})},"dijit/form/_FormValueWidget":function(){define(["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(k,g,a,b){return k("dijit.form._FormValueWidget",[a,b],{_layoutHackIE7:function(){if(7==
g("ie"))for(var a=this.domNode,b=a.parentNode,e=a.firstChild||a,f=e.style.filter,h=this;b&&0==b.clientHeight;)(function(){var a=h.connect(b,"onscroll",function(){h.disconnect(a);e.style.filter=(new Date).getMilliseconds();h.defer(function(){e.style.filter=f})})})(),b=b.parentNode}})})},"dijit/form/_FormValueMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on ./_FormWidgetMixin".split(" "),function(k,g,a,b,c,d){return k("dijit.form._FormValueMixin",d,{readOnly:!1,
_setReadOnlyAttr:function(a){g.set(this.focusNode,"readOnly",a);this._set("readOnly",a)},postCreate:function(){this.inherited(arguments);void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.value)},_setValueAttr:function(a,b){this._handleOnChange(a,b)},_handleOnChange:function(a,b){this._set("value",a);this.inherited(arguments)},undo:function(){this._setValueAttr(this._lastValueReported,!1)},reset:function(){this._hasBeenBlurred=!1;this._setValueAttr(this._resetValue,!0)}})})},
"dijit/form/_TextBoxMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/sniff dojo/keys dojo/_base/lang dojo/on ../main".split(" "),function(k,g,a,b,c,d,e,f){var h=g("dijit.form._TextBoxMixin"+(b("dojo-bidi")?"_NoBidi":""),null,{trim:!1,uppercase:!1,lowercase:!1,propercase:!1,maxLength:"",selectOnClick:!1,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints)},_setValueAttr:function(a,b,c){var d;void 0!==a&&(d=this.filter(a),
"string"!=typeof c&&(c=null!==d&&("number"!=typeof d||!isNaN(d))?this.filter(this.format(d,this.constraints)):"",0!=this.compare(d,this.filter(this.parse(c,this.constraints)))&&(c=null)));if(null!=c&&("number"!=typeof c||!isNaN(c))&&this.textbox.value!=c)this.textbox.value=c,this._set("displayedValue",this.get("displayedValue"));this.inherited(arguments,[d,b])},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value)},_setDisplayedValueAttr:function(a){null==a?a=
"":"string"!=typeof a&&(a=String(a));this.textbox.value=a;this._setValueAttr(this.get("value"),void 0);this._set("displayedValue",this.get("displayedValue"))},format:function(a){return null==a?"":a.toString?a.toString():a},parse:function(a){return a},_refreshState:function(){},onInput:function(){},_onInput:function(a){this._lastInputEventValue=this.textbox.value;this._processInput(this._lastInputProducingEvent||a);delete this._lastInputProducingEvent;this.intermediateChanges&&this._handleOnChange(this.get("value"),
!1)},_processInput:function(){this._refreshState();this._set("displayedValue",this.get("displayedValue"))},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);this.own(e(this.textbox,"keydown, keypress, paste, cut, compositionend",d.hitch(this,function(a){var f;if("keydown"==a.type&&229!=a.keyCode){f=a.keyCode;switch(f){case c.SHIFT:case c.ALT:case c.CTRL:case c.META:case c.CAPS_LOCK:case c.NUM_LOCK:case c.SCROLL_LOCK:return}if(!a.ctrlKey&&!a.metaKey&&
!a.altKey){switch(f){case c.NUMPAD_0:case c.NUMPAD_1:case c.NUMPAD_2:case c.NUMPAD_3:case c.NUMPAD_4:case c.NUMPAD_5:case c.NUMPAD_6:case c.NUMPAD_7:case c.NUMPAD_8:case c.NUMPAD_9:case c.NUMPAD_MULTIPLY:case c.NUMPAD_PLUS:case c.NUMPAD_ENTER:case c.NUMPAD_MINUS:case c.NUMPAD_PERIOD:case c.NUMPAD_DIVIDE:return}if(65<=f&&90>=f||48<=f&&57>=f||f==c.SPACE)return;f=!1;for(var h in c)if(c[h]===a.keyCode){f=!0;break}if(!f)return}}(f=32<=a.charCode?String.fromCharCode(a.charCode):a.charCode)||(f=65<=a.keyCode&&
90>=a.keyCode||48<=a.keyCode&&57>=a.keyCode||a.keyCode==c.SPACE?String.fromCharCode(a.keyCode):a.keyCode);f||(f=229);if("keypress"==a.type){if("string"!=typeof f)return;if("a"<=f&&"z">=f||"A"<=f&&"Z">=f||"0"<=f&&"9">=f||" "===f)if(a.ctrlKey||a.metaKey||a.altKey)return}var g={faux:!0},k;for(k in a)/^(layer[XY]|returnValue|keyLocation)$/.test(k)||(h=a[k],"function"!=typeof h&&"undefined"!=typeof h&&(g[k]=h));d.mixin(g,{charOrCode:f,_wasConsumed:!1,preventDefault:function(){g._wasConsumed=!0;a.preventDefault()},
stopPropagation:function(){a.stopPropagation()}});this._lastInputProducingEvent=g;!1===this.onInput(g)&&(g.preventDefault(),g.stopPropagation());if(!g._wasConsumed&&9>=b("ie"))switch(a.keyCode){case c.TAB:case c.ESCAPE:case c.DOWN_ARROW:case c.UP_ARROW:case c.LEFT_ARROW:case c.RIGHT_ARROW:break;default:if(a.keyCode==c.ENTER&&"textarea"!=this.textbox.tagName.toLowerCase())break;this.defer(function(){this.textbox.value!==this._lastInputEventValue&&e.emit(this.textbox,"input",{bubbles:!0})})}})),e(this.textbox,
"input",d.hitch(this,"_onInput")),e(this.domNode,"keypress",function(a){a.stopPropagation()}))},_blankValue:"",filter:function(a){if(null===a)return this._blankValue;if("string"!=typeof a)return a;this.trim&&(a=d.trim(a));this.uppercase&&(a=a.toUpperCase());this.lowercase&&(a=a.toLowerCase());this.propercase&&(a=a.replace(/[^\s]+/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}));return a},_setBlurValue:function(){this._setValueAttr(this.get("value"),!0)},_onBlur:function(a){this.disabled||
(this._setBlurValue(),this.inherited(arguments))},_isTextSelected:function(){return this.textbox.selectionStart!=this.textbox.selectionEnd},_onFocus:function(a){!this.disabled&&!this.readOnly&&(this.selectOnClick&&"mouse"==a&&(this._selectOnClickHandle=e.once(this.domNode,"mouseup, touchend",d.hitch(this,function(a){this._isTextSelected()||h.selectInputText(this.textbox)})),this.own(this._selectOnClickHandle),this.defer(function(){this._selectOnClickHandle&&(this._selectOnClickHandle.remove(),this._selectOnClickHandle=
null)},500)),this.inherited(arguments),this._refreshState())},reset:function(){this.textbox.value="";this.inherited(arguments)}});b("dojo-bidi")&&(h=g("dijit.form._TextBoxMixin",h,{_setValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_setDisplayedValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_onInput:function(){this.applyTextDir(this.focusNode);this.inherited(arguments)}}));h._setSelectionRange=f._setSelectionRange=function(a,b,
c){a.setSelectionRange&&a.setSelectionRange(b,c)};h.selectInputText=f.selectInputText=function(b,c,d){b=a.byId(b);isNaN(c)&&(c=0);isNaN(d)&&(d=b.value?b.value.length:0);try{b.focus(),h._setSelectionRange(b,c,d)}catch(e){}};return h})},"dijit/Tooltip":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff ./_base/manager ./place ./_Widget ./_TemplatedMixin ./BackgroundIframe dojo/text!./templates/Tooltip.html ./main".split(" "),
function(k,g,a,b,c,d,e,f,h,m,l,n,p,s,r,q,t,x){function u(){}var w=g("dijit._MasterTooltip",[s,r],{duration:n.defaultDuration,templateString:t,postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);this.bgIframe=new q(this.domNode);this.fadeIn=a.fadeIn({node:this.domNode,duration:this.duration,onEnd:f.hitch(this,"_onShow")});this.fadeOut=a.fadeOut({node:this.domNode,duration:this.duration,onEnd:f.hitch(this,"_onHide")})},show:function(a,b,c,d,h,g,l){if(!this.aroundNode||!(this.aroundNode===
b&&this.containerNode.innerHTML==a))if("playing"==this.fadeOut.status())this._onDeck=arguments;else{this.containerNode.innerHTML=a;h&&this.set("textDir",h);this.containerNode.align=d?"right":"left";var m=p.around(this.domNode,b,c&&c.length?c:v.defaultPosition,!d,f.hitch(this,"orient")),k=m.aroundNodePos;"M"==m.corner.charAt(0)&&"M"==m.aroundCorner.charAt(0)?(this.connectorNode.style.top=k.y+(k.h-this.connectorNode.offsetHeight>>1)-m.y+"px",this.connectorNode.style.left=""):"M"==m.corner.charAt(1)&&
"M"==m.aroundCorner.charAt(1)?this.connectorNode.style.left=k.x+(k.w-this.connectorNode.offsetWidth>>1)-m.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");e.set(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=b;this.onMouseEnter=g||u;this.onMouseLeave=l||u}},orient:function(a,b,c,e,f){this.connectorNode.style.top="";var h=e.h;e=e.w;a.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove",
"BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[b+"-"+c];this.domNode.style.width="auto";var g=d.position(this.domNode);if(l("ie")||l("trident"))g.w+=2;var m=Math.min(Math.max(e,1),g.w);d.setMarginBox(this.domNode,{w:m});"B"==c.charAt(0)&&"B"==b.charAt(0)?(a=d.position(a),b=
this.connectorNode.offsetHeight,a.h>h?(this.connectorNode.style.top=h-(f.h+b>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(f.h/2-b/2,0),a.h-b)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");return Math.max(0,g.w-e)},_onShow:function(){l("ie")&&(this.domNode.style.filter="")},hide:function(a){this._onDeck&&this._onDeck[1]==a?this._onDeck=null:this.aroundNode===a&&(this.fadeIn.stop(),this.isShowingNow=
!1,this.aroundNode=null,this.fadeOut.play());this.onMouseEnter=this.onMouseLeave=u},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";this._onDeck&&(this.show.apply(this,this._onDeck),this._onDeck=null)}});l("dojo-bidi")&&w.extend({_setAutoTextDir:function(a){this.applyTextDir(a);k.forEach(a.children,function(a){this._setAutoTextDir(a)},this)},_setTextDirAttr:function(a){this._set("textDir",a);"auto"==a?this._setAutoTextDir(this.containerNode):this.containerNode.dir=
this.textDir}});x.showTooltip=function(a,b,c,d,e,f,h){c&&(c=k.map(c,function(a){return{after:"after-centered",before:"before-centered"}[a]||a}));v._masterTT||(x._masterTT=v._masterTT=new w);return v._masterTT.show(a,b,c,d,e,f,h)};x.hideTooltip=function(a){return v._masterTT&&v._masterTT.hide(a)};var v=g("dijit.Tooltip",s,{label:"",showDelay:400,hideDelay:400,connectId:[],position:[],selector:"",_setConnectIdAttr:function(a){k.forEach(this._connections||[],function(a){k.forEach(a,function(a){a.remove()})},
this);this._connectIds=k.filter(f.isArrayLike(a)?a:a?[a]:[],function(a){return b.byId(a,this.ownerDocument)},this);this._connections=k.map(this._connectIds,function(a){a=b.byId(a,this.ownerDocument);var c=this.selector,d=c?function(a){return m.selector(c,a)}:function(a){return a},e=this;return[m(a,d(h.enter),function(){e._onHover(this)}),m(a,d("focusin"),function(){e._onHover(this)}),m(a,d(h.leave),f.hitch(e,"_onUnHover")),m(a,d("focusout"),f.hitch(e,"set","state","DORMANT"))]},this);this._set("connectId",
a)},addTarget:function(a){a=a.id||a;-1==k.indexOf(this._connectIds,a)&&this.set("connectId",this._connectIds.concat(a))},removeTarget:function(a){a=k.indexOf(this._connectIds,a.id||a);0<=a&&(this._connectIds.splice(a,1),this.set("connectId",this._connectIds))},buildRendering:function(){this.inherited(arguments);c.add(this.domNode,"dijitTooltipData")},startup:function(){this.inherited(arguments);var a=this.connectId;k.forEach(f.isArrayLike(a)?a:[a],this.addTarget,this)},getContent:function(a){return this.label||
this.domNode.innerHTML},state:"DORMANT",_setStateAttr:function(a){if(!(this.state==a||"SHOW TIMER"==a&&"SHOWING"==this.state||"HIDE TIMER"==a&&"DORMANT"==this.state)){this._hideTimer&&(this._hideTimer.remove(),delete this._hideTimer);this._showTimer&&(this._showTimer.remove(),delete this._showTimer);switch(a){case "DORMANT":this._connectNode&&(v.hide(this._connectNode),delete this._connectNode,this.onHide());break;case "SHOW TIMER":"SHOWING"!=this.state&&(this._showTimer=this.defer(function(){this.set("state",
"SHOWING")},this.showDelay));break;case "SHOWING":var b=this.getContent(this._connectNode);if(!b){this.set("state","DORMANT");return}v.show(b,this._connectNode,this.position,!this.isLeftToRight(),this.textDir,f.hitch(this,"set","state","SHOWING"),f.hitch(this,"set","state","HIDE TIMER"));this.onShow(this._connectNode,this.position);break;case "HIDE TIMER":this._hideTimer=this.defer(function(){this.set("state","DORMANT")},this.hideDelay)}this._set("state",a)}},_onHover:function(a){this._connectNode&&
a!=this._connectNode&&this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOW TIMER")},_onUnHover:function(a){this.set("state","HIDE TIMER")},open:function(a){this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOWING")},close:function(){this.set("state","DORMANT")},onShow:function(){},onHide:function(){},destroy:function(){this.set("state","DORMANT");k.forEach(this._connections||[],function(a){k.forEach(a,function(a){a.remove()})},this);this.inherited(arguments)}});
v._MasterTooltip=w;v.show=x.showTooltip;v.hide=x.hideTooltip;v.defaultPosition=["after-centered","before-centered"];return v})},"dijit/place":function(){define("dojo/_base/array dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/_base/window ./Viewport ./main".split(" "),function(k,g,a,b,c,d,e){function f(b,e,f,h){var s=d.getEffectiveBox(b.ownerDocument);(!b.parentNode||"body"!=String(b.parentNode.tagName).toLowerCase())&&c.body(b.ownerDocument).appendChild(b);var r=null;k.some(e,function(a){var c=
a.corner,d=a.pos,e=0,l={w:{L:s.l+s.w-d.x,R:d.x-s.l,M:s.w}[c.charAt(1)],h:{T:s.t+s.h-d.y,B:d.y-s.t,M:s.h}[c.charAt(0)]},k=b.style;k.left=k.right="auto";f&&(e=f(b,a.aroundCorner,c,l,h),e="undefined"==typeof e?0:e);var q=b.style,t=q.display,F=q.visibility;"none"==q.display&&(q.visibility="hidden",q.display="");k=g.position(b);q.display=t;q.visibility=F;t={L:d.x,R:d.x-k.w,M:Math.max(s.l,Math.min(s.l+s.w,d.x+(k.w>>1))-k.w)}[c.charAt(1)];F={T:d.y,B:d.y-k.h,M:Math.max(s.t,Math.min(s.t+s.h,d.y+(k.h>>1))-
k.h)}[c.charAt(0)];d=Math.max(s.l,t);q=Math.max(s.t,F);t=Math.min(s.l+s.w,t+k.w);F=Math.min(s.t+s.h,F+k.h);t-=d;F-=q;e+=k.w-t+(k.h-F);if(null==r||e<r.overflow)r={corner:c,aroundCorner:a.aroundCorner,x:d,y:q,w:t,h:F,overflow:e,spaceAvailable:l};return!e});r.overflow&&f&&f(b,r.aroundCorner,r.corner,r.spaceAvailable,h);e=r.y;var q=r.x,t=c.body(b.ownerDocument);/relative|absolute/.test(a.get(t,"position"))&&(e-=a.get(t,"marginTop"),q-=a.get(t,"marginLeft"));t=b.style;t.top=e+"px";t.left=q+"px";t.right=
"auto";return r}var h={TL:"BR",TR:"BL",BL:"TR",BR:"TL"};return e.place={at:function(a,b,c,d,e){c=k.map(c,function(a){var c={corner:a,aroundCorner:h[a],pos:{x:b.x,y:b.y}};d&&(c.pos.x+="L"==a.charAt(1)?d.x:-d.x,c.pos.y+="T"==a.charAt(0)?d.y:-d.y);return c});return f(a,c,e)},around:function(c,d,e,h,s){function r(a,b){F.push({aroundCorner:a,corner:b,pos:{x:{L:y,R:y+A,M:y+(A>>1)}[a.charAt(1)],y:{T:z,B:z+C,M:z+(C>>1)}[a.charAt(0)]}})}var q;if("string"==typeof d||"offsetWidth"in d||"ownerSVGElement"in d){if(q=
g.position(d,!0),/^(above|below)/.test(e[0])){var t=g.getBorderExtents(d),x=d.firstChild?g.getBorderExtents(d.firstChild):{t:0,l:0,b:0,r:0},u=g.getBorderExtents(c),w=c.firstChild?g.getBorderExtents(c.firstChild):{t:0,l:0,b:0,r:0};q.y+=Math.min(t.t+x.t,u.t+w.t);q.h-=Math.min(t.t+x.t,u.t+w.t)+Math.min(t.b+x.b,u.b+w.b)}}else q=d;if(d.parentNode){t="absolute"==a.getComputedStyle(d).position;for(d=d.parentNode;d&&1==d.nodeType&&"BODY"!=d.nodeName;){x=g.position(d,!0);u=a.getComputedStyle(d);/relative|absolute/.test(u.position)&&
(t=!1);if(!t&&/hidden|auto|scroll/.test(u.overflow)){var w=Math.min(q.y+q.h,x.y+x.h),v=Math.min(q.x+q.w,x.x+x.w);q.x=Math.max(q.x,x.x);q.y=Math.max(q.y,x.y);q.h=w-q.y;q.w=v-q.x}"absolute"==u.position&&(t=!0);d=d.parentNode}}var y=q.x,z=q.y,A="w"in q?q.w:q.w=q.width,C="h"in q?q.h:(b.deprecated("place.around: dijit/place.__Rectangle: { x:"+y+", y:"+z+", height:"+q.height+", width:"+A+" } has been deprecated.  Please use { x:"+y+", y:"+z+", h:"+q.height+", w:"+A+" }","","2.0"),q.h=q.height),F=[];k.forEach(e,
function(a){var b=h;switch(a){case "above-centered":r("TM","BM");break;case "below-centered":r("BM","TM");break;case "after-centered":b=!b;case "before-centered":r(b?"ML":"MR",b?"MR":"ML");break;case "after":b=!b;case "before":r(b?"TL":"TR",b?"TR":"TL");r(b?"BL":"BR",b?"BR":"BL");break;case "below-alt":b=!b;case "below":r(b?"BL":"BR",b?"TL":"TR");r(b?"BR":"BL",b?"TR":"TL");break;case "above-alt":b=!b;case "above":r(b?"TL":"TR",b?"BL":"BR");r(b?"TR":"TL",b?"BR":"BL");break;default:r(a.aroundCorner,
a.corner)}});c=f(c,F,s,{w:A,h:C});c.aroundNodePos=q;return c}}})},"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!./nls/jsapi dojo/io-query dojo/sniff dojo/json dijit/form/Button dojo/query".split(" "),function(k,g,a,b,c,d,e,f,h,m,l,n,p,s){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(a){this._oAuthRedirectFunc=a},oAuthSignIn:function(a,b,c,d){var e=this._oAuthDfd=new f;e.resUrl_=a;e.sinfo_=b;e.oinfo_=c;var h=!d||!1!==d.oAuthPopupConfirmation;if(!c.popup||!h)return this._doOAuthSignIn(a,b,c),e;this._nls||(this._nls=l.identity);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());a=this.oAuthDialog;b=d&&d.error;d=d&&d.token;g.hide(a.errMsg_);b&&(403==b.code&&d)&&(m.set(a.errMsg_,"innerHTML",this._nls.forbidden),g.show(a.errMsg_));a.show();
return e},setOAuthResponseHash:function(a){var b=this._oAuthDfd;this._oAuthDfd=null;if(b&&a)if(clearInterval(this._oAuthIntervalId),"#"===a.charAt(0)&&(a=a.substring(1)),a=n.queryToObject(a),a.error)a=Error("access_denied"===a.error?"ABORTED":"OAuth: "+a.error+" - "+a.error_description),a.code="IdentityManagerBase.2",a.log=e.isDebug,b.errback(a);else{var c=b.oinfo_._oAuthCred,d=new k({userId:a.username,server:b.sinfo_.server,token:a.access_token,expires:(new Date).getTime()+1E3*Number(a.expires_in),
ssl:"true"===a.ssl,_oAuthCred:c});c.storage=a.persist?window.localStorage:window.sessionStorage;c.token=d.token;c.expires=d.expires;c.userId=d.userId;c.ssl=d.ssl;c.save();b.callback(d)}},_createOAuthDialog:function(){var b=this._nls,f=a.substitute(b,this._oAuthDialogContent),l=new c({title:b.title,content:f,"class":"esriOAuthSignInDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:function(){var a=l.esriIdMgr_._oAuthDfd;l.hide_();l.esriIdMgr_._doOAuthSignIn(a.resUrl_,a.sinfo_,a.oinfo_)},cancel_:function(){var a=
l.esriIdMgr_._oAuthDfd;l.esriIdMgr_._oAuthDfd=null;l.hide_();var b=Error("ABORTED");b.code="IdentityManager.2";b.log=e.isDebug;a.errback(b)},hide_:function(){g.hide(l.errMsg_);l.hide();c._DialogLevelManager.hide(l)}}),b=l.domNode;l.btnSubmit_=d.byNode(h.query(".esriIdSubmit",b)[0]);l.btnCancel_=d.byNode(h.query(".esriIdCancel",b)[0]);l.errMsg_=h.query(".esriErrorMsg",b)[0];l.connect(l.btnSubmit_,"onClick",l.execute_);l.connect(l.btnCancel_,"onClick",l.onCancel);l.connect(l,"onCancel",l.cancel_);return l},
_doOAuthSignIn:function(a,c,d){var f=this,h={client_id:d.appId,response_type:"token",state:s.stringify({portalUrl:d.portalUrl}),expiration:d.expiration,locale:d.locale,redirect_uri:d.popup?b.getAbsoluteUrl(d.popupCallbackUrl):window.location.href.replace(/#.*$/,"")};d.forceLogin&&(h.force_login=!0);d.showSocialLogins&&(h.showSocialLogins=!0);var g=d.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",l=g+"?"+n.objectToQuery(h);if(d.popup){var m;7===p("ie")?(m=window.open(d.popupCallbackUrl,
"esriJSAPIOAuth",d.popupWindowFeatures),m.location=l):m=window.open(l,"esriJSAPIOAuth",d.popupWindowFeatures);m?(m.focus(),this._oAuthDfd.oAuthWin_=m,this._oAuthIntervalId=setInterval(function(){if(m.closed){clearInterval(f._oAuthIntervalId);var a=f._oAuthDfd;if(a){var b=Error("ABORTED");b.code="IdentityManager.2";b.log=e.isDebug;a.errback(b)}}},500)):(a=Error("ABORTED"),a.code="IdentityManager.2",a.log=e.isDebug,this._oAuthDfd.errback(a))}else this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:h,
authorizeUrl:g,resourceUrl:a,serverInfo:c,oAuthInfo:d}):window.location=l}}})},"esri/layers/vectorTiles/views/vectorTiles/GlyphMosaic":function(){define("require exports dojo/promise/all dojo/Deferred ./Rect ../webgl/Texture ./RectangleBinPack".split(" "),function(k,g,a,b,c,d,e){return function(){function f(a,b,c){this.height=this.width=0;this._dirty=!1;this._glyphIndex={};this._pixelRatio=1;this._rangePromises={};(0>=a||0>=b)&&console.error("Glyph mosaic width and height must be greater than zero!");
this.width=a;this.height=b;this._glyphSource=c;this._binPack=new e(a,b);this._glyphData=new Uint8Array(a*b)}f.prototype.getGlyphItems=function(d,e,f){for(var g=this,k=[],s=this._glyphSource,r=new Set,q=1/256,t=0;t<f.length;t++)r.add(Math.floor(f[t]*q));var x=[];r.forEach(function(a){if(256>=a){var c=new b;x.push(c.promise);var d=e+a,f=g._rangePromises[d];f?f.push(c):(g._rangePromises[d]=[c],s.getRange(e,a).then(function(){var a=g._rangePromises[d];delete g._rangePromises[d];for(var b=0;b<a.length;b++)a[b].resolve()}))}});
return a(x).then(function(a){a=g._glyphIndex[e];a||(a={},g._glyphIndex[e]=a);for(var b=0;b<f.length;b++){var q=f[b],r=a[q];if(r)r.tileIDs.add(d),k[q]={rect:r.rect,metrics:r.metrics};else{var t=s.getGlyph(e,q);if(t&&t.metrics){var r=t.metrics,x=void 0;if(0===r.width)x=new c(0,0,0,0);else{var C=r.width+6,F=r.height+6,x=g._binPack.allocate(C+(C%4?4-C%4:0),F+(F%4?4-F%4:0));0>=x.width&&(x=new c(0,0,0,0));var t=t.bitmap,G=void 0,J=void 0;if(t)for(var E=0;E<F;E++)for(var G=C*E,J=g.width*(x.y+E)+x.x,H=0;H<
C;H++)g._glyphData[J+H]=t[G+H]}C=new Set;C.add(d);a[q]={rect:x,metrics:r,tileIDs:C};k[q]={rect:x,metrics:r};g._dirty=!0}}}return k})};f.prototype.removeGlyphs=function(a){for(var b in this._glyphIndex){var c=this._glyphIndex[b];if(c){var d=void 0,e;for(e in c)if(d=c[e],d.tileIDs["delete"](a),0===d.tileIDs.size){for(var d=d.rect,f=void 0,g=void 0,k=0;k<d.height;k++){f=this.width*(d.y+k)+d.x;for(g=0;g<d.width;g++)this._glyphData[f+g]=0}delete c[e];this._dirty=!0}}}};f.prototype.bind=function(a,b,c){void 0===
c&&(c=0);this._texture||(this._texture=new d(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));this._texture.setSamplingMode(b);a.bindTexture(this._texture,c);this._dirty&&this._texture.updateData(0,0,0,this.width*this._pixelRatio,this.height*this._pixelRatio,this._glyphData);this._dirty=!1};return f}()})},"esri/layers/vectorTiles/views/vectorTiles/GlyphSource":function(){define(["require","exports","../../core/promiseUtils","../../request",
"../../core/pbf"],function(k,g,a,b,c){var d=function(){function a(b){this._metrics=[];for(this._bitmaps=[];b.next();)switch(b.tag()){case 1:for(var c=b.getMessage();c.next();)switch(c.tag()){case 3:for(var d=c.getMessage(),e=void 0,f=void 0,g=void 0,k=void 0,q=void 0,t=void 0,x=void 0;d.next();)switch(d.tag()){case 1:e=d.getUInt32();break;case 2:f=d.getBytes();break;case 3:g=d.getUInt32();break;case 4:k=d.getUInt32();break;case 5:q=d.getSInt32();break;case 6:t=d.getSInt32();break;case 7:x=d.getUInt32();
break;default:d.skip()}e&&(this._metrics[e]={width:g,height:k,left:q,top:t,advance:x},this._bitmaps[e]=f);break;default:c.skip()}break;default:b.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};a.prototype.getBitmap=function(a){return this._bitmaps[a]};return a}(),e=function(){function a(){this._ranges=[]}a.prototype.getRange=function(a){return this._ranges[a]};a.prototype.addRange=function(a,b){this._ranges[a]=b};return a}();return function(){function f(a){this._glyphInfo={};this._baseURL=
a}f.prototype.getRange=function(e,f){var g=this._getFontStack(e);if(g.getRange(f))return a.resolve();var k=256*f,p=k+255,k=this._baseURL.replace("{fontstack}",e).replace("{range}",k+"-"+p);return b(k,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){g.addRange(f,new d(new c(new Uint8Array(a.data),new DataView(a.data))))})};f.prototype.getGlyph=function(a,b){var c=this._getFontStack(a);if(c){var d=Math.floor(b/256);if(!(256<d))return c=c.getRange(d),!c?void 0:{metrics:c.getMetrics(b),
bitmap:c.getBitmap(b)}}};f.prototype._getFontStack=function(a){var b=this._glyphInfo[a];b||(b=this._glyphInfo[a]=new e);return b};return f}()})},"esri/layers/vectorTiles/core/pbf":function(){define(["require","exports"],function(k,g){return function(){function a(a,c,d,e){this._tag=0;this._dataType=99;this._data=a;this._dataView=c;this._pos=d||0;this._end=e||a.byteLength}a.prototype.clone=function(){return new a(this._data,this._dataView,this._pos,this._end)};a.prototype.next=function(a){for(;;){if(this._pos===
this._end)return!1;var c=this._decodeVarint();this._tag=c>>3;this._dataType=c&7;if(!a||a===this._tag)break;this.skip()}return!0};a.prototype.empty=function(){return this._pos>=this._end};a.prototype.tag=function(){return this._tag};a.prototype.getInt32=function(){return this._decodeVarint()};a.prototype.getInt64=function(){return this._decodeVarint()};a.prototype.getUInt32=function(){return this._decodeVarint()};a.prototype.getUInt64=function(){return this._decodeVarint()};a.prototype.getSInt32=function(){return this._decodeSVarint()};
a.prototype.getSInt64=function(){return this._decodeSVarint()};a.prototype.getBool=function(){var a=0!==this._data[this._pos];this._skip(1);return a};a.prototype.getEnum=function(){return this._decodeVarint()};a.prototype.getFixed64=function(){var a=this._dataView,c=this._pos,a=a.getUint32(c,!0)+4294967296*a.getUint32(c+4,!0);this._skip(8);return a};a.prototype.getSFixed64=function(){var a=this._dataView,c=this._pos,a=a.getUint32(c,!0)+4294967296*a.getInt32(c+4,!0);this._skip(8);return a};a.prototype.getDouble=
function(){var a=this._dataView.getFloat64(this._pos,!0);this._skip(8);return a};a.prototype.getFixed32=function(){var a=this._dataView.getUint32(this._pos,!0);this._skip(4);return a};a.prototype.getSFixed32=function(){var a=this._dataView.getInt32(this._pos,!0);this._skip(4);return a};a.prototype.getFloat=function(){var a=this._dataView.getFloat32(this._pos,!0);this._skip(4);return a};a.prototype.getString=function(){var a=this._getLength(),c=this._pos,c=this._toString(this._data,c,c+a);this._skip(a);
return c};a.prototype.getBytes=function(){var a=this._getLength(),c=this._pos,c=this._toBytes(this._data,c,c+a);this._skip(a);return c};a.prototype.getMessage=function(){var b=this._getLength(),c=this._pos,c=new a(this._data,this._dataView,c,c+b);this._skip(b);return c};a.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw Error("Invalid data type!");}};a.prototype._skip=
function(a){if(this._pos+a>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=a};a.prototype._decodeVarint=function(){var a=this._data,c=this._pos,d=0,e;if(10<=this._end-c){if(e=a[c++],d|=e&127,0!==(e&128)&&(e=a[c++],d|=(e&127)<<7,0!==(e&128)&&(e=a[c++],d|=(e&127)<<14,0!==(e&128)&&(e=a[c++],d|=(e&127)<<21,0!==(e&128)&&(e=a[c++],d+=268435456*(e&127),0!==(e&128)&&(e=a[c++],d+=34359738368*(e&127),0!==(e&128)&&(e=a[c++],d+=4398046511104*(e&127),0!==(e&128)&&(e=a[c++],d+=562949953421312*
(e&127),0!==(e&128)&&(e=a[c++],d+=72057594037927936*(e&127),0!==(e&128)&&(e=a[c++],d+=9223372036854775E3*(e&127),0!==(e&128)))))))))))throw Error("Varint too long!");}else{for(var f=1;c!==this._end;){e=a[c];if(0===(e&128))break;++c;d+=(e&127)*f;f*=128}if(c===this._end)throw Error("Varint overrun!");++c;d+=e*f}this._pos=c;return d};a.prototype._decodeSVarint=function(){var a=this._decodeVarint();return a%2?-(a+1)/2:a/2};a.prototype._getLength=function(){if(2!==this._dataType)throw Error("Not a delimited data type!");
return this._decodeVarint()};a.prototype._toString=function(a,c,d){var e="",f="";for(d=Math.min(this._end,d);c<d;++c){var h=a[c];h&128?f+="%"+h.toString(16):(e+=decodeURIComponent(f)+String.fromCharCode(h),f="")}f.length&&(e+=decodeURIComponent(f));return e};a.prototype._toBytes=function(a,c,d){d=Math.min(this._end,d);return new Uint8Array(a.buffer,c,d-c)};return a}()})},"esri/layers/vectorTiles/views/vectorTiles/VectorTileDisplayObject":function(){define("require exports ../../core/tsSupport/extendsHelper ../webgl/BufferObject ../2d/engine/DisplayObject ../../core/libs/gl-matrix/vec2 ../../core/libs/gl-matrix/mat4 ./RenderBucket".split(" "),
function(k,g,a,b,c,d,e,f){return function(c){function g(a,b,f,m,k,q,t,x,u,w,v){c.call(this);this._renderBuckets=[];this._symbolUpdateData=this._vectorTileData=null;this.topLeft=[0,0];this.bottomRight=[0,0];this.tileTransform={transform:Float32Array[16],displayCoord:Float32Array[2]};this.stencilData={mask:0,reference:0};this.key=a;this.refKey=b;this.topLeft[0]=f[0];this.topLeft[1]=f[1];this.bottomRight[0]=f[2];this.bottomRight[1]=f[3];this.widthInPixels=m;this.coordRange=k;this.rotation=q;this._vectorTileData=
t;this.styleLayers=x;this._glyphsMosaic=u;this.workerID=w;this._connection=v;this.id=a.id;this.status=3;this.tileTransform.transform=e.create();this.tileTransform.displayCoord=d.create()}a(g,c);g.prototype.updateSymbolData=function(a){a&&(this._symbolUpdateData=a,this.requestRender())};g.prototype.dispose=function(){this._connection&&6!==this.status&&this._connection.broadcast("destructTileData",{key:this.id},[])};g.prototype.attach=function(a){this.status=3;if(!this._vectorTileData)return!1;if(0===
this._renderBuckets.length)for(var c=new Uint32Array(this._vectorTileData.bucketDataInfo),d=c.length,e=0;e<d;){var h=c[e],g=c[e+1];0===g?(g=new f.BackgroundRenderBucket,g.layerID=h,this._renderBuckets.push(g),e+=2):1===g?(g=new f.FillRenderBucket,g.layerID=h,g.triangleElementStart=c[e+2],g.triangleElementCount=c[e+3],g.outlineElementStart=c[e+4],g.outlineElementCount=c[e+5],this._renderBuckets.push(g),e+=6):2===g?(g=new f.LineRenderBucket,g.layerID=h,g.triangleElementStart=c[e+2],g.triangleElementCount=
c[e+3],g.joinStart=c[e+4],g.joinCount=c[e+5],this._renderBuckets.push(g),e+=6):3===g?(g=new f.SymbolRenderBucket,g.layerID=h,g.markerElementStart=c[e+2],g.marketElementCount=c[e+3],g.textElementStart=c[e+4],g.textElementCount=c[e+5],g.isSDF=0!==c[e+6],this._renderBuckets.push(g),e+=7):console.error("Bad bucket type!")}c=a.context;a=a.budget;d=new Uint32Array(this._vectorTileData.bufferDataInfo);e=d.length;for(g=h=0;g<e;g+=2,h++){var m=d[g],k=d[g+1];if(!(0>=k||0===this._vectorTileData.bufferData[h].byteLength)){if(a.done)return!1;
switch(m){case 2:this.polygonTrianglesVertexBuffer||(this.polygonTrianglesVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[h]));break;case 6:this.polygonTrianglesIndexBuffer||(this.polygonTrianglesIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[h],0,k/4)));break;case 3:this.polygonOutlinesVertexBuffer||(this.polygonOutlinesVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[h]));break;case 7:this.polygonOutlinesIndexBuffer||(this.polygonOutlinesIndexBuffer=
b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[h],0,k/4)));break;case 0:this.lineVertexBuffer||(this.lineVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[h]));break;case 8:this.lineTrianglesIndexBuffer||(this.lineTrianglesIndexBuffer=b.createIndex(c,35044,this._vectorTileData.bufferData[h]));break;case 1:this.lineJoinVertexBuffer||(this.lineJoinVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[h]));break;case 4:this.iconVertexBuffer||(this.iconVertexBuffer=
b.createVertex(c,35044,this._vectorTileData.bufferData[h]));break;case 9:this.iconIndexBuffer||(this.iconIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[h],0,k/4)));break;case 5:this.textVertexBuffer||(this.textVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[h]));break;case 10:this.textIndexBuffer||(this.textIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[h],0,k/4)))}}}this.status=4;return!0};g.prototype.detach=
function(a){this.status=3;this.polygonTrianglesVertexArrayObject&&(this.polygonTrianglesVertexArrayObject.dispose(),this.polygonTrianglesVertexArrayObject=null);this.polygonOutlineVertexArrayObject&&(this.polygonOutlineVertexArrayObject.dispose(),this.polygonOutlineVertexArrayObject=null);this.lineTrianglesVertexArrayObject&&(this.lineTrianglesVertexArrayObject.dispose(),this.lineTrianglesVertexArrayObject=null);this.lineJoinsVertexArrayObject&&(this.lineJoinsVertexArrayObject.dispose(),this.lineJoinsVertexArrayObject=
null);this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this.polygonTrianglesVertexBuffer&&(this.polygonTrianglesVertexBuffer.dispose(),this.polygonTrianglesVertexBuffer=null);this.polygonTrianglesIndexBuffer&&(this.polygonTrianglesIndexBuffer.dispose(),this.polygonTrianglesIndexBuffer=null);this.polygonOutlinesVertexBuffer&&(this.polygonOutlinesVertexBuffer.dispose(),
this.polygonOutlinesVertexBuffer=null);this.polygonOutlinesIndexBuffer&&(this.polygonOutlinesIndexBuffer.dispose(),this.polygonOutlinesIndexBuffer=null);this.lineVertexBuffer&&(this.lineVertexBuffer.dispose(),this.lineVertexBuffer=null);this.lineTrianglesIndexBuffer&&(this.lineTrianglesIndexBuffer.dispose(),this.lineTrianglesIndexBuffer=null);this.lineJoinVertexBuffer&&(this.lineJoinVertexBuffer.dispose(),this.lineJoinVertexBuffer=null);this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=
null);this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null);this._renderBuckets=[]};g.prototype.render=function(a){if(4===this.status){var b=a.context,c=a.renderer;if(b&&c){var d=a.drawphase;this._symbolUpdateData&&this._updateSymbolData(a);b.setStencilFunction(514,this.stencilData.reference,this.stencilData.mask);
var e=this.styleLayers,f,h=this._renderBuckets.length,g=0;if(0===d)for(g=h-1;0<=g;g--)f=this._renderBuckets[g],3!==f.type&&f.hasData()&&c.renderBucket(b,f,a.displayLevel,a.requiredLevel,d,this,e.layers[f.layerID]);else for(g=0;g<h;g++)f=this._renderBuckets[g],f.hasData()&&c.renderBucket(b,f,a.displayLevel,a.requiredLevel,d,this,e.layers[f.layerID])}}};g.prototype._updateSymbolData=function(a){var c=new Uint32Array(this._symbolUpdateData.bucketDataInfo),d=c.length;if(0===d)return this._symbolUpdateData=
null,!0;if(1>a.budget.remaining)return this.requestRender(),!1;a=a.context;a.bindVAO(null);for(var e=new Uint32Array(this._symbolUpdateData.bufferDataInfo),h=e.length,g=0,m=0;m<h;m+=2,g++){var k=e[m],u=e[m+1];if(!(0>=u||0===this._symbolUpdateData.bufferData[g].byteLength))switch(k){case 4:this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconVertexBuffer=b.createVertex(a,35044,this._symbolUpdateData.bufferData[g]);break;case 9:this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),
this.iconIndexBuffer=null);this.iconIndexBuffer=b.createIndex(a,35044,new Uint32Array(this._symbolUpdateData.bufferData[g],0,u/4));break;case 5:this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textVertexBuffer=b.createVertex(a,35044,this._symbolUpdateData.bufferData[g]);break;case 10:this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null),this.textIndexBuffer=b.createIndex(a,35044,new Uint32Array(this._symbolUpdateData.bufferData[g],
0,u/4))}}a=0;for(e=this._renderBuckets.length;a<e;a++)this._renderBuckets[a]instanceof f.SymbolRenderBucket&&(h=this._renderBuckets[a],h.markerElementStart=0,h.marketElementCount=0,h.textElementStart=0,h.textElementCount=0);for(h=0;h<d;){m=c[h];g=-1;a=0;for(e=this._renderBuckets.length;a<e;a++)if(this._renderBuckets[a].layerID===m){g=a;break}-1===g&&console.log("bucket not found");if(a=this._renderBuckets[g])a.markerElementStart=c[h+2],a.marketElementCount=c[h+3],a.textElementStart=c[h+4],a.textElementCount=
c[h+5];h+=7}this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this._symbolUpdateData=null;return!0};return g}(c)})},"esri/layers/vectorTiles/views/vectorTiles/RenderBucket":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper"],function(k,g,a,b){k=function(){return function(a){this.type=a}}();
g.RenderBucket=k;b=function(b){function d(){b.call(this,2);this.joinCount=this.joinStart=this.triangleElementCount=this.triangleElementStart=0}a(d,b);d.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.joinStart};return d}(k);g.LineRenderBucket=b;b=function(b){function d(){b.call(this,1);this.outlineElementCount=this.outlineElementStart=this.triangleElementCount=this.triangleElementStart=0}a(d,b);d.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.outlineElementCount};
return d}(k);g.FillRenderBucket=b;b=function(b){function d(){b.call(this,3);this.textElementCount=this.textElementStart=this.marketElementCount=this.markerElementStart=0;this.isSDF=!1}a(d,b);d.prototype.hasData=function(){return 0<this.marketElementCount||0<this.textElementCount};return d}(k);g.SymbolRenderBucket=b;k=function(b){function d(){b.call(this,0)}a(d,b);d.prototype.hasData=function(){return!0};return d}(k);g.BackgroundRenderBucket=k})},"esri/layers/vectorTiles/views/2d/engine/StageGL":function(){define("require exports ../../../core/tsSupport/extendsHelper ./Container ../../webgl/RenderingContext ../../webgl/webgl-utils".split(" "),
function(k,g,a,b,c,d){return function(b){function f(){b.apply(this,arguments)}a(f,b);f.prototype.createElement=function(){this.el||(this.el=document.createElement("canvas"),this.el.setAttribute("class","esri-display-object"));return this.el};f.prototype.attach=function(a){this._resizeCanvas(a);var f=d.setupWebGL(this.el,{alpha:!0,antialias:!1,depth:!0,stencil:!0});this._renderingContext=new c(f[0]);this.attached=!0;return b.prototype.attach.call(this,a)};f.prototype.detach=function(a){b.prototype.detach.call(this,
a);this._renderingContext=null};f.prototype.render=function(a){this._resizeCanvas(a);b.prototype.render.call(this,a)};f.prototype.prepareChildrenRenderParameters=function(a){if(!this.attached||!this._renderingContext)return null;var b=this._renderingContext.gl;this._renderingContext.setClearColor(0,0,0,0);this._renderingContext.setClearDepth(1);this._renderingContext.setClearStencil(0);this._renderingContext.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT|b.STENCIL_BUFFER_BIT);this._renderingContext.setViewport(0,
0,this.el.width,this.el.height);a.context=this._renderingContext;return a};f.prototype.attachChild=function(a,b){return a.attach(b)};f.prototype.detachChild=function(a,b){return a.detach(b)};f.prototype.renderChild=function(a,b){return a.render(b)};f.prototype._resizeCanvas=function(a){var b=this.el,c=b.style,d=a.state,e=a.devicePixelRatio;a=d.width*e;e*=d.height;if(b.width!==a||b.height!==e)b.width=a,b.height=e,c.width=d.width+"px",c.height=d.height+"px"};return f}(b)})},"esri/layers/vectorTiles/views/webgl/RenderingContext":function(){define(["require",
"exports","./enums","./Extensions"],function(k,g,a,b){return function(){function c(a,c){this.gl=null;this._extensions=void 0;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState={r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=
!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=1;this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680};this._lineWidth=1;this._clearColor={r:0,g:0,b:0,a:0};this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=
this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap={};this.gl=a;this._extensions=new b(a,c);var f=a.getParameter(a.VIEWPORT);this._viewport={x:f[0],y:f[1],width:f[2],height:f[3]};f=this.extensions.textureFilterAnisotropic;this._parameters={versionString:a.getParameter(a.VERSION),maxVertexTextureImageUnits:a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:a.getParameter(a.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:f?a.getParameter(f.MAX_TEXTURE_MAX_ANISOTROPY_EXT):
void 0,maxTextureImageUnits:a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS)};this.enforceState()}Object.defineProperty(c.prototype,"extensions",{get:function(){return this._extensions},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"parameters",{get:function(){return this._parameters},enumerable:!0,configurable:!0});c.prototype.setBlendingEnabled=
function(a){this._blendEnabled!==a&&(!0===a?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=a)};c.prototype.setBlendColor=function(a,b,c,h){if(a!==this._blendColorState.r||b!==this._blendColorState.g||c!==this._blendColorState.b||h!==this._blendColorState.a)this.gl.blendColor(a,b,c,h),this._blendColorState.r=a,this._blendColorState.g=b,this._blendColorState.b=c,this._blendColorState.a=h};c.prototype.setBlendFunction=function(a,b){if(a!==this._blendFunctionState.srcRGB||
b!==this._blendFunctionState.dstRGB)this.gl.blendFunc(a,b),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=a,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=b};c.prototype.setBlendFunctionSeparate=function(a,b,c,h){if(this._blendFunctionState.srcRGB!==a||this._blendFunctionState.srcAlpha!==c||this._blendFunctionState.dstRGB!==b||this._blendFunctionState.dstAlpha!==h)this.gl.blendFuncSeparate(a,b,c,h),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=
c,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=h};c.prototype.setBlendEquation=function(a){this._blendEquationState.mode!==a&&(this.gl.blendEquation(a),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=a)};c.prototype.setBlendEquationSeparate=function(a,b){if(this._blendEquationState.mode!==a||this._blendEquationState.modeAlpha!==b)this.gl.blendEquationSeparate(a,b),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=b};c.prototype.setColorMask=
function(a,b,c,h){if(this._colorMaskState.r!==a||this._colorMaskState.g!==b||this._colorMaskState.b!==c||this._colorMaskState.a!==h)this.gl.colorMask(a,b,c,h),this._colorMaskState.r=a,this._colorMaskState.g=b,this._colorMaskState.b=c,this._colorMaskState.a=h};c.prototype.setClearColor=function(a,b,c,h){if(this._clearColor.r!==a||this._clearColor.g!==b||this._clearColor.b!==c||this._clearColor.a!==h)this.gl.clearColor(a,b,c,h),this._clearColor.r=a,this._clearColor.g=b,this._clearColor.b=c,this._clearColor.a=
h};c.prototype.setFaceCullingEnabled=function(a){this._polygonCullingEnabled!==a&&(!0===a?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=a)};c.prototype.setPolygonOffsetFillEnabled=function(a){this._polygonOffsetFillEnabled!==a&&(!0===a?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=a)};c.prototype.setPolygonOffset=function(a,b){if(this._polygonOffset[0]!==a||this._polygonOffset[1]!==
b)this._polygonOffset[0]=a,this._polygonOffset[1]=b,this.gl.polygonOffset(a,b)};c.prototype.setCullFace=function(a){this._cullFace!==a&&(this.gl.cullFace(a),this._cullFace=a)};c.prototype.setFrontFace=function(a){this._frontFace!==a&&(this.gl.frontFace(a),this._frontFace=a)};c.prototype.setScissorTestEnabled=function(a){this._scissorTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=a)};c.prototype.setScissorRect=function(a,
b,c,h){if(this._scissorRect.x!==a||this._scissorRect.y!==b||this._scissorRect.width!==c||this._scissorRect.height!==h)this.gl.scissor(a,b,c,h),this._scissorRect.x=a,this._scissorRect.y=b,this._scissorRect.width=c,this._scissorRect.height=h};c.prototype.setDepthTestEnabled=function(a){this._depthTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=a)};c.prototype.setClearDepth=function(a){this._clearDepth!==a&&(this.gl.clearDepth(a),
this._clearDepth=a)};c.prototype.setDepthFunction=function(a){this._depthFunction!==a&&(this.gl.depthFunc(a),this._depthFunction=a)};c.prototype.setDepthWriteEnabled=function(a){this._depthWriteEnabled!==a&&(this.gl.depthMask(a),this._depthWriteEnabled=a)};c.prototype.setDepthRange=function(a,b){if(this._depthRange.zNear!==a||this._depthRange.zFar!==b)this.gl.depthRange(a,b),this._depthRange.zNear=a,this._depthRange.zFar=b};c.prototype.setStencilTestEnabled=function(a){this._stencilTestEnabled!==
a&&(!0===a?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=a)};c.prototype.setClearStencil=function(a){a!==this._clearStencil&&(this.gl.clearStencil(a),this._clearStencil=a)};c.prototype.setStencilFunction=function(a,b,c){if(this._stencilFunction.func!==a||this._stencilFunction.ref!==b||this._stencilFunction.mask!==c)this.gl.stencilFunc(a,b,c),this._stencilFunction.face=1032,this._stencilFunction.func=a,this._stencilFunction.ref=b,this._stencilFunction.mask=
c};c.prototype.setStencilFunctionSeparate=function(a,b,c,h){if(this._stencilFunction.face!==a||this._stencilFunction.func!==b||this._stencilFunction.ref!==c||this._stencilFunction.mask!==h)this.gl.stencilFuncSeparate(a,b,c,h),this._stencilFunction.face=a,this._stencilFunction.func=b,this._stencilFunction.ref=c,this._stencilFunction.mask=h};c.prototype.setStencilWriteMask=function(a){this._stencilWriteMask!==a&&(this.gl.stencilMask(a),this._stencilWriteMask=a)};c.prototype.setStencilOp=function(a,
b,c){if(this._stencilOperation.fail!==a||this._stencilOperation.zFail!==b||this._stencilOperation.zPass!==c)this.gl.stencilOp(a,b,c),this._stencilOperation.face=1032,this._stencilOperation.fail=a,this._stencilOperation.zFail=b,this._stencilOperation.zPass=c};c.prototype.setStencilOpSeparate=function(a,b,c,h){if(this._stencilOperation.face!==a||this._stencilOperation.fail!==b||this._stencilOperation.zFail!==c||this._stencilOperation.zPass!==h)this.gl.stencilOpSeparate(a,b,c,h),this._stencilOperation.face=
a,this._stencilOperation.face=a,this._stencilOperation.fail=b,this._stencilOperation.zFail=c,this._stencilOperation.zPass=h};c.prototype.setLineWidth=function(a){var b=this._lineWidth;this._lineWidth!==a&&(this.gl.lineWidth(a),this._lineWidth=a);return b};c.prototype.setActiveTexture=function(b){var c=this._activeTextureUnit;0<=b&&b!==this._activeTextureUnit&&(this.gl.activeTexture(a.BASE_TEXTURE_UNIT+b),this._activeTextureUnit=b);return c};c.prototype.clear=function(a){a&&this.gl.clear(a)};c.prototype.drawArrays=
function(a,b,c){this.gl.drawArrays(a,b,c)};c.prototype.drawElements=function(a,b,c,h){5123===c?this.gl.drawElements(a,b,c,h):5125===c&&this._extensions.elementIndexUint?this.gl.drawElements(a,b,c,h):console.warn("Data type is uint however extension OES_Element_index_unit is not supported therefore this draw call cannot be made")};c.prototype.drawArraysInstanced=function(a,b,c,h){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawArraysInstancedANGLE(a,b,c,h):console.error("Extension ANGLE_instanced_arrays isn't supported!")};
c.prototype.drawElementsInstanced=function(a,b,c,h,g){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawElementsInstancedANGLE(a,b,c,h,g):console.error("Extension ANGLE_instanced_arrays isn't supported!")};c.prototype.setViewport=function(a,b,c,h){var g=this._viewport;if(g.x!==a||g.y!==b||g.width!==c||g.height!==h)g.x=a,g.y=b,g.width=c,g.height=h,this.gl.viewport(a,b,c,h)};c.prototype.getViewport=function(){return this._viewport};c.prototype.bindProgram=function(a){a?
this._activeShaderProgram!==a&&(a.initialize(),this.gl.useProgram(a.glName),this._activeShaderProgram=a):(this.gl.useProgram(null),this._activeShaderProgram=null)};c.prototype.bindTexture=function(a,b){void 0===b&&(b=0);-1===c._MAX_TEXTURE_IMAGE_UNITS&&(c._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));(b>=c._MAX_TEXTURE_IMAGE_UNITS||0>b)&&console.error("Input texture unit is out of range of available units!");var f=this._textureUnitMap[b];this.setActiveTexture(b);
null==a?(null!=f&&this.gl.bindTexture(f.descriptor.target,null),this._textureUnitMap[b]=null):f&&f.id===a.id?a.applyChanges():(this.gl.bindTexture(a.descriptor.target,a.glName),a.applyChanges(),this._textureUnitMap[b]=a)};c.prototype.bindFramebuffer=function(a){a?this._activeFramebuffer!==a&&(a.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.glName),this._activeFramebuffer=a):(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this._activeFramebuffer=null)};c.prototype.bindBuffer=function(a){a&&
(34962===a.bufferType?this._activeVertexBuffer=c._bindBuffer(this.gl,a,a.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=c._bindBuffer(this.gl,a,a.bufferType,this._activeIndexBuffer))};c.prototype.unbindBuffer=function(a){34962===a?this._activeVertexBuffer=c._bindBuffer(this.gl,null,a,this._activeVertexBuffer):this._activeIndexBuffer=c._bindBuffer(this.gl,null,a,this._activeIndexBuffer)};c.prototype.bindVAO=function(a){a?this._activeVertexArrayObject&&this._activeVertexArrayObject.id===
a.id||(a.bind(),this._activeVertexArrayObject=a):this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null)};c.prototype.getBoundTexture=function(a){return this._textureUnitMap[a]};c.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer};c.prototype.getBoundVAO=function(){return this._activeVertexArrayObject};c.prototype.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);
this.unbindBuffer(34963);for(var a=0;a<this.parameters.maxTextureImageUnits;a++)this.bindTexture(null,a);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);
this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};c.prototype.enforceState=function(){var b=this.gl,c=this._extensions.vao;c&&c.bindVertexArrayOES(null);for(var f=0;f<this.parameters.maxVertexAttributes;f++)b.disableVertexAttribArray(f);
this._activeVertexBuffer?b.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):b.bindBuffer(34962,null);this._activeIndexBuffer?b.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):b.bindBuffer(34963,null);if(c&&this._activeVertexArrayObject){if(c=this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null;this.bindVAO(c)}b.bindFramebuffer(b.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:
null);b.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);b.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);!0===this._blendEnabled?b.enable(this.gl.BLEND):b.disable(this.gl.BLEND);b.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);b.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);
b.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);b.clearDepth(this._clearDepth);b.clearStencil(this._clearStencil);b.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);b.cullFace(this._cullFace);b.depthFunc(this._depthFunction);b.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST);b.depthMask(this._depthWriteEnabled);b.frontFace(this._frontFace);
b.lineWidth(this._lineWidth);!0===this._polygonCullingEnabled?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE);b.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?b.enable(b.POLYGON_OFFSET_FILL):b.disable(b.POLYGON_OFFSET_FILL);b.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?b.enable(b.SCISSOR_TEST):b.disable(b.SCISSOR_TEST);b.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,
this._stencilFunction.mask);b.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST);b.stencilMask(this._stencilWriteMask);for(c=0;c<this.parameters.maxTextureImageUnits;c++)b.activeTexture(a.BASE_TEXTURE_UNIT+c),b.bindTexture(3553,null),(f=this._textureUnitMap[c])&&b.bindTexture(f.descriptor.target,f.glName);b.activeTexture(a.BASE_TEXTURE_UNIT+
this._activeTextureUnit);b.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)};c._bindBuffer=function(a,b,c,h){if(!b)return a.bindBuffer(c,null),null;if(h===b)return h;a.bindBuffer(c,b.glName);return b};c._MAX_TEXTURE_IMAGE_UNITS=-1;return c}()})},"esri/layers/vectorTiles/views/webgl/enums":function(){define(["require","exports"],function(k,g){g.BASE_TEXTURE_UNIT=33984})},"esri/layers/vectorTiles/views/webgl/Extensions":function(){define(["require","exports"],function(k,
g){return function(){function a(a,c){this._compressedTextureS3TCInit=this._shaderTextureLODInit=this._textureFilterAnisotropicInit=this._depthTextureInit=this._elementIndexUintInit=this._standardDerivativesInit=this._angleInstancedArraysInit=this._vaoInit=!1;this._gl=a;if(c&&c.disabledExtensions){var d=c.disabledExtensions;d.vao&&(this._vao=null,this._vaoInit=!0);d.angleInstancedArrays&&(this._angleInstancedArrays=null,this._angleInstancedArraysInit=!0);d.standardDerivatives&&(this._standardDerivatives=
null,this._standardDerivativesInit=!0);d.elementIndexUint&&(this._elementIndexUint=null,this._elementIndexUintInit=!0);d.depthTexture&&(this._depthTexture=null,this._depthTextureInit=!0);d.textureFilterAnisotropic&&(this._textureFilterAnisotropic=null,this._textureFilterAnisotropicInit=!0);d.compressedTextureS3TC&&(this._compressedTextureS3TC=null,this._compressedTextureS3TCInit=!0);d.shaderTextureLOD&&(this._shaderTextureLOD=null,this._shaderTextureLODInit=!0)}}Object.defineProperty(a.prototype,
"vao",{get:function(){this._vaoInit||(this._vao=this._gl.getExtension("OES_vertex_array_object")||this._gl.getExtension("MOZ_OES_vertex_array_object")||this._gl.getExtension("WEBKIT_OES_vertex_array_object"),this._vaoInit=!0);return this._vao},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"angleInstancedArrays",{get:function(){this._angleInstancedArraysInit||(this._angleInstancedArrays=this._gl.getExtension("ANGLE_instanced_arrays"),this._angleInstancedArraysInit=!0);return this._angleInstancedArrays},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"standardDerivatives",{get:function(){this._standardDerivativesInit||(this._standardDerivatives=this._gl.getExtension("OES_standard_derivatives"),this._standardDerivativesInit=!0);return this._standardDerivatives},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"elementIndexUint",{get:function(){this._elementIndexUintInit||(this._elementIndexUint=this._gl.getExtension("OES_element_index_uint"),this._elementIndexUintInit=
!0);return this._elementIndexUint},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"depthTexture",{get:function(){this._depthTextureInit||(this._depthTexture=this._gl.getExtension("WEBGL_depth_texture")||this._gl.getExtension("MOZ_WEBGL_depth_texture")||this._gl.getExtension("WEBKIT_WEBGL_depth_texture"),this._depthTextureInit=!0);return this._depthTexture},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"textureFilterAnisotropic",{get:function(){this._textureFilterAnisotropicInit||
(this._textureFilterAnisotropic=this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this._textureFilterAnisotropicInit=!0);return this._textureFilterAnisotropic},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"shaderTextureLOD",{get:function(){this._shaderTextureLODInit||(this._shaderTextureLOD=this._gl.getExtension("EXT_shader_texture_lod"),this._shaderTextureLODInit=
!0);return this._shaderTextureLOD},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"compressedTextureS3TC",{get:function(){this._compressedTextureS3TCInit||(this._compressedTextureS3TC=this._gl.getExtension("WEBGL_compressed_texture_s3tc"),this._compressedTextureS3TCInit=!0);return this._compressedTextureS3TC},enumerable:!0,configurable:!0});return a}()})},"esri/layers/vectorTiles/views/webgl/webgl-utils":function(){define([],function(){var k=function(a,c){for(var d=["webgl","experimental-webgl",
"webkit-3d","moz-webgl"],e=null,f=0;f<d.length;++f){try{e=a.getContext(d[f],c)}catch(h){}if(e)break}return e},g=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,c){return window.setTimeout(a,1E3/60)}).bind(window),a=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout).bind(window);
return{create3DContext:k,setupWebGL:function(a,c){function d(c){var d=a.parentNode;d&&(d.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+c+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}if(!window.WebGLRenderingContext)return d('This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),
[null,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'];var e=k(a,c);return!e?(d('It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'),[null,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e']):
[e]},detectWebGL:function(){var a;try{a=window.WebGLRenderingContext}catch(c){a=[!1,0]}var d;try{d=k(document.createElement("canvas"))}catch(e){d=[!1,1]}return!a?[!1,0]:!d?[!1,1]:[!0,{VERSION:d.getParameter(d.VERSION),SHADING_LANGUAGE_VERSION:d.getParameter(d.SHADING_LANGUAGE_VERSION),VENDOR:d.getParameter(d.VENDOR),RENDERER:d.getParameter(d.RENDERER),EXTENSIONS:d.getSupportedExtensions(),MAX_TEXTURE_SIZE:d.getParameter(d.MAX_TEXTURE_SIZE),MAX_RENDERBUFFER_SIZE:d.getParameter(d.MAX_RENDERBUFFER_SIZE),
MAX_VERTEX_TEXTURE_IMAGE_UNITS:d.getParameter(d.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}]},requestAnimFrame:g,cancelAnimFrame:a}})},"esri/layers/vectorTiles/views/2d/FrameBudget":function(){define(["require","exports","../../core/now"],function(k,g,a){return function(){function b(a){void 0===a&&(a=Number.MAX_VALUE);this._budget=this._begin=0;this.enabled=!0;this.reset(a)}b.now=function(){return a()};Object.defineProperty(b.prototype,"done",{get:function(){return this.enabled&&this.elapsed>=this._budget},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"elapsed",{get:function(){return a()-this._begin},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"remaining",{get:function(){return Math.max(this._budget-this.elapsed,0)},enumerable:!0,configurable:!0});b.prototype.reset=function(b){void 0===b&&(b=Number.MAX_VALUE);this._begin=a();this._budget=this.enabled?b:Number.MAX_VALUE};return b}()})},"esri/layers/vectorTiles/views/2d/layers/support/TileInfoView":function(){define("require exports ./LODInfo ./TileKey ./TileSpan ./TileCoverage".split(" "),
function(k,g,a,b,c,d){var e=function(){function a(b,c,d,e,f,h,g,k){this.x=b;this.ymin=c;this.ymax=d;this.invM=e;this.leftAdjust=f;this.rightAdjust=h;this.leftBound=g;this.rightBound=k}a.create=function(b,c){b[1]>c[1]&&(d=[c,b],b=d[0],c=d[1]);var d=b[0],e=b[1],f=c[0],g=c[1],k=f-d,t=g-e,t=0!==t?k/t:0,x=(Math.ceil(e)-e)*t,u=(Math.floor(e)-e)*t;return new a(d,Math.floor(e),Math.ceil(g),t,0>k?x:u,0>k?u:x,0>k?f:d,0>k?d:f);var d};a.prototype.incrRow=function(){this.x+=this.invM};a.prototype.getLeftCol=function(){return Math.max(this.x+
this.leftAdjust,this.leftBound)};a.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return a}(),f=[[0,0],[0,0],[0,0],[0,0]];return function(){function h(b,c){var d=this;this.scales=[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var e=b.lods.slice();e.sort(function(a,b){return b.scale-a.scale});var f=this._lodInfos=e.map(function(d){return a.create(b,d,c)});e.forEach(function(a,b){d._infoByLevel[a.level]=f[b];d._infoByScale[a.scale]=f[b];
d.scales[b]=a.scale},this);this._wrap=b.spatialReference.isWrappable}h.prototype.getTileTopLeft=function(a,b){var c=this._infoByLevel[b.level];return!c?a:c.getTileTopLeft(a,b)};h.prototype.getTileBottomRight=function(a,b){var c=this._infoByLevel[b.level];return!c?a:c.getTileBottomRight(a,b)};h.prototype.getTileResolution=function(a){a=this._infoByLevel[a.level];return!a?-1:a.resolution};h.prototype.getTileParentId=function(a){a=b.from(a);var c=this._lodInfos.indexOf(this._infoByLevel[a.level])-1;
return 0>c?null:this.getTileIdAtParent(this._lodInfos[c],a)};h.prototype.getTileIdAtParent=function(a,c){var d=b.from(c),e=this._infoByLevel[d.level];if(a.resolution<e.resolution)throw Error("Cannot calculate parent tile. destination LOD's resolution "+a.resolution+" is not a parent resolution of "+e.resolution);return a.resolution===e.resolution?d.id:b.getId(a.level,Math.floor(d.row*e.resolution/a.resolution+0.01),Math.floor(d.col*e.resolution/a.resolution+0.01),d.world)};h.prototype.getTileCoverage=
function(a){var b=this.getClosestInfoForScale(a.scale),h=this._wrap,g;g=Infinity;var k=-Infinity,r,q,t=[];f[0][0]=f[0][1]=f[1][1]=f[3][0]=0;f[1][0]=f[2][0]=a.width;f[2][1]=f[3][1]=a.height;for(var x=f.map(function(c){a.toMap(c,c);c[0]=b.getColumnForX(c[0]);c[1]=b.getRowForY(c[1]);return c}),u=[],w=3,v=0;4>v;v++)x[v][1]!==x[w][1]&&(w=e.create(x[v],x[w]),g=Math.min(w.ymin,g),k=Math.max(w.ymax,k),void 0===u[w.ymin]&&(u[w.ymin]=[]),u[w.ymin].push(w)),w=v;if(null==g||null==k||100<k-g)return null;for(x=
[];g<k;){null!=u[g]&&(x=x.concat(u[g]));r=Infinity;q=-Infinity;for(v=x.length-1;0<=v;v--)w=x[v],r=Math.min(r,w.getLeftCol()),q=Math.max(q,w.getRightCol());r=Math.floor(r);q=Math.floor(q);if(g>=b.first[1]&&g<=b.last[1])if(h)if(b.size[0]<b.worldSize[0]){v=Math.floor(r/b.worldSize[0]);for(w=Math.floor(q/b.worldSize[0]);v<=w;v++)t.push(new c(g,Math.max(b.getFirstColumnForWorld(v),r),Math.min(b.getLastColumnForWorld(v),q)))}else t.push(new c(g,r,q));else r>b.last[0]||q<b.first[0]||(r=Math.max(r,b.first[0]),
q=Math.min(q,b.last[0]),t.push(new c(g,r,q)));g+=1;for(v=x.length-1;0<=v;v--)w=x[v],w.ymax>=g?w.incrRow():x.splice(v,1)}return new d(b,t)};h.prototype.intersects=function(a,c){var d=b.from(c),e=this._infoByLevel[d.level],f=a.lodInfo;if(f.resolution>e.resolution){var h=b.fromId(this.getTileIdAtParent(f,d)),g=f.denormalizeCol(h.col,h.world);return a.spans.some(function(a){return a.row===h.row&&a.colFrom<=g&&a.colTo>=g})}if(f.resolution<e.resolution){var k=a.spans.reduce(function(a,b){a[0]=Math.min(a[0],
b.row);a[1]=Math.max(a[1],b.row);a[2]=Math.min(a[2],b.colFrom);a[3]=Math.max(a[3],b.colTo);return a},[Infinity,-Infinity,Infinity,-Infinity]),x=k[0],u=k[1],w=k[2],k=k[3],v=e.denormalizeCol(d.col,d.world),y=f.getColumnForX(e.getXForColumn(v)),z=f.getRowForY(e.getYForRow(d.row)),v=f.getColumnForX(e.getXForColumn(v+1))-1,e=f.getRowForY(e.getYForRow(d.row+1))-1;return!(y>k||v<w||z>u||e<x)}var A=f.denormalizeCol(d.col,d.world);return a.spans.some(function(a){return a.row===d.row&&a.colFrom<=A&&a.colTo>=
A})};h.prototype.getClosestInfoForScale=function(a){var b=this.scales;this._infoByScale[a]||(a=b.reduce(function(b,c,d,e){return Math.abs(c-a)<Math.abs(b-a)?c:b},b[0]));return this._infoByScale[a]};return h}()})},"esri/layers/vectorTiles/views/2d/layers/support/LODInfo":function(){define(["require","exports","./TileKey"],function(k,g,a){function b(a,b,e){a[0]=b;a[1]=e;return a}return function(){function c(a,b,c,h,g,l,k,p,s,r,q){this.level=a;this.resolution=b;this.origin=c;this.first=h;this.last=g;
this.size=l;this.norm=k;this.worldStart=p;this.worldEnd=s;this.worldSize=r;this.wrap=q}c.create=function(a,e,f){var g=a.spatialReference._getInfo(),k=[a.origin.x,a.origin.y],l=[a.size[0]*e.resolution,a.size[1]*e.resolution],n=[-Infinity,-Infinity],p=[Infinity,Infinity],s=[Infinity,Infinity];f&&(b(n,Math.max(0,Math.floor((f.xmin-k[0])/l[0])),Math.max(0,Math.floor((k[1]-f.ymax)/l[1]))),b(p,Math.max(0,Math.floor((f.xmax-k[0])/l[0])),Math.max(0,Math.floor((k[1]-f.ymin)/l[1]))),b(s,p[0]-n[0]+1,p[1]-n[1]+
1));var r;g?(a=[Math.ceil(Math.round(2*g.origin[1]/e.resolution)/a.size[0]),s[1]],g=[Math.floor((g.origin[0]-k[0])/l[0]),n[1]],f=[a[0]-g[0]-1,p[1]],r=!0):(g=n,f=p,a=s,r=!1);return new c(e.level,e.resolution,k,n,p,s,l,g,f,a,r)};c.prototype.normalizeCol=function(a){if(!this.wrap)return a;var b=this.worldSize[0];return 0>a?b-1-Math.abs((a+1)%b):a%b};c.prototype.denormalizeCol=function(a,b){return!this.wrap?a:this.worldSize[0]*b+a};c.prototype.getWorldForColumn=function(a){return!this.wrap?0:Math.floor(a/
this.worldSize[0])};c.prototype.getFirstColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]};c.prototype.getLastColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]+this.size[0]-1};c.prototype.getColumnForX=function(a){return(a-this.origin[0])/this.norm[0]};c.prototype.getXForColumn=function(a){return this.origin[0]+a*this.norm[0]};c.prototype.getRowForY=function(a){return(this.origin[1]-a)/this.norm[1]};c.prototype.getYForRow=function(a){return this.origin[1]-a*this.norm[1]};
c.prototype.getTileTopLeft=function(c,e){var f=a.from(e);return b(c,this.getXForColumn(this.denormalizeCol(f.col,f.world)),this.getYForRow(f.row))};c.prototype.getTileBottomRight=function(c,e){var f=a.from(e);return b(c,this.getXForColumn(this.denormalizeCol(f.col,f.world)+1),this.getYForRow(f.row+1))};return c}()})},"esri/layers/vectorTiles/views/2d/layers/support/TileSpan":function(){define(["require","exports"],function(k,g){return function(){return function(a,b,c){this.row=a;this.colFrom=b;this.colTo=
c}}()})},"esri/layers/vectorTiles/views/2d/layers/support/TileCoverage":function(){define(["require","exports"],function(k,g){return function(){return function(a,b){this.lodInfo=a;this.spans=b}}()})},"esri/layers/vectorTiles/views/2d/layers/support/TileStrategy":function(){define(["require","exports","../../../../core/LRUCache","../../layers/support/TileKey"],function(k,g,a,b){function c(a,b){a["delete"](b)}var d=[],e=[],f=[null,null],h=[];return function(){function g(b,c,d,e){this.container=b;this.tileInfoView=
c;this.requestUpdate=d;this.fetchTile=e;this._tilesToRender=new Map;this._requests=new Map;this._updates=new Map;this._loadedTiles=new Map;this._newTilesToRender=new Map;this._lru=new a(30);this._prevResolution=Number.POSITIVE_INFINITY;this._isStationary=!1}g.prototype.destroy=function(){this._requests&&(this._requests.forEach(function(a){a.isFulfilled()||a.cancel()}),this._loadedTiles=this._tilesToRender=this._requests=null)};g.prototype.update=function(a){var e=this,f=this.tileInfoView.getTileCoverage(a.state);
if(f){var k=f.lodInfo.level,r=a.state.resolution;if(1.5>a.budget.remaining)this.requestUpdate(),this._prevResolution=r;else{var q=r>this._prevResolution;this._prevResolution=r;g._createCoverageList(d,f);for(var t=0,x,u=0;u<d.length;u++)if(r=d[u],this._tilesToRender.has(r))x=this._tilesToRender.get(r),x.visible=!0,this._newTilesToRender.set(r,x),t++,x.attached||q||this._addParentTile(r,this._newTilesToRender);else if(this._loadedTiles.has(r))this._newTilesToRender.set(r,this._loadedTiles.get(r)),t++,
c(this._loadedTiles,r),q||this._addParentTile(r,this._newTilesToRender);else if(this._lru.has(r))x=this._lru.use(r),x.visible=!0,this._newTilesToRender.set(r,x),t++,!x.attached&&!q&&this._addParentTile(r,this._newTilesToRender);else{if(x=this._requests.get(r)){if(x.isCanceled()||x.isRejected())c(this._requests,r),this._getTile(r,a)}else this._getTile(r,a);q||this._addParentTile(r,this._newTilesToRender)}!this._isStationary&&a.stationary&&this.requestUpdate();this._isStationary=a.stationary;var w=
t===d.length,r=this._tilesToRender,v;r.forEach(function(a,d){v=b.from(d);e._newTilesToRender.has(d)||(0===v.level||v.level<k&&e.tileInfoView.intersects(f,v)?(a.visible=!1,e._newTilesToRender.set(d,a)):(q||!w)&&e.tileInfoView.intersects(f,v)?(a.visible=!0,e._newTilesToRender.set(d,a)):(e._updates.has(d)&&(e._updates.get(d).cancel(d),c(e._updates,d)),a.visible=!0,e._lru.insert(d,a)))});r.clear();this._tilesToRender=this._newTilesToRender;this._newTilesToRender=r;this.container.removeAllChildren();this._tilesToRender.forEach(function(a){return e.container.addChild(a)},
this);this._loadedTiles.forEach(function(a){return a.dispose()});this._loadedTiles.clear();this._requests.forEach(function(c,d){if(a.budget.done)e.requestUpdate();else if(c.isFulfilled())h.push(d);else if(v=b.from(d),v.level>k||!e.tileInfoView.intersects(f,v))c.cancel(),h.push(d)});for(t=0;t<h.length;t++)r=h[t],c(this._requests,r);h.length=0}}};g.prototype.updateTiles=function(a,b){var d=this;this._tilesToRender.forEach(function(e,f){if(e.visible&&e.attached){var g=a(e,b);g&&(d._updates.has(f)&&(d._updates.get(f).cancel(),
c(d._updates,f)),g.then(function(a){c(d._updates,f);d._tilesToRender.set(f,a)}),d._updates.set(f,g))}})};g.prototype._addParentTile=function(a,b){this._getAvailableParentTile(f,a);f[0]&&!b.has(f[0])&&(f[1].visible=!0,b.set(f[0],f[1]))};g.prototype._getTile=function(a,d){var e=this;if(!this._requests.has(a)){var f=this.fetchTile(a,d);f.then(function(d){var f=b.fromId(a);e.tileInfoView.getTileTopLeft(d.topLeft,f);e.tileInfoView.getTileBottomRight(d.bottomRight,f);d.resolution=e.tileInfoView.getTileResolution(f);
e._loadedTiles.set(a,d);c(e._requests,a);e.requestUpdate()}).otherwise(function(b){c(e._requests,a)});this._requests.set(a,f)}};g.prototype._getAvailableParentTile=function(a,b){a[0]=null;a[1]=null;for(var c=b;c=this.tileInfoView.getTileParentId(c);){if(this._tilesToRender.has(c)){a[0]=c;a[1]=this._tilesToRender.get(c);break}if(this._lru.has(c)){var d=this._lru.use(c);if(d.attached){a[0]=c;a[1]=d;break}}}return a};g._createCoverageList=function(a,c){a.length=0;e.length=0;var d=c.spans;if(0!==d.length){for(var f=
0,g=0,h=Infinity,k=-Infinity,f=d[0].row,g=d[d.length-1].row,m=0;m<d.length;m++)for(var u=d[m],w=u.colFrom,u=u.colTo;w<=u;w++)h=Math.min(h,w),k=Math.max(k,w);var m=c.lodInfo,w=m.level,g=f+Math.floor((g-f)/2),h=h+Math.floor((k-h)/2),v,u=g-f;0<=u&&u<d.length&&(v=b.from(w,g,m.normalizeCol(h),m.getWorldForColumn(h)),e.push({dist:0,id:v.id}));for(var y,k=0;k<d.length;k++){u=d[k];f=u.row;w=u.colFrom;for(u=u.colTo;w<=u;w++)y=Math.abs(w-h)+Math.abs(f-g),0!==y&&(v.row=f,v.col=m.normalizeCol(w),v.world=m.getWorldForColumn(w),
e.push({dist:y,id:v.id}))}e.sort(function(a,b){return a.dist-b.dist});for(d=0;d<e.length;d++)a.push(e[d].id)}};return g}()})},"esri/layers/vectorTiles/core/LRUCache":function(){define(["require","exports"],function(k,g){return function(){function a(a){this._cache={};this._lruQueue=[];if(0>=a)throw Error("LRU cache size must be bigger than zero!");this._maxSize=a}a.prototype.has=function(a){return void 0!==this._cache[a]};a.prototype.insert=function(a,c){null!==this.use(a)?this._cache[a]=c:(this._collect(),
this._cache[a]=c,this._lruQueue.unshift(a))};a.prototype.use=function(a){var c=this._cache[a];if(!c)return null;this._lruQueue.splice(this._lruQueue.indexOf(a),1);this._lruQueue.unshift(a);return c};a.prototype.print=function(){for(var a=0,c=this._lruQueue;a<c.length;a++){var d=c[a];console.log("key: "+d+", value: "+this._cache[d])}};a.prototype._collect=function(){if(!(this._lruQueue.length<this._maxSize)){var a=this._lruQueue.pop(),c=this._cache[a];c&&c.dispose();delete this._cache[a]}};return a}()})},
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/background.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform mediump vec2 u_normalized_origin;\r\nuniform mediump float u_coord_range;\r\nuniform mediump float u_depth;\r\n\r\nvoid main() {\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\r\n}\r\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/background.fs.glsl":"uniform lowp vec4 u_color;\r\nvoid main() {\r\n  gl_FragColor \x3d u_color;\r\n}",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/patternFillShader.vs.glsl":"uniform highp mat4 u_transformMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\nuniform mediump mat3 u_pattern_matrix; // can we use meduim precision??\r\n\r\nattribute vec2 a_pos;\r\n\r\nvarying mediump vec2 v_tileTextureCoord;\r\n\r\nvoid main()\r\n{\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\r\n  // calculate the texture coordinates of the current vertex. It will of course get interpolated.\r\n  // The pattern matrix is a 3x3 scale matrix which 'tiles' the texture inside the tile, translating from tile coordinates\r\n  // (-4k to 8k -1) to texture coordinates.\r\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/patternFillShader.fs.glsl":"uniform lowp float u_opacity;\r\nuniform mediump vec2 u_pattern_tl;\r\nuniform mediump vec2 u_pattern_br;\r\nuniform sampler2D u_texture;\r\n\r\nvarying mediump vec2 v_tileTextureCoord;\r\n\r\nvoid main()\r\n{\r\n  // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\r\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\r\n  // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\r\n  // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\r\n  // we need to only sample from area that has our sprite in the mosaic.\r\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\r\n  // sample the sprite mosaic\r\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\r\n\r\n  // 'un-premultiply' the color\r\n  lowp float inv_alpha \x3d (1.0 / clamp(color.a, 0.00390625, 1.0));\r\n  gl_FragColor \x3d color * vec4(inv_alpha, inv_alpha, inv_alpha, u_opacity);\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineShader.vs.glsl":"/* The implementation of the renderer is based on the article and implementation of MB described here:\r\n* https://www.mapbox.com/blog/drawing-antialiased-lines/\r\n*/\r\n\r\nattribute vec2 a_pos;\r\nattribute vec2 a_offset;\r\nattribute float a_accumulatedDistance;\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the inset and outset of the line\r\nuniform mediump float u_lineHalfWidth;\r\n// the interpolated normal to the line. the information is packed into the LSB of the vertex coordinate\r\nvarying mediump vec2 v_normal;\r\n// the accumulated distance along the line. We need this information in order to render the dashes.\r\nvarying highp float v_accumulatedDistance;\r\n\r\nconst float scale \x3d 1.0 / 31.0;\r\n\r\nvoid main()\r\n{\r\n  // extract the normal from the list significat bit. It has a value of 0 or 1, but we need it to be either -1 or 1 therefore\r\n  // we need to change 0 to -1.\r\n  lowp vec2 normal \x3d mod(a_pos, 2.0);\r\n  normal.y \x3d normal.y \x3d\x3d 0.0 ? -1.0 : 1.0;\r\n  v_normal \x3d normal;\r\n\r\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\r\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\r\n  lowp vec2 dist \x3d u_lineHalfWidth * a_offset * scale;\r\n\r\n  // transform the vertex\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), 0.0, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\r\n\r\n  // the accumulated distance will be used to calculate the dashes (or the no-data...)\r\n  v_accumulatedDistance \x3d a_accumulatedDistance;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineShader.fs.glsl":"/* The implementation of the renderer is based on the article and implementation of MB described here:\r\n* https://www.mapbox.com/blog/drawing-antialiased-lines/\r\n*/\r\n\r\nuniform mediump float u_lineHalfWidth;\r\nuniform lowp vec4 u_color;\r\nuniform mediump vec2 u_dasharray;\r\nuniform lowp float u_blur;\r\n\r\nvarying mediump vec2 v_normal;\r\nvarying highp float v_accumulatedDistance;\r\n\r\nvoid main()\r\n{\r\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\r\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\r\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\r\n  mediump float fragDist \x3d length(v_normal) * u_lineHalfWidth;\r\n\r\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\r\n  // We need to count for both sides of the line.\r\n  lowp float alpha \x3d clamp( min(fragDist + u_blur + 1.0, u_lineHalfWidth - fragDist) / u_blur, 0.0, 1.0);\r\n\r\n  // now calculate the dashes given the accumulated distance of the line:\r\n  // start with calculating a normalized position along the line\r\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, u_dasharray.x + u_dasharray.y);\r\n\r\n  // calculate the contribution to the alpha of the dash part. It is provided by the shortest portion of the position along the dash.\r\n  // we must clamp since the value might be bigger than 1 or smaller than zero (when over a dash).\r\n  //   | \x3c--- pos along the dash part\r\n  // -------_______-------_______\r\n  // when the dashPos is over the 'gap' part of the dash u_dasharray.x - dashPos is negative and therefore the alpha will\r\n  // get clamped to zero.\r\n  // when u_dasharray.x - dashPos is positive, or when dashPos is smaller than 1.0, it gives us a soft edge to each dash part.\r\n  // along the direction of the line.\r\n  lowp float dashAlpha \x3d clamp( min(dashPos, u_dasharray.x - dashPos), 0.0, 1.0);\r\n\r\n  // if we don't have a no-data part to the dash then it is a solid line\r\n  dashAlpha \x3d max(sign(-u_dasharray.y), dashAlpha); //sign(-u_dasharray.y) \x3e 0.0 ? 1.0 : dashAlpha;\r\n  // finally multiply the fragment's alpha by the calculated dash-alpha\r\n  alpha *\x3d dashAlpha;\r\n\r\n  // output the fragment color\r\n  gl_FragColor \x3d vec4(u_color.rgb, alpha * u_color.a);\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineJoinShader.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform highp float u_depth;\r\nuniform highp vec2 u_screen;\r\nuniform mediump float u_size;\r\nuniform mediump float u_pixelRatio;\r\n\r\nvarying mediump vec2 v_vertexPosition;\r\n\r\nvoid main()\r\n{\r\n  gl_PointSize \x3d u_pixelRatio * u_size;\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\r\n\r\n  // calculate the vertex position in pixels (we need to add one in order to shift the origin from the center of the viewport)\r\n  v_vertexPosition \x3d (gl_Position.xy + 1.0) * u_screen;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineJoinShader.fs.glsl":"uniform lowp vec4 u_color;\r\nuniform mediump float u_lineHalfWidth;\r\nuniform mediump float u_oneOverPixelRatio;\r\n\r\nvarying mediump vec2 v_vertexPosition;\r\n\r\nvoid main()\r\n{\r\n  // get the distance of the current fragment from the actual vertex\r\n  mediump float fragDist \x3d length(v_vertexPosition - u_oneOverPixelRatio * gl_FragCoord.xy);\r\n\r\n  // rounding the quare: calculate the alpha given the difference between the line-width and the distance of the fragment\r\n  // from the center-line. We will end up with a nice round circle with a soft edge.\r\n  lowp float alpha \x3d clamp(u_lineHalfWidth - fragDist, 0.0, 1.0);\r\n\r\n  // finally output the fragment color\r\n  gl_FragColor \x3d vec4(u_color.rgb, alpha * u_color.a);\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/solidFillShader.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\n\r\nvoid main()\r\n{\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0, 1.0);\r\n}\r\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/solidFillShader.fs.glsl":"uniform lowp vec4 u_color;\r\nvoid main()\r\n{\r\n  gl_FragColor \x3d u_color;\r\n}",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/fillOutlineShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_offset;\r\nattribute vec2 a_xnormal;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform highp mat4 u_extrudeMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\nuniform mediump float u_outline_width;\r\n\r\nvarying lowp vec2 v_normal;\r\n\r\nconst float scale \x3d 1.0 / 15.0;\r\n\r\nvoid main()\r\n{\r\n  v_normal \x3d a_xnormal;\r\n\r\n   // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\r\n    // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\r\n  mediump vec4 dist \x3d vec4(u_outline_width * a_offset * scale, 0.0, 0.0);\r\n\r\n  // Remove the texture normal bit of the position before scaling it with the\r\n  // model/view matrix. Add the extrusion vector *after* the model/view matrix\r\n  // because we're extruding the line in pixel space, regardless of the current\r\n  // tile's zoom level.\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * dist;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/fillOutlineShader.fs.glsl":"uniform lowp vec4 u_color;\r\nvarying mediump vec2 v_normal;\r\n\r\nvoid main()\r\n{\r\n  // Calculate the distance of the pixel from the line in pixels.\r\n  lowp float dist \x3d abs(v_normal.y);\r\n\r\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\r\n  gl_FragColor \x3d vec4(u_color.rgb, u_color.a * alpha);\r\n}\r\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/iconShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_vertexOffset;\r\nattribute vec4 a_tex;\r\nattribute vec4 a_levelInfo;\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the size of the mosaic given in pixels\r\nuniform vec2 u_mosaicSize;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the map's rotation from the north\r\nuniform mediump float u_mapRotation;\r\nuniform mediump float u_level;\r\n// indicate whether the current set of iconst should be kept upright when the map is rotated\r\nuniform lowp float u_keepUpright;\r\n// the rate of the change in the opacity (fade) of the icons\r\nuniform mediump float u_fadeSpeed;\r\n// the low level we transition (to/from)\r\nuniform mediump float u_minfadeLevel;\r\n// the high level we transition (to/from)\r\nuniform mediump float u_maxfadeLevel;\r\n// the amount of fade given teh current time past the last recorded level\r\nuniform mediump float u_fadeChange;\r\n// the opacity of the layer given by the painter\r\nuniform mediump float u_opacity;\r\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\r\nvarying lowp vec2 v_tex;\r\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\r\n// opacity of the layer given by the painter\r\nvarying lowp float v_transparency;\r\n\r\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\r\n// by 16 and then at the shader devide by the same number\r\nconst float offsetPrecision \x3d 1.0 / 32.0;\r\n\r\nvoid main()\r\n{\r\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\r\n  mediump float a_angle        \x3d a_levelInfo[1];\r\n  mediump float a_minLevel    \x3d a_levelInfo[2];\r\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\r\n\r\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\r\n  mediump float delta_z \x3d 0.0;\r\n\r\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\r\n  mediump float rotated \x3d mod(a_angle - u_mapRotation, 256.0);\r\n  delta_z +\x3d (1.0 - step(u_keepUpright,0.0)) * step(65.0,rotated) * (1.0 - step(193.0,rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (65 \x3c\x3d rotated) \x26\x26 (rotated \x3c 193)\r\n\r\n  // u_level is the current service level adjusted for the change in font size\r\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\r\n  delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\r\n\r\n  // calculate the alpha given the change in the fade and the fade-speed\r\n  lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\r\n\r\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\r\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\r\n\r\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\r\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 0.0;\r\n  }\r\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 1.0;\r\n  }\r\n\r\n  // if label had been faded out, clip it\r\n  delta_z +\x3d step(v_transparency, 0.0);\r\n\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\r\n  v_tex \x3d a_tex.xy / u_mosaicSize;\r\n\r\n  v_transparency *\x3d u_opacity;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/iconShader.fs.glsl":"uniform lowp sampler2D u_texture;\r\nvarying lowp vec2 v_tex;\r\nvarying lowp float v_transparency;\r\n\r\nvoid main()\r\n{\r\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\r\n  gl_FragColor \x3d vec4(color.rgb, v_transparency * color.a);\r\n}\r\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/sdfShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_vertexOffset;\r\nattribute vec4 a_tex;\r\nattribute vec4 a_levelInfo;\r\n\r\n// attribute bool a_visible; // --\x3e a one bit controlling the visibility of the vertex\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the size of the mosaic given in pixels\r\nuniform vec2 u_mosaicSize;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the map's rotation from the north\r\nuniform mediump float u_mapRotation;\r\nuniform mediump float u_level;\r\n// indicate whether the current set of iconst should be kept upright when the map is rotated\r\nuniform lowp float u_keepUpright;\r\n// the rate of the change in the opacity (fade) of the icons\r\nuniform mediump float u_fadeSpeed;\r\n// the low level we transition (to/from)\r\nuniform mediump float u_minfadeLevel;\r\n// the high level we transition (to/from)\r\nuniform mediump float u_maxfadeLevel;\r\n// the amount of fade given teh current time past the last recorded level\r\nuniform mediump float u_fadeChange;\r\n// the opacity of the layer given by the painter\r\nuniform mediump float u_opacity;\r\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\r\nvarying lowp vec2 v_tex;\r\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\r\n// opacity of the layer given by the painter\r\nvarying lowp float v_transparency;\r\n\r\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\r\n// by 16 and then at the shader devide by the same number\r\nconst float offsetPrecision \x3d 1.0 / 32.0;\r\n\r\nvoid main()\r\n{\r\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\r\n  mediump float a_angle        \x3d a_levelInfo[1];\r\n  mediump float a_minLevel    \x3d a_levelInfo[2];\r\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\r\n\r\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\r\n  mediump float delta_z \x3d 0.0;\r\n\r\n  // TODO: force clipping the vertex in case that the vertex isn't visible\r\n  //delta_z +\x3d a_visible ? 0.0 : 1.0;\r\n\r\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\r\n  mediump float rotated \x3d mod(a_angle - u_mapRotation, 256.0);\r\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(65.0, rotated) * (1.0 - step(193.0, rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (65 \x3c\x3d rotated) \x26\x26 (rotated \x3c 193)\r\n\r\n  // u_level is the current service level adjusted for the change in font size\r\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\r\n  delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\r\n\r\n  // calculate the alpha given the change in the fade and the fade-speed\r\n  lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\r\n\r\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\r\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\r\n\r\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\r\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 0.0;\r\n  }\r\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 1.0;\r\n  }\r\n\r\n  // if label has been faded out, clip it\r\n  delta_z +\x3d step(v_transparency, 0.0);\r\n\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\r\n  v_tex \x3d a_tex.xy / u_mosaicSize;\r\n\r\n  v_transparency *\x3d u_opacity;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/sdfShader.fs.glsl":"uniform lowp sampler2D u_texture;\r\nuniform lowp vec4 u_color;\r\nuniform mediump float u_edgeDistance;\r\nuniform mediump float u_edgeWidth;\r\n\r\nvarying lowp vec2 v_tex;\r\nvarying lowp float v_transparency;\r\n\r\n// this is taken from http://www.valvesoftware.com/publications/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\r\n// and https://www.mapbox.com/blog/text-signed-distance-fields/\r\n// http://metalbyexample.com/rendering-text-in-metal-with-signed-distance-fields/\r\n\r\nvoid main()\r\n{\r\n  // read the distance from the SDF texture\r\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\r\n  // use a smooth-step in order to calculate the geometry of the shape given by the distance field\r\n  mediump float alpha \x3d smoothstep(u_edgeDistance - u_edgeWidth, u_edgeDistance + u_edgeWidth, dist) * v_transparency;\r\n\r\n  gl_FragColor \x3d vec4(u_color.rgb, alpha* u_color.a);\r\n\r\n// YF: this code allow having both a fill and an outline colors combined in a single pass\r\n//  lowp float geometryAlpha \x3d smoothstep(0.75 - 0.21, 0.75 + 0.21, dist) * v_transparency;\r\n//  lowp vec4 geometryColor \x3d vec4(u_color.rgb, geometryAlpha * u_color.a);\r\n//\r\n//  if (true) {\r\n//    lowp float haloAlpha \x3d smoothstep(0.0 - 0.1, 0.0 + 0.1, dist) * v_transparency;\r\n//    lowp vec4 haloColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n//    haloColor \x3d vec4(haloColor.rgb, haloAlpha);\r\n//\r\n//    // calculate the composite color\r\n//    lowp float compositeAlpha \x3d geometryColor.a + haloColor.a * (1.0 - geometryColor.a);\r\n//    lowp vec3 compositeColor \x3d vec3(geometryColor) * geometryColor.a + vec3(haloColor) * haloColor.a * (1.0 - geometryColor.a);\r\n//    compositeColor /\x3d compositeAlpha;\r\n//    gl_FragColor \x3d vec4(compositeColor, compositeAlpha);\r\n//  }\r\n//  else {\r\n//    gl_FragColor \x3d geometryColor;\r\n//  }\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/tileInfo.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform mediump vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\nuniform mediump float u_coord_ratio;\r\nuniform mediump vec2 u_delta; // in tile coordinates\r\nuniform mediump vec2 u_dimensions; // in tile coordinates\r\n\r\nvarying mediump vec2 v_tex;\r\n\r\nvoid main() {\r\n  mediump vec2 offests \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\r\n\r\n  v_tex \x3d a_pos;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/tileInfo.fs.glsl":"uniform mediump sampler2D u_texture;\r\nvarying mediump vec2 v_tex;\r\n\r\nvoid main(void) {\r\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\r\n  gl_FragColor \x3d vec4(color.rgb, color.a * 0.75);\r\n}\r\n","url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\r\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\r\n\t${!actionBarTemplate}\r\n\x3c/div\x3e\r\n\r\n',
"url:dijit/form/templates/Button.html":'\x3cspan class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" role\x3d"presentation"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\ttabIndex\x3d"-1" aria-hidden\x3d"true" data-dojo-attach-point\x3d"valueNode"\r\n/\x3e\x3c/span\x3e\r\n',
"url:dijit/form/templates/TextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Tooltip.html":'\x3cdiv class\x3d"dijitTooltip dijitTooltipLeft" id\x3d"dojoTooltip" data-dojo-attach-event\x3d"mouseenter:onMouseEnter,mouseleave:onMouseLeave"\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipConnector" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipContainer dijitTooltipContents" data-dojo-attach-point\x3d"containerNode" role\x3d\'alert\'\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:dijit/form/templates/ValidationTextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"*now":function(k){k(['dojo/i18n!*preload*esri/layers/nls/VectorTileLayerImpl*["ar","az","ca","cs","da","de-de","el","en-gb","en-us","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ro","ru","sk","sl","sv","th","tr","zh-tw","zh-cn","ROOT"]'])},"*noref":1}});
define("esri/layers/VectorTileLayerImpl","dojo/_base/lang dojo/has dojo/dom-construct dojo/dom-style dojo/io-query ../geometry/Extent ../geometry/screenUtils ../geometry/scaleUtils ../SpatialReference ../config ../lang ../domUtils ../urlUtils ../kernel ./layer ./TileInfo ./unitBezier ./vectorTiles/request ./vectorTiles/core/promiseUtils ./vectorTiles/core/urlUtils ./vectorTiles/layers/support/vectorTileLayerLoader ./vectorTiles/views/vectorTiles/style/StyleRepository ./vectorTiles/views/vectorTiles/VectorTileContainer ./vectorTiles/views/vectorTiles/TileHandler ./vectorTiles/views/2d/engine/StageGL ./vectorTiles/views/2d/FrameBudget ./vectorTiles/views/2d/layers/support/TileInfoView ./vectorTiles/views/2d/layers/support/TileStrategy ./vectorTiles/views/2d/layers/support/TileKey ./vectorTiles/views/webgl/webgl-utils".split(" "),function(k,
g,a,b,c,d,e,f,h,m,l,n,p,s,r,q,t,x,u,w,v,y,z,A,C,F,G,J,E,H){var N=t.ease;e=r.createSubclass({declaredClass:"esri.layers.VectorTileLayer",_mapsWithAttribution:["World_Basemap"],_eventMap:{"style-change":["style"]},constructor:function(a,b){this._frame=this._frame.bind(this);this._params=b||{};b&&(b.tileServers&&b.tileServers.length)&&(this.tileServers=b.tileServers=b.tileServers.map(function(a){return p.getAbsoluteUrl(a)},this));this._viewState={scale:0,width:0,height:0,rotation:0,resolution:1,center:[0,
0],toScreen:function(a,b){var c=this.center[1]+0.5*this.resolution*this.height;a[0]=(b[0]-(this.center[0]-0.5*this.resolution*this.width))/this.resolution;a[1]=(c-b[1])/this.resolution;return a},toMap:function(a,b){var c=this.center[1]+0.5*this.resolution*this.height;a[0]=this.center[0]-0.5*this.resolution*this.width+b[0]*this.resolution;a[1]=c-b[1]*this.resolution;return a}};this._budget=new F(6);this._renderParameters={budget:this._budget,state:this._viewState,devicePixelRatio:window.devicePixelRatio,
stationary:!0};this._updateParameters={budget:this._budget,state:this._viewState,devicePixelRatio:window.devicePixelRatio,stationary:!0};this.setStyle(a);this.registerConnectEvents()},setStyle:function(a){return this.loadStyle(a)},getStyle:function(){return this.currentStyleInfo&&this.currentStyleInfo.style||null},opacity:1,setOpacity:function(a){if(this.opacity!=a)this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_pinching:!1,_refreshTS:null,_reCheckTS:/[\?\&]_ts=/ig,_reReplaceTS:/([\?\&]_ts=)[0-9]+/ig,
addTimestampToURL:function(a){var b=this._refreshTS;b&&(a=this._reCheckTS.test(a)?a.replace(this._reReplaceTS,"$$$1"+b):a+((-1===a.indexOf("?")?"?":"\x26")+"_ts\x3d"+b));return a},getTileUrl:function(a,b,d){var e=this._getToken(),f=this._url.query,g=this.tileServers[b%this.tileServers.length],g=g.replace(/\{z\}/gi,a.toString()).replace(/\{level\}/gi,a.toString()).replace(/\{y\}/gi,b.toString()).replace(/\{row\}/gi,b.toString()).replace(/\{x\}/gi,d.toString()).replace(/\{col\}/gi,d.toString());f&&
(g+="?"+c.objectToQuery(f));if(e&&(!f||!f.token))g+=(-1===g.indexOf("?")?"?":"\x26")+"token\x3d"+e;g=this.addTimestampToURL(g);return p.addProxy(g)},loadStyle:function(a){if(this._loadingPromise&&"string"===typeof a&&this.url===a)return this._loadingPromise;this._stopDisplay();var b=this._loadingPromise;this._loadingPromise=v.loadMetadata(a).then(function(a){this.url=a.url;this._url=a.parsedUrl;this.currentStyleInfo={serviceUrl:a.serviceUrl,styleUrl:a.styleUrl,style:a.style,layerDefinition:a.layerDefinition};
this.styleRepository=new y(a.style,a.styleUrl);this._read(a.layerDefinition);this.onStyleChange(this.getStyle())}.bind(this)).then(function(){this.loaded||(this.loaded=!0,this.onLoad(this));!this.suspended&&!this._tileHandler&&this._startDisplay()}.bind(this)).otherwise(function(a){this._errorHandler(a);throw a;}.bind(this));b&&!b.isFulfilled()&&b.cancel();return this._loadingPromise},refresh:function(){this.suspended||(this._refreshTS=Date.now(),this._onExtentChangeHandler(this._map.extent,null,
!0,this._map.__LOD))},_setMap:function(c,d,e){this.inherited(arguments);this._map=c;var f=this._div=a.create("div",null,d);b.set(f,{position:"absolute",width:c.width+"px",height:c.height+"px",overflow:"visible",opacity:this.opacity});this._onResizeHandle=c.on("resize",k.hitch(this,this._onResizeHandler));this._onOpacityHandle=this.on("opacity-change",k.hitch(this,this._opacityChangeHandler));this._onScaleVisHandle=this.on("scale-visibility-change",k.hitch(this,function(){}));this._onVisibilityHandle=
this.on("visibility-change",k.hitch(this,function(){}));this._stageGL=new C;this._div.appendChild(this._stageGL.createElement());this._stageGL.parent={requestChildRender:this._scheduleRender.bind(this)};this._stageGL.attach(this._renderParameters);this._startDisplay();this.evaluateSuspension();if(this.suspended&&!c.loaded)var g=c.on("load",k.hitch(this,function(){g.remove();this.evaluateSuspension()}));return f},_unsetMap:function(b,c){this._map=null;this.suspended||this._stopDisplay();this._stageGL.detach(this._renderParameters);
this._stageGL=null;a.destroy(this._div);this._div=null;this._handles&&this._handles.forEach(function(a){a.remove()});this._handles=null;this._onResizeHandle=this._onResizeHandle&&this._onResizeHandle.remove()&&null;this._onOpacityHandle=this._onOpacityHandle&&this._onOpacityHandle.remove()&&null;this._onScaleVisHandle=this._onScaleVisHandle&&this._onScaleVisHandle.remove()&&null;this._onVisibilityHandle=this._onVisibilityHandle&&this._onVisibilityHandle.remove()&&null;this.inherited(arguments)},_read:function(a){this.version=
a.currentVersion||a.version;this.fullExtent=new d(a.fullExtent);this.initialExtent=new d(a.initialExtent);this.spatialReference=this.fullExtent.spatialReference;this.tileInfo=new q(a.tileInfo);this.tileInfo.size=[this.tileInfo.cols,this.tileInfo.height];this.tileInfo.spatialReference.isWrappable=this.tileInfo.spatialReference._isWrappable();this.tileInfo.scales=this.tileInfo.lods.map(function(a){return a.scale});this.tileInfo.scaleToZoom=function(a){for(var b=this.scales,c=b.length-1,d=0;d<c;d++){var e=
b[d],f=b[d+1];if(e<=a)break;if(f===a)return d+1;if(e>a&&f<a)return d+1-(a-f)/(e-f)}return d};this._hasMin||this.setMinScale(a.minScale);this._hasMax||this.setMaxScale(a.maxScale);a.tileMap&&(this.tileIndexUrl=w.join(this.currentStyleInfo.serviceUrl,a.tileMap));this._params.tileServers||(this.tileServers=a.tiles.map(function(a,b,c){return w.join(this.currentStyleInfo.serviceUrl,a)},this));a=null;this.currentStyleInfo.serviceUrl&&(a=w.urlToObject(this.currentStyleInfo.serviceUrl),a=this._getDefaultAttribution(a.path));
a?(this.attributionDataUrl=a,this.hasAttributionData=!0):(this.attributionDataUrl=null,this.hasAttributionData=!1)},_getDefaultAttribution:function(a){var b=a.match(/^https?:\/\/(basemaps|basemapsbeta)\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);if(b&&(a=b[3])){var b=b[2]||"",c;a=a.toLowerCase();for(var d=0,e=this._mapsWithAttribution.length;d<e;d++)if(c=this._mapsWithAttribution[d],-1<c.toLowerCase().indexOf(a))return a=window.location.protocol,("http:"===
a||"https:"===a?a:"https:")+"//static.arcgis.com/attribution/Vector"+b+"/"+c}},_startDisplay:function(){var a={styleRepository:this.styleRepository,tileIndexUrl:this.tileIndexUrl,tileInfo:this.tileInfo,fullExtent:{width:this.fullExtent.getWidth()},getTileUrl:this.getTileUrl.bind(this)};this._renderParameters.devicePixelRatio=this._updateParameters.devicePixelRatio=window.devicePixelRatio;this._vectorTileContainer=new z;this._stageGL.addChild(this._vectorTileContainer);this._tileHandler=new A(a,this._scheduleUpdate.bind(this));
this._tileInfoView=new G(this.tileInfo,this.fullExtent);this._tileStrategy=new J(this._vectorTileContainer,this._tileInfoView,this._scheduleUpdate.bind(this),function(a,b){return this._tileHandler.getVectorTile(E.fromId(a),b)}.bind(this));this._tileHandler.updateTile.bind(this._tileHandler);this._tileHandler.start().then(function(){this._vectorTileContainer.initialize(this._tileHandler.spriteMosaic,this._tileHandler.glyphMosaic,this.tileInfo,this._tileInfoView);this._scheduleUpdate()}.bind(this))},
_stopDisplay:function(){this._tileStrategy&&(this._frameRequested=this._updateRequested=this._renderRequested=!1,this._animation&&(this._animation.stop(),this._animation=null),this._vectorTileContainer.removeAllChildren(),this._stageGL.removeChild(this._vectorTileContainer),this._vectorTileContainer=null,this._tileHandler.stop(),this._tileHandler.destroy(),this._tileStrategy.destroy(),this._tileInfoView=this._tileHandler=this._tileStrategy=null)},_scheduleRender:function(){this._map&&(this._renderRequested=
!0,this._scheduleFrame())},_scheduleUpdate:function(){this._map&&(this._updateRequested=!0,this._scheduleFrame())},_scheduleFrame:function(){this._map&&!this._frameRequested&&(this._frameRequested=!0,D(this._frame))},_frame:function(){if(this._frameRequested){this._frameRequested=!1;this._renderParameters.devicePixelRatio!==window.devicePixelRatio&&(this._renderParameters.devicePixelRatio=this._updateParameters.devicePixelRatio=window.devicePixelRatio,this._stopDisplay(),this._startDisplay());this._animation&&
(this._animation.step(),this._animation.running||(this._animation=null));this._updateParameters.stationary=this._renderParameters.stationary=!this._animation&&!this._pinching&&!this._panning;this._budget.reset();this._viewState.resolution=this._viewState.scale/(96*39.37*f.getUnitValueForSR(this.spatialReference));this._renderRequested&&(this._renderRequested=!1,this._stageGL.render(this._renderParameters));if(this._updateRequested){this._updateRequested=!1;var a=this._tileHandler.updateTile.bind(this._tileHandler);
this._tileStrategy.updateTiles(a,this._updateParameters);this._tileStrategy.update(this._updateParameters)}this._animation&&(this._scheduleRender(),this._scheduleUpdate())}},_setViewState:function(a){a=k.mixin(this._viewState,a);a.center.type&&(a.center=[a.center.x,a.center.y]);this._scheduleRender();this._scheduleUpdate()},_animateViewState:function(a,b){var c=b.immediate||0===m.defaults.map.zoomDuration;this._animation=null;if(c)this._setViewState(a);else{var c=this._viewState,d=m.defaults.map.zoomDuration,
e=L()+16,f=c.center[0],g=c.center[1],h=c.scale,k=Array.isArray(a.center)?a.center[0]:a.center.x,l=Array.isArray(a.center)?a.center[1]:a.center.y,n=a.scale||c.scale,p=this;this._animation={running:!0,stop:function(){this.running=!1},step:function(){if(this.running){var a=(L()+16-e)/d;1<=a&&(a=1,this.running=!1);a=N(a);p._setViewState({center:[f+(k-f)*a,g+(l-g)*a],scale:h+(n-h)*a})}}};this._scheduleRender();this._scheduleUpdate()}},onStyleChange:function(a){},_opacityChangeHandler:function(a){this._div&&
(this._div.style.opacity=a.opacity)},_onResizeHandler:function(a){var b=this._div&&this._div.style;b&&(b.width=a.width+"px",b.height=a.height+"px",this._setViewState({center:a.extent.getCenter(),width:a.width,height:a.height}))},onResume:function(){var a=this._map;this.inherited(arguments);n.show(this._div);this._setViewState({center:a.extent.getCenter(),scale:a.getScale(),width:a.width,height:a.height});this._handles=[a.on("pan-end",k.hitch(this,function(){this._panning=!1})),a.on("pan",k.hitch(this,
this._onPanExtentChangeHandler)),a.on("extent-change",k.hitch(this,this._onExtentChangeHandler)),a.on("scale",k.hitch(this,this._onScaleHandler))]},onSuspend:function(){this.inherited(arguments);n.hide(this._div);this._handles.forEach(function(a){a.remove()});this._handles=null},_onPanExtentChangeHandler:function(a){this._panning=!0;this._animation&&(this._animation.stop(),this._animation=null);this._setViewState({center:a.extent.getCenter(),scale:this._map.getScale()})},_onExtentChangeHandler:function(a){var b=
this._pinching||a.immediate;this._animateViewState({center:a.extent.getCenter(),scale:a.lod.scale},{immediate:b});this._pinching=!1},_onScaleHandler:function(a){this._animation&&(this._animation.stop(),this._animation=null);var b=this._map;if(b._zoomAnimDiv.extent)this._pinching=this._panning=!1,this._animateViewState({center:b._zoomAnimDiv.extent.getCenter(),scale:b._zoomAnimDiv.newLod.scale},{immediate:a.immediate});else{var c=b.navigationManager,d=c._dragOrigin;a=b.extent.getCenter();var e=d.x-
0.5*b.width,d=d.y-0.5*b.height,f=b.extent.getWidth()/b.width,g;c._pinchScale?(this._pinching=!0,c=c._pinchScale,g=f/c,a.x-=e*(g-f),a.y+=d*(g-f),b=b.__LOD.scale/c,this._setViewState({center:a,scale:b})):c._zoomEndExtent&&(this._pinching=!1,c=b.getScale()/b.navigationManager._zoomEndLod.scale,g=f/c,a.x-=e*(g-f),a.y+=d*(g-f),b=b.navigationManager._zoomEndLod.scale,this._animateViewState({center:a,scale:b},{immediate:!1}))}}});e.ACCESS_TOKEN=null;e.supported=function(){return H.detectWebGL()[0]};var L=
function(){var a,b=window.performance||{},c=b.now||b.webkitNow||b.msNow||b.oNow||b.mozNow;if(void 0!==c)return function(){return c.call(b)};a=window.performance&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.timing.navigationStart:(new Date).getTime();return function(){return(new Date).getTime()-a}}();h=g("ff");l=g("ie");s=g("webkit");g=g("opera");var I=(new Date).getTime(),D=window.requestAnimationFrame;D||(D=window[(s&&"webkit"||h&&"moz"||g&&"o"||l&&"ms")+
"RequestAnimationFrame"])||(D=function(a){var b=L(),c=Math.max(0,16-(b-I)),d=window.setTimeout(function(){a(L())},c);I=b+c;return d});return e});