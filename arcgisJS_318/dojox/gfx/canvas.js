//>>built
require({cache:{"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(e,s,l,r,u,h,k,d,c,b){var n=e.shape={};n.Shape=l("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(u("gfxRegistry")){var a=n.register(this);this.getUID=function(){return a}}},
destroy:function(){u("gfxRegistry")&&n.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();
if(!a)return null;var c=this._getRealMatrix();return[b.multiplyPoint(c,a.x,a.y),b.multiplyPoint(c,a.x+a.width,a.y),b.multiplyPoint(c,a.x+a.width,a.y+a.height),b.multiplyPoint(c,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=e.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in
a)switch(a.type){case "linear":b=e.makeParameters(e.defaultLinearGradient,a);break;case "radial":b=e.makeParameters(e.defaultRadialGradient,a);break;case "pattern":b=e.makeParameters(e.defaultPattern,a)}else b=e.normalizeColor(a);this.fillStyle=b;return this},setStroke:function(a){if(!a)return this.strokeStyle=null,this;if("string"==typeof a||s.isArray(a)||a instanceof c)a={color:a};a=this.strokeStyle=e.makeParameters(e.defaultStroke,a);a.color=e.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=
b.clone(a?b.normalize(a):b.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,
this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&this.parent.remove(this,a);return this},_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},_updateParentMatrix:function(a){this.parentMatrix=a?b.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,c=this.parent;c;)c.matrix&&(a=b.multiply(c.matrix,a)),c=c.parent;return a}});n._eventsProcessing={on:function(a,
b){return h(this.getEventSource(),a,n.fixCallback(this,e.fixTarget,b))},connect:function(a,b,c){"on"==a.substring(0,2)&&(a=a.substring(2));return this.on(a,c?s.hitch(b,c):b)},disconnect:function(a){return a.remove()}};n.fixCallback=function(a,b,c,d){d||(d=c,c=null);if(s.isString(d)){c=c||r.global;if(!c[d])throw['dojox.gfx.shape.fixCallback: scope["',d,'"] is null (scope\x3d"',c,'")'].join("");return function(k){return b(k,a)?c[d].apply(c,arguments||[]):void 0}}return!c?function(k){return b(k,a)?d.apply(c,
arguments):void 0}:function(k){return b(k,a)?d.apply(c,arguments||[]):void 0}};s.extend(n.Shape,n._eventsProcessing);n.Container={_init:function(){this.children=[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(a){var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,b){for(var c=0;c<this.children.length;++c)if(this.children[c]==a){b||(a.parent=null,a.parentMatrix=null);this.children.splice(c,
1);break}return this},clear:function(a){for(var b,c=0;c<this.children.length;++c)b=this.children[c],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=[];return this},getBoundingBox:function(){if(this.children){var a=null;k.forEach(this.children,function(c){var d=c.getBoundingBox();d&&((c=c.getTransform())&&(d=b.multiplyRectangle(c,d)),a?(a.x=Math.min(a.x,d.x),a.y=Math.min(a.y,d.y),a.endX=Math.max(a.endX,d.x+d.width),a.endY=Math.max(a.endY,d.y+d.height)):a={x:d.x,y:d.y,endX:d.x+d.width,
endY:d.y+d.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){this.children.splice(b,1);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){this.children.splice(b,1);this.children.unshift(a);break}return this}};n.Surface=l("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=
null;this._nodes=[];this._events=[]},destroy:function(){k.forEach(this._nodes,d.destroy);this._nodes=[];k.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;if(u("ie"))for(;this._parent.lastChild;)d.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(a,b){var c=s.hitch(a,b);if(this.isLoaded)c(this);
else h.once(this,"load",function(a){c(a)})}});s.extend(n.Surface,n._eventsProcessing);n.Rect=l("dojox.gfx.shape.Rect",n.Shape,{constructor:function(a){this.shape=e.getDefault("Rect");this.rawNode=a},getBoundingBox:function(){return this.shape}});n.Ellipse=l("dojox.gfx.shape.Ellipse",n.Shape,{constructor:function(a){this.shape=e.getDefault("Ellipse");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});
n.Circle=l("dojox.gfx.shape.Circle",n.Shape,{constructor:function(a){this.shape=e.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});n.Line=l("dojox.gfx.shape.Line",n.Shape,{constructor:function(a){this.shape=e.getDefault("Line");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-
a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});n.Polyline=l("dojox.gfx.shape.Polyline",n.Shape,{constructor:function(a){this.shape=e.getDefault("Polyline");this.rawNode=a},setShape:function(a,b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var c=[],d=0;d<b;d+=
2)c.push({x:a[d],y:a[d+1]});this.shape.points=c}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,c=a[0],d=c.x,k=c.y,n=c.x,h=c.y,e=1;e<b;++e)c=a[e],d>c.x&&(d=c.x),n<c.x&&(n=c.x),k>c.y&&(k=c.y),h<c.y&&(h=c.y);this.bbox={x:d,y:k,width:n-d,height:h-k}}return this.bbox}});n.Image=l("dojox.gfx.shape.Image",n.Shape,{constructor:function(a){this.shape=e.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},
setFill:function(){return this}});n.Text=l(n.Shape,{constructor:function(a){this.fontStyle=null;this.shape=e.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?e.splitFontString(a):e.makeParameters(e.defaultFont,a);this._setFont();return this},getBoundingBox:function(){var a=null;this.getShape().text&&(a=e._base._computeTextBoundingBox(this));return a}});n.Creator={createShape:function(a){switch(a.type){case e.defaultPath.type:return this.createPath(a);
case e.defaultRect.type:return this.createRect(a);case e.defaultCircle.type:return this.createCircle(a);case e.defaultEllipse.type:return this.createEllipse(a);case e.defaultLine.type:return this.createLine(a);case e.defaultPolyline.type:return this.createPolyline(a);case e.defaultImage.type:return this.createImage(a);case e.defaultText.type:return this.createText(a);case e.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(e.Group)},createRect:function(a){return this.createObject(e.Rect,
a)},createEllipse:function(a){return this.createObject(e.Ellipse,a)},createCircle:function(a){return this.createObject(e.Circle,a)},createLine:function(a){return this.createObject(e.Line,a)},createPolyline:function(a){return this.createObject(e.Polyline,a)},createImage:function(a){return this.createObject(e.Image,a)},createText:function(a){return this.createObject(e.Text,a)},createPath:function(a){return this.createObject(e.Path,a)},createTextPath:function(a){return this.createObject(e.TextPath,{}).setText(a)},
createObject:function(a,b){return null}};return n})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(e,s,l,r,u){u=l("dojox.gfx.path.Path",u.Shape,{constructor:function(h){this.shape=s.clone(e.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=h;this.segmented=!1},setAbsoluteMode:function(h){this._confirmSegmented();this.absolute="string"==typeof h?"absolute"==h:h;return this},getAbsoluteMode:function(){this._confirmSegmented();
return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var h=this.bbox,k=this._getRealMatrix();this.bbox=null;for(var d=0,c=this.segments.length;d<c;++d)this._updateWithSegment(this.segments[d],k);k=this.bbox;this.bbox=h;return this.tbbox=k?[{x:k.l,y:k.t},{x:k.r,y:k.t},{x:k.r,
y:k.b},{x:k.l,y:k.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(h,k,d){d&&(k=r.multiplyPoint(d,h,k),h=k.x,k=k.y);this.bbox&&"l"in this.bbox?(this.bbox.l>h&&(this.bbox.l=h),this.bbox.r<h&&(this.bbox.r=h),this.bbox.t>k&&(this.bbox.t=k),this.bbox.b<k&&(this.bbox.b=k)):this.bbox={l:h,b:k,r:h,t:k}},_updateWithSegment:function(h,k){var d=h.args,c=d.length,
b;switch(h.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(b=0;b<c;b+=2)this._updateBBox(d[b],d[b+1],k);this.last.x=d[c-2];this.last.y=d[c-1];this.absolute=!0;break;case "H":for(b=0;b<c;++b)this._updateBBox(d[b],this.last.y,k);this.last.x=d[c-1];this.absolute=!0;break;case "V":for(b=0;b<c;++b)this._updateBBox(this.last.x,d[b],k);this.last.y=d[c-1];this.absolute=!0;break;case "m":b=0;"x"in this.last||(this._updateBBox(this.last.x=d[0],this.last.y=d[1],k),b=2);for(;b<c;b+=2)this._updateBBox(this.last.x+=
d[b],this.last.y+=d[b+1],k);this.absolute=!1;break;case "l":case "t":for(b=0;b<c;b+=2)this._updateBBox(this.last.x+=d[b],this.last.y+=d[b+1],k);this.absolute=!1;break;case "h":for(b=0;b<c;++b)this._updateBBox(this.last.x+=d[b],this.last.y,k);this.absolute=!1;break;case "v":for(b=0;b<c;++b)this._updateBBox(this.last.x,this.last.y+=d[b],k);this.absolute=!1;break;case "c":for(b=0;b<c;b+=6)this._updateBBox(this.last.x+d[b],this.last.y+d[b+1],k),this._updateBBox(this.last.x+d[b+2],this.last.y+d[b+3],k),
this._updateBBox(this.last.x+=d[b+4],this.last.y+=d[b+5],k);this.absolute=!1;break;case "s":case "q":for(b=0;b<c;b+=4)this._updateBBox(this.last.x+d[b],this.last.y+d[b+1],k),this._updateBBox(this.last.x+=d[b+2],this.last.y+=d[b+3],k);this.absolute=!1;break;case "A":for(b=0;b<c;b+=7)this._updateBBox(d[b+5],d[b+6],k);this.last.x=d[c-2];this.last.y=d[c-1];this.absolute=!0;break;case "a":for(b=0;b<c;b+=7)this._updateBBox(this.last.x+=d[b+5],this.last.y+=d[b+6],k);this.absolute=!1}var n=[h.action];for(b=
0;b<c;++b)n.push(e.formatNumber(d[b],!0));if("string"==typeof this.shape.path)this.shape.path+=n.join("");else{b=0;for(c=n.length;b<c;++b)this.shape.path.push(n[b])}},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(h,k){this.tbbox=null;var d=this._validSegments[h.toLowerCase()];"number"==typeof d&&(d?k.length>=d&&(d={action:h,args:k.slice(0,k.length-k.length%d)},this.segments.push(d),this._updateWithSegment(d)):(d={action:h,args:[]},this.segments.push(d),this._updateWithSegment(d)))},
_collectArgs:function(h,k){for(var d=0;d<k.length;++d){var c=k[d];"boolean"==typeof c?h.push(c?1:0):"number"==typeof c?h.push(c):c instanceof Array?this._collectArgs(h,c):"x"in c&&"y"in c&&h.push(c.x,c.y)}},moveTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"M":"m",h);return this},lineTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"L":"l",h);return this},hLineTo:function(){this._confirmSegmented();
var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"H":"h",h);return this},vLineTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"V":"v",h);return this},curveTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"C":"c",h);return this},smoothCurveTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"S":
"s",h);return this},qCurveTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"Q":"q",h);return this},qSmoothCurveTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"T":"t",h);return this},arcTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"A":"a",h);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",
[]);return this},_confirmSegmented:function(){if(!this.segmented){var h=this.shape.path;this.shape.path=[];this._setPath(h);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(h){h=s.isArray(h)?h:h.match(e.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(h){for(var k="",d=[],c=h.length,b=0;b<c;++b){var n=h[b],a=parseFloat(n);isNaN(a)?(k&&this._pushSegment(k,d),d=[],k=n):d.push(a)}this._pushSegment(k,d)}},setShape:function(h){this.inherited(arguments,
["string"==typeof h?{path:h}:h]);this.segmented=!1;this.segments=[];e.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});l=l("dojox.gfx.path.TextPath",u,{constructor:function(h){"text"in this||(this.text=s.clone(e.defaultTextPath));"fontStyle"in this||(this.fontStyle=s.clone(e.defaultFont))},getText:function(){return this.text},setText:function(h){this.text=e.makeParameters(this.text,"string"==typeof h?{text:h}:h);this._setText();return this},getFont:function(){return this.fontStyle},
setFont:function(h){this.fontStyle="string"==typeof h?e.splitFontString(h):e.makeParameters(e.defaultFont,h);this._setFont();return this}});return e.path={Path:u,TextPath:l}})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],function(e,s,l){function r(b){var c=Math.cos(b);b=Math.sin(b);var a={x:c+4/3*(1-c),y:b-4/3*c*(1-c)/b};return{s:{x:c,y:-b},c1:{x:a.x,y:-a.y},c2:a,e:{x:c,y:b}}}var u=2*Math.PI,h=Math.PI/4,k=Math.PI/8,d=h+k,c=r(k);return e.arc={unitArcAsBezier:r,curvePI4:c,
arcAsBezier:function(b,n,a,e,w,z,t,q){w=Boolean(w);z=Boolean(z);var m=l._degToRad(e);e=n*n;var s=a*a,v=l.multiplyPoint(l.rotate(-m),{x:(b.x-t)/2,y:(b.y-q)/2}),y=v.x*v.x,A=v.y*v.y;e=Math.sqrt((e*s-e*A-s*y)/(e*A+s*y));isNaN(e)&&(e=0);e={x:e*n*v.y/a,y:-e*a*v.x/n};w==z&&(e={x:-e.x,y:-e.y});e=l.multiplyPoint([l.translate((b.x+t)/2,(b.y+q)/2),l.rotate(m)],e);n=l.normalize([l.translate(e.x,e.y),l.rotate(m),l.scale(n,a)]);e=l.invert(n);b=l.multiplyPoint(e,b);q=l.multiplyPoint(e,t,q);t=Math.atan2(b.y,b.x);
q=Math.atan2(q.y,q.x);e=t-q;z&&(e=-e);0>e?e+=u:e>u&&(e-=u);a=k;q=c;a=z?a:-a;b=[];for(w=e;0<w;w-=h)w<d&&(a=w/2,q=r(a),a=z?a:-a,w=0),v=l.normalize([n,l.rotate(t+a)]),z?(e=l.multiplyPoint(v,q.c1),m=l.multiplyPoint(v,q.c2),v=l.multiplyPoint(v,q.e)):(e=l.multiplyPoint(v,q.c2),m=l.multiplyPoint(v,q.c1),v=l.multiplyPoint(v,q.s)),b.push([e.x,e.y,m.x,m.y,v.x,v.y]),t+=2*a;return b}}})},"dojox/gfx/decompose":function(){define(["./_base","dojo/_base/lang","./matrix"],function(e,s,l){function r(c,b){return Math.abs(c-
b)<=1E-6*(Math.abs(c)+Math.abs(b))}function u(c,b,d,a){if(isFinite(c)){if(!isFinite(d))return c}else return d;b=Math.abs(b);a=Math.abs(a);return(b*c+a*d)/(b+a)}function h(c){c=l.normalize(c);var b=-c.xx-c.yy,d=c.xx*c.yy-c.xy*c.yx,a=Math.sqrt(b*b-4*d),b=-(b+(0>b?-a:a))/2,d=d/b,a=c.xy/(b-c.xx),k=1,e=c.xy/(d-c.xx),h=1;r(b,d)&&(a=1,e=k=0,h=1);isFinite(a)||(a=1,k=(b-c.xx)/c.xy,isFinite(k)||(a=(b-c.yy)/c.yx,k=1,isFinite(a)||(a=1,k=c.yx/(b-c.yy))));isFinite(e)||(e=1,h=(d-c.xx)/c.xy,isFinite(h)||(e=(d-c.yy)/
c.yx,h=1,isFinite(e)||(e=1,h=c.yx/(d-c.yy))));c=Math.sqrt(a*a+k*k);var t=Math.sqrt(e*e+h*h);if(!isFinite(a/=c))a=0;if(!isFinite(k/=c))k=0;if(!isFinite(e/=t))e=0;if(!isFinite(h/=t))h=0;return{value1:b,value2:d,vector1:{x:a,y:k},vector2:{x:e,y:h}}}function k(c,b){var d=0>c.xx*c.yy||0<c.xy*c.yx?-1:1,a=b.angle1=(Math.atan2(c.yx,c.yy)+Math.atan2(-d*c.xy,d*c.xx))/2,d=Math.cos(a),a=Math.sin(a);b.sx=u(c.xx/d,d,-c.xy/a,a);b.sy=u(c.yy/d,d,c.yx/a,a);return b}function d(c,b){var d=0>c.xx*c.yy||0<c.xy*c.yx?-1:
1,a=b.angle2=(Math.atan2(d*c.yx,d*c.xx)+Math.atan2(-c.xy,c.yy))/2,d=Math.cos(a),a=Math.sin(a);b.sx=u(c.xx/d,d,c.yx/a,a);b.sy=u(c.yy/d,d,-c.xy/a,a);return b}return e.decompose=function(c){var b=l.normalize(c);c={dx:b.dx,dy:b.dy,sx:1,sy:1,angle1:0,angle2:0};if(r(b.xy,0)&&r(b.yx,0))return s.mixin(c,{sx:b.xx,sy:b.yy});if(r(b.xx*b.yx,-b.xy*b.yy))return k(b,c);if(r(b.xx*b.xy,-b.yx*b.yy))return d(b,c);var e,a=new l.Matrix2D(b);e=s.mixin(a,{dx:0,dy:0,xy:a.yx,yx:a.xy});a=h([b,e]);e=h([e,b]);a=new l.Matrix2D({xx:a.vector1.x,
xy:a.vector2.x,yx:a.vector1.y,yy:a.vector2.y});e=new l.Matrix2D({xx:e.vector1.x,xy:e.vector1.y,yx:e.vector2.x,yy:e.vector2.y});b=new l.Matrix2D([l.invert(a),b,l.invert(e)]);k(e,c);b.xx*=c.sx;b.yy*=c.sy;d(a,c);b.xx*=c.sx;b.yy*=c.sy;return s.mixin(c,{sx:b.xx,sy:b.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(e){e=e.bezierutils={};e.tAtLength=function(k,d){var c=0,b=6==k.length,e=0,a=0,s=b?r:h,w=function(h,t){for(var q=0,m=0;m<h.length-2;m+=2)q+=l(h[m],h[m+1],h[m+2],h[m+3]);
m=b?l(k[0],k[1],k[4],k[5]):l(k[0],k[1],k[6],k[7]);q-m>t||e+q>d+t?(++a,q=s(h,0.5),w(q[0],t),Math.abs(e-d)<=t||w(q[1],t)):(e+=q,c+=1/(1<<a))};d&&w(k,0.5);return c};var s=e.computeLength=function(e){for(var d=6==e.length,c=0,b=0;b<e.length-2;b+=2)c+=l(e[b],e[b+1],e[b+2],e[b+3]);b=d?l(e[0],e[1],e[4],e[5]):l(e[0],e[1],e[6],e[7]);0.1<c-b&&(e=d?r(e,0.5):u(e,0.5),c=s(e[0],d),c+=s(e[1],d));return c},l=e.distance=function(e,d,c,b){return Math.sqrt((c-e)*(c-e)+(b-d)*(b-d))},r=function(e,d){var c=1-d,b=c*c,h=
d*d,a=e[0],l=e[1],r=e[2],s=e[3],t=e[4],q=e[5],m=b*a+2*c*d*r+h*t,b=b*l+2*c*d*s+h*q;return[[a,l,c*a+d*r,c*l+d*s,m,b],[m,b,c*r+d*t,c*s+d*q,t,q]]},u=function(e,d){var c=1-d,b=c*c,h=b*c,a=d*d,l=a*d,r=e[0],s=e[1],t=e[2],q=e[3],m=e[4],u=e[5],v=e[6],y=e[7],A=h*r+3*b*d*t+3*c*a*m+l*v,h=h*s+3*b*d*q+3*c*a*u+l*y;return[[r,s,c*r+d*t,c*s+d*q,b*r+2*c*d*t+a*m,b*s+2*c*d*q+a*u,A,h],[A,h,b*t+2*c*d*m+a*v,b*q+2*c*d*u+a*y,c*m+d*v,c*u+d*y,v,y]]},h=e.splitBezierAtT=function(e,d){return 6==e.length?r(e,d):u(e,d)};return e})},
"*noref":1}});
define("dojox/gfx/canvas","./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(e,s,l,r,u,h,k,d,c,b,n,a,H){function w(x,g,f,a,b,c,d,e,h,k){var m,l,n=g.length,q=0;k?(l=k.l/b,q=k.i):l=g[0]/b;for(;c<d;)c+l>d&&(m={l:(c+l-d)*b,i:q},l=d-c),q%2||(x.beginPath(),x.arc(f,a,b,c,c+l,e),h&&x.stroke()),c+=l,++q,l=g[q%n]/b;return m}function z(x,g,f,a){var b=0,c=0,d,e=0;a?(d=a.l,e=a.i):
d=g[0];for(;1>c;)c=H.tAtLength(x,d),1==c&&(b=H.computeLength(x),b={l:d-b,i:e}),x=H.splitBezierAtT(x,c),e%2||f.push(x[0]),x=x[1],++e,d=g[e%g.length];return b}function t(x,g,f,a){var b=[g.last.x,g.last.y].concat(f),c=!(x instanceof Array);f=4===f.length?"quadraticCurveTo":"bezierCurveTo";var d=[];g=z(b,g.canvasDash,d,a);for(a=0;a<d.length;++a)b=d[a],c?(x.moveTo(b[0],b[1]),x[f].apply(x,b.slice(2))):(x.push("moveTo",[b[0],b[1]]),x.push(f,b.slice(2)));return g}function q(a,g,f,b,c,d,e){var h=0,k=0,l=0,
m=H.distance(f,b,c,d),q=0;g=g.canvasDash;var n=f,r=b,s,t=!(a instanceof Array);e?(l=e.l,q=e.i):l+=g[0];for(;0.01<Math.abs(1-k);)l>m&&(h={l:l-m,i:q},l=m),k=l/m,e=f+(c-f)*k,s=b+(d-b)*k,q++%2||(t?(a.moveTo(n,r),a.lineTo(e,s)):(a.push("moveTo",[n,r]),a.push("lineTo",[e,s]))),n=e,r=s,l+=g[q%g.length];return h}var m=e.canvas={},D=null,v=n.multiplyPoint,y=Math.PI,A=2*y,B=y/2;a=s.extend;if(u.global.CanvasRenderingContext2D){u=u.doc.createElement("canvas").getContext("2d");var G="function"==typeof u.setLineDash,
K="function"==typeof u.fillText}var J={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};m.Shape=r("dojox.gfx.canvas.Shape",d.Shape,{_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);this._renderShape(a);this._renderFill(a,!0);this._renderStroke(a,!0);a.restore()},_renderClip:function(a){this.canvasClip&&(this.canvasClip.render(a),
a.clip())},_renderTransform:function(a){if("canvasTransform"in this){var g=this.canvasTransform;a.translate(g.dx,g.dy);a.rotate(g.angle2);a.scale(g.sx,g.sy);a.rotate(g.angle1)}},_renderShape:function(a){},_renderFill:function(a,g){if("canvasFill"in this){var f=this.fillStyle;if("canvasFillImage"in this){var b=f.width,c=f.height,d=this.canvasFillImage.width,e=this.canvasFillImage.height,h=Math.min(b==d?1:b/d,c==e?1:c/e),k=(b-h*d)/2,l=(c-h*e)/2;D.width=b;D.height=c;var m=D.getContext("2d");m.clearRect(0,
0,b,c);m.drawImage(this.canvasFillImage,0,0,d,e,k,l,h*d,h*e);this.canvasFill=a.createPattern(D,"repeat");delete this.canvasFillImage}a.fillStyle=this.canvasFill;g&&("pattern"===f.type&&(0!==f.x||0!==f.y)&&a.translate(f.x,f.y),a.fill())}else a.fillStyle="rgba(0,0,0,0.0)"},_renderStroke:function(a,g){var f=this.strokeStyle;f?(a.strokeStyle=f.color.toString(),a.lineWidth=f.width,a.lineCap=f.cap,"number"==typeof f.join?(a.lineJoin="miter",a.miterLimit=f.join):a.lineJoin=f.join,this.canvasDash?G?(a.setLineDash(this.canvasDash),
g&&a.stroke()):this._renderDashedStroke(a,g):g&&a.stroke()):g||(a.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(a,g){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,setClip:function(a){this.inherited(arguments);var g=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&!g)return this;this.canvasClip=a?L(g,a):null;this.parent&&this.parent._makeDirty();return this}});var L=
function(a,g){switch(a){case "ellipse":return{canvasEllipse:I({shape:g}),render:function(a){return m.Ellipse.prototype._renderShape.call(this,a)}};case "rect":return{shape:s.delegate(g,{r:0}),render:function(a){return m.Rect.prototype._renderShape.call(this,a)}};case "path":return{canvasPath:M(g),render:function(a){this.canvasPath._renderShape(a)}};case "polyline":return{canvasPolyline:g.points,render:function(a){return m.Polyline.prototype._renderShape.call(this,a)}}}return null},M=function(a){var g=
new dojox.gfx.canvas.Path;g.canvasPath=[];g._setPath(a.d);return g},E=function(a,g,f){var b=a.prototype[g];a.prototype[g]=f?function(){this.parent&&this.parent._makeDirty();b.apply(this,arguments);f.call(this);return this}:function(){this.parent&&this.parent._makeDirty();return b.apply(this,arguments)}};E(m.Shape,"setTransform",function(){this.matrix?this.canvasTransform=e.decompose(this.matrix):delete this.canvasTransform});E(m.Shape,"setFill",function(){var a=this.fillStyle,g;if(a){if("object"==
typeof a&&"type"in a){var f=this.surface.rawNode.getContext("2d");switch(a.type){case "linear":case "radial":g="linear"==a.type?f.createLinearGradient(a.x1,a.y1,a.x2,a.y2):f.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.r);l.forEach(a.colors,function(a){g.addColorStop(a.offset,e.normalizeColor(a.color).toString())});break;case "pattern":D||(D=document.createElement("canvas")),f=new Image,this.surface.downloadImage(f,a.src),this.canvasFillImage=f}}else g=a.toString();this.canvasFill=g}else delete this.canvasFill});
E(m.Shape,"setStroke",function(){var a=this.strokeStyle;if(a){var g=this.strokeStyle.style.toLowerCase();g in J&&(g=J[g]);if(g instanceof Array){this.canvasDash=g=g.slice();var f;for(f=0;f<g.length;++f)g[f]*=a.width;if("butt"!=a.cap){for(f=0;f<g.length;f+=2)g[f]-=a.width,1>g[f]&&(g[f]=1);for(f=1;f<g.length;f+=2)g[f]+=a.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!G&&!!this.canvasDash});E(m.Shape,"setShape");m.Group=r("dojox.gfx.canvas.Group",m.Shape,{constructor:function(){d.Container._init.call(this)},
_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);for(var g=0;g<this.children.length;++g)this.children[g]._render(a);a.restore()},destroy:function(){d.Container.clear.call(this,!0);m.Shape.prototype.destroy.apply(this,arguments)}});m.Rect=r("dojox.gfx.canvas.Rect",[m.Shape,d.Rect],{_renderShape:function(a){var g=this.shape,f=Math.min(g.r,g.height/2,g.width/2),b=g.x,c=b+g.width,d=g.y,g=d+g.height,e=b+f,h=c-f,k=d+f,l=g-f;a.beginPath();a.moveTo(e,d);f?(a.arc(h,k,f,-B,0,!1),a.arc(h,
l,f,0,B,!1),a.arc(e,l,f,B,y,!1),a.arc(e,k,f,y,y+B,!1)):(a.lineTo(h,d),a.lineTo(c,l),a.lineTo(e,g),a.lineTo(b,k));a.closePath()},_renderDashedStroke:function(a,g){var f=this.shape,b=Math.min(f.r,f.height/2,f.width/2),c=f.x,d=c+f.width,e=f.y,h=e+f.height,k=c+b,l=d-b,m=e+b,n=h-b;b?(a.beginPath(),f=q(a,this,k,e,l,e),g&&a.stroke(),f=w(a,this.canvasDash,l,m,b,-B,0,!1,g,f),a.beginPath(),f=q(a,this,d,m,d,n,f),g&&a.stroke(),f=w(a,this.canvasDash,l,n,b,0,B,!1,g,f),a.beginPath(),f=q(a,this,l,h,k,h,f),g&&a.stroke(),
f=w(a,this.canvasDash,k,n,b,B,y,!1,g,f),a.beginPath(),f=q(a,this,c,n,c,m,f),g&&a.stroke(),w(a,this.canvasDash,k,m,b,y,y+B,!1,g,f)):(a.beginPath(),f=q(a,this,k,e,l,e),f=q(a,this,l,e,d,n,f),f=q(a,this,d,n,k,h,f),q(a,this,k,h,c,m,f),g&&a.stroke())}});var C=[];(function(){var a=b.curvePI4;C.push(a.s,a.c1,a.c2,a.e);for(var g=45;360>g;g+=45){var f=n.rotateg(g);C.push(v(f,a.c1),v(f,a.c2),v(f,a.e))}})();var I=function(a){var g,f,b,c=[],d=a.shape,e=n.normalize([n.translate(d.cx,d.cy),n.scale(d.rx,d.ry)]);
g=v(e,C[0]);c.push([g.x,g.y]);for(d=1;d<C.length;d+=3)f=v(e,C[d]),b=v(e,C[d+1]),g=v(e,C[d+2]),c.push([f.x,f.y,b.x,b.y,g.x,g.y]);if(a._needsDash){g=[];f=c[0];for(d=1;d<c.length;++d)b=[],z(f.concat(c[d]),a.canvasDash,b),f=[c[d][4],c[d][5]],g.push(b);a._dashedPoints=g}return c};m.Ellipse=r("dojox.gfx.canvas.Ellipse",[m.Shape,d.Ellipse],{setShape:function(){this.inherited(arguments);this.canvasEllipse=I(this);return this},setStroke:function(){this.inherited(arguments);G||(this.canvasEllipse=I(this));
return this},_renderShape:function(a){var g=this.canvasEllipse,f;a.beginPath();a.moveTo.apply(a,g[0]);for(f=1;f<g.length;++f)a.bezierCurveTo.apply(a,g[f]);a.closePath()},_renderDashedStroke:function(a,g){var f=this._dashedPoints;a.beginPath();for(var b=0;b<f.length;++b)for(var c=f[b],d=0;d<c.length;++d){var e=c[d];a.moveTo(e[0],e[1]);a.bezierCurveTo(e[2],e[3],e[4],e[5],e[6],e[7])}g&&a.stroke()}});m.Circle=r("dojox.gfx.canvas.Circle",[m.Shape,d.Circle],{_renderShape:function(a){var g=this.shape;a.beginPath();
a.arc(g.cx,g.cy,g.r,0,A,1)},_renderDashedStroke:function(a,g){var f=this.shape,b=0,c,d=this.canvasDash.length;for(i=0;b<A;)c=this.canvasDash[i%d]/f.r,i%2||(a.beginPath(),a.arc(f.cx,f.cy,f.r,b,b+c,0),g&&a.stroke()),b+=c,++i}});m.Line=r("dojox.gfx.canvas.Line",[m.Shape,d.Line],{_renderShape:function(a){var g=this.shape;a.beginPath();a.moveTo(g.x1,g.y1);a.lineTo(g.x2,g.y2)},_renderDashedStroke:function(a,g){var f=this.shape;a.beginPath();q(a,this,f.x1,f.y1,f.x2,f.y2);g&&a.stroke()}});m.Polyline=r("dojox.gfx.canvas.Polyline",
[m.Shape,d.Polyline],{setShape:function(){this.inherited(arguments);var a=this.shape.points,g=a[0],f,b;this.bbox=null;this._normalizePoints();if(a.length)if("number"==typeof g)g=a;else{g=[];for(b=0;b<a.length;++b)f=a[b],g.push(f.x,f.y)}else g=[];this.canvasPolyline=g;return this},_renderShape:function(a){var g=this.canvasPolyline;if(g.length){a.beginPath();a.moveTo(g[0],g[1]);for(var f=2;f<g.length;f+=2)a.lineTo(g[f],g[f+1])}},_renderDashedStroke:function(a,g){var f=this.canvasPolyline,b=0;a.beginPath();
for(var c=0;c<f.length;c+=2)b=q(a,this,f[c],f[c+1],f[c+2],f[c+3],b);g&&a.stroke()}});m.Image=r("dojox.gfx.canvas.Image",[m.Shape,d.Image],{setShape:function(){this.inherited(arguments);var a=new Image;this.surface.downloadImage(a,this.shape.src);this.canvasImage=a;return this},_renderShape:function(a){var g=this.shape;a.drawImage(this.canvasImage,g.x,g.y,g.width,g.height)}});m.Text=r("dojox.gfx.canvas.Text",[m.Shape,d.Text],{_setFont:function(){this.fontStyle?this.canvasFont=e.makeFontString(this.fontStyle):
delete this.canvasFont},getTextWidth:function(){var a=this.shape,g=0,f;a.text&&(f=this.surface.rawNode.getContext("2d"),f.save(),this._renderTransform(f),this._renderFill(f,!1),this._renderStroke(f,!1),this.canvasFont&&(f.font=this.canvasFont),g=f.measureText(a.text).width,f.restore());return g},_render:function(a){a.save();this._renderTransform(a);this._renderFill(a,!1);this._renderStroke(a,!1);this._renderShape(a);a.restore()},_renderShape:function(a){var g,f=this.shape;f.text&&(g="middle"===f.align?
"center":f.align,a.textAlign=g,this.canvasFont&&(a.font=this.canvasFont),this.canvasFill&&a.fillText(f.text,f.x,f.y),this.strokeStyle&&(a.beginPath(),a.strokeText(f.text,f.x,f.y),a.closePath()))}});E(m.Text,"setFont");K||m.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var N={M:"_moveToA",m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",
Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};m.Path=r("dojox.gfx.canvas.Path",[m.Shape,c.Path],{constructor:function(){this.lastControl={}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);G||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(a){var g=
s.clone(this.last);this[N[a.action]](this.canvasPath,a.action,a.args,this._needsDash?this._dashedPath:null);this.last=g;this.inherited(arguments)},_renderShape:function(a){var g=this.canvasPath;a.beginPath();for(var f=0;f<g.length;f+=2)a[g[f]].apply(a,g[f+1])},_renderDashedStroke:G?function(){}:function(a,g){var f=this._dashedPath;a.beginPath();for(var b=0;b<f.length;b+=2)a[f[b]].apply(a,f[b+1]);g&&a.stroke()},_moveToA:function(a,b,f,c){a.push("moveTo",[f[0],f[1]]);c&&c.push("moveTo",[f[0],f[1]]);
for(b=2;b<f.length;b+=2)a.push("lineTo",[f[b],f[b+1]]),c&&(this._dashResidue=q(c,this,f[b-2],f[b-1],f[b],f[b+1],this._dashResidue));this.last.x=f[f.length-2];this.last.y=f[f.length-1];this.lastControl={}},_moveToR:function(a,b,f,c){b="x"in this.last?[this.last.x+=f[0],this.last.y+=f[1]]:[this.last.x=f[0],this.last.y=f[1]];a.push("moveTo",b);c&&c.push("moveTo",b);for(b=2;b<f.length;b+=2)a.push("lineTo",[this.last.x+=f[b],this.last.y+=f[b+1]]),c&&(this._dashResidue=q(c,this,c[c.length-1][0],c[c.length-
1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(a,b,f,c){for(b=0;b<f.length;b+=2)c&&(this._dashResidue=q(c,this,this.last.x,this.last.y,f[b],f[b+1],this._dashResidue)),a.push("lineTo",[f[b],f[b+1]]);this.last.x=f[f.length-2];this.last.y=f[f.length-1];this.lastControl={}},_lineToR:function(a,b,f,c){for(b=0;b<f.length;b+=2)a.push("lineTo",[this.last.x+=f[b],this.last.y+=f[b+1]]),c&&(this._dashResidue=q(c,this,c[c.length-1][0],c[c.length-1][1],this.last.x,this.last.y,
this._dashResidue));this.lastControl={}},_hLineToA:function(a,b,f,c){for(b=0;b<f.length;++b)a.push("lineTo",[f[b],this.last.y]),c&&(this._dashResidue=q(c,this,c[c.length-1][0],c[c.length-1][1],f[b],this.last.y,this._dashResidue));this.last.x=f[f.length-1];this.lastControl={}},_hLineToR:function(a,b,f,c){for(b=0;b<f.length;++b)a.push("lineTo",[this.last.x+=f[b],this.last.y]),c&&(this._dashResidue=q(c,this,c[c.length-1][0],c[c.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl=
{}},_vLineToA:function(a,b,f,c){for(b=0;b<f.length;++b)a.push("lineTo",[this.last.x,f[b]]),c&&(this._dashResidue=q(c,this,c[c.length-1][0],c[c.length-1][1],this.last.x,f[b],this._dashResidue));this.last.y=f[f.length-1];this.lastControl={}},_vLineToR:function(a,b,f,c){for(b=0;b<f.length;++b)a.push("lineTo",[this.last.x,this.last.y+=f[b]]),c&&(this._dashResidue=q(c,this,c[c.length-1][0],c[c.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(a,b,c,d){for(b=
0;b<c.length;b+=6)a.push("bezierCurveTo",c.slice(b,b+6)),d&&(this._dashResidue=t(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type="C"},_curveToR:function(a,b,c,d){for(b=0;b<c.length;b+=6)a.push("bezierCurveTo",[this.last.x+c[b],this.last.y+c[b+1],this.lastControl.x=this.last.x+c[b+2],this.lastControl.y=this.last.y+c[b+3],this.last.x+c[b+4],this.last.y+c[b+5]]),d&&(this._dashResidue=
t(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+4],this.last.y+=c[b+5];this.lastControl.type="C"},_smoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4){var e="C"==this.lastControl.type;a.push("bezierCurveTo",[e?2*this.last.x-this.lastControl.x:this.last.x,e?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+1],c[b+2],c[b+3]]);d&&(this._dashResidue=t(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=c[b];this.lastControl.y=c[b+1];this.lastControl.type="C"}this.last.x=
c[c.length-2];this.last.y=c[c.length-1]},_smoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4){var e="C"==this.lastControl.type;a.push("bezierCurveTo",[e?2*this.last.x-this.lastControl.x:this.last.x,e?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]);d&&(this._dashResidue=t(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=this.last.x+c[b];this.lastControl.y=this.last.y+c[b+1];this.lastControl.type="C";this.last.x+=
c[b+2];this.last.y+=c[b+3]}},_qCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",c.slice(b,b+4));d&&(this._dashResidue=t(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type="Q"},_qCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",[this.lastControl.x=this.last.x+c[b],this.lastControl.y=this.last.y+c[b+1],this.last.x+c[b+
2],this.last.y+c[b+3]]),d&&(this._dashResidue=t(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+2],this.last.y+=c[b+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=2){var e="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=e?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=e?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+1]]);d&&(this._dashResidue=t(d,this,a[a.length-1],this._dashResidue));this.lastControl.type=
"Q"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_qSmoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=2){var e="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=e?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=e?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],this.last.y+c[b+1]]);d&&(this._dashResidue=t(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=c[b];this.last.y+=c[b+1]}},_arcTo:function(a,c,d,e){c=
"a"==c;for(var h=0;h<d.length;h+=7){var k=d[h+5],m=d[h+6];c&&(k+=this.last.x,m+=this.last.y);var n=b.arcAsBezier(this.last,d[h],d[h+1],d[h+2],d[h+3]?1:0,d[h+4]?1:0,k,m);l.forEach(n,function(b){a.push("bezierCurveTo",b)});e&&(this._dashResidue=t(e,this,p,this._dashResidue));this.last.x=k;this.last.y=m}this.lastControl={}},_closePath:function(a,b,c,d){a.push("closePath",[]);d&&(this._dashResidue=q(d,this,this.last.x,this.last.y,d[1][0],d[1][1],this._dashResidue));this.lastControl={}}});l.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),
function(a){E(m.Path,a)});m.TextPath=r("dojox.gfx.canvas.TextPath",[m.Shape,c.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});m.Surface=r("dojox.gfx.canvas.Surface",d.Surface,{constructor:function(){d.Container._init.call(this);this.pendingImageCount=0;this.makeDirty()},destroy:function(){d.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(a,b){this.width=e.normalizedLength(a);this.height=e.normalizedLength(b);if(!this.rawNode)return this;
var c=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,c=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,c=!0);c&&this.makeDirty();return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:null},_render:function(a){if(this.rawNode&&(a||!this.pendingImageCount))a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),
delete this.pendingRender)},render:function(a){a.save();for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},makeDirty:function(){!this.pendingImagesCount&&(!("pendingRender"in this)&&!this._batch)&&(this.pendingRender=setTimeout(s.hitch(this,this._render),0))},downloadImage:function(a,b){var c=s.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=c;a.onerror=c;a.onabort=c;
a.src=b},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},on:function(){}});m.createSurface=function(a,b,c){if(!b&&!c){var d=h.position(a);b=b||d.w;c=c||d.h}"number"==typeof b&&(b+="px");"number"==typeof c&&(c+="px");d=new m.Surface;a=k.byId(a);var l=a.ownerDocument.createElement("canvas");l.width=e.normalizedLength(b);l.height=e.normalizedLength(c);
a.appendChild(l);d.rawNode=l;d._parent=a;return d.surface=d};var F=d.Container;r={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},add:function(a){this._makeDirty();return F.add.apply(this,arguments)},remove:function(a,b){this._makeDirty();return F.remove.apply(this,arguments)},clear:function(){this._makeDirty();return F.clear.apply(this,arguments)},
getBoundingBox:F.getBoundingBox,_moveChildToFront:function(a){this._makeDirty();return F._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return F._moveChildToBack.apply(this,arguments)}};c={createObject:function(a,b){var c=new a;c.surface=this.surface;c.setShape(b);this.add(c);return c}};a(m.Group,r);a(m.Group,d.Creator);a(m.Group,c);a(m.Surface,r);a(m.Surface,d.Creator);a(m.Surface,c);m.fixTarget=function(a,b){return!0};return m});