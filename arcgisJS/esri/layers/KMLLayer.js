// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.14/esri/copyright.txt for details.
//>>built
require({cache:{"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),function(n,m,h,q,d,a){n=q("dijit._OnDijitClickMixin",null,{connect:function(d,b,k){return this.inherited(arguments,[d,"ondijitclick"==b?a:b,k])}});n.a11yclick=a;return n})},"dijit/a11y":function(){define("dojo/_base/array dojo/dom dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/sniff ./main".split(" "),function(n,m,h,q,d,a,l){var b={_isElementShown:function(a){var e=
q.get(a);return"hidden"!=e.visibility&&"collapsed"!=e.visibility&&"none"!=e.display&&"hidden"!=h.get(a,"type")},hasDefaultTabStop:function(a){switch(a.nodeName.toLowerCase()){case "a":return h.has(a,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return!0;case "iframe":var e;try{var b=a.contentDocument;if("designMode"in b&&"on"==b.designMode)return!0;e=b.body}catch(d){try{e=a.contentWindow.document.body}catch(m){return!1}}return e&&("true"==e.contentEditable||
e.firstChild&&"true"==e.firstChild.contentEditable);default:return"true"==a.contentEditable}},effectiveTabIndex:function(a){return h.get(a,"disabled")?void 0:h.has(a,"tabIndex")?+h.get(a,"tabIndex"):b.hasDefaultTabStop(a)?0:void 0},isTabNavigable:function(a){return 0<=b.effectiveTabIndex(a)},isFocusable:function(a){return-1<=b.effectiveTabIndex(a)},_getTabNavigable:function(d){function e(w){return w&&"input"==w.tagName.toLowerCase()&&w.type&&"radio"==w.type.toLowerCase()&&w.name&&w.name.toLowerCase()}
var t,m,l,q,n,v,w={},F=b._isElementShown,B=b.effectiveTabIndex,z=function(b){for(b=b.firstChild;b;b=b.nextSibling)if(!(1!=b.nodeType||9>=a("ie")&&"HTML"!==b.scopeName||!F(b))){var r=B(b);if(0<=r){if(0==r)t||(t=b),m=b;else if(0<r){if(!l||r<q)q=r,l=b;if(!n||r>=v)v=r,n=b}r=e(b);h.get(b,"checked")&&r&&(w[r]=b)}"SELECT"!=b.nodeName.toUpperCase()&&z(b)}};F(d)&&z(d);return{first:w[e(t)]||t,last:w[e(m)]||m,lowest:w[e(l)]||l,highest:w[e(n)]||n}},getFirstInTabbingOrder:function(a,e){var d=b._getTabNavigable(m.byId(a,
e));return d.lowest?d.lowest:d.first},getLastInTabbingOrder:function(a,e){var d=b._getTabNavigable(m.byId(a,e));return d.last?d.last:d.highest}};d.mixin(l,b);return b})},"dijit/a11yclick":function(){define(["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(n,m,h,q){function d(b){if((b.keyCode===n.ENTER||b.keyCode===n.SPACE)&&!/input|button|textarea/i.test(b.target.nodeName))for(b=b.target;b;b=b.parentNode)if(b.dojoClick)return!0}var a;h(document,"keydown",function(b){d(b)?(a=b.target,b.preventDefault()):
a=null});h(document,"keyup",function(b){d(b)&&b.target==a&&(a=null,h.emit(b.target,"click",{cancelable:!0,bubbles:!0,ctrlKey:b.ctrlKey,shiftKey:b.shiftKey,metaKey:b.metaKey,altKey:b.altKey,_origType:b.type}))});var l=function(b,a){b.dojoClick=!0;return h(b,"click",a)};l.click=l;l.press=function(a,d){var e=h(a,q.press,function(a){("mousedown"!=a.type||m.isLeft(a))&&d(a)}),l=h(a,"keydown",function(a){(a.keyCode===n.ENTER||a.keyCode===n.SPACE)&&d(a)});return{remove:function(){e.remove();l.remove()}}};
l.release=function(a,d){var e=h(a,q.release,function(a){("mouseup"!=a.type||m.isLeft(a))&&d(a)}),l=h(a,"keyup",function(a){(a.keyCode===n.ENTER||a.keyCode===n.SPACE)&&d(a)});return{remove:function(){e.remove();l.remove()}}};l.move=q.move;return l})},"esri/layers/KMLGroundOverlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./MapImage".split(" "),function(n,m,h,q,d,a){n=n([a],{declaredClass:"esri.layers.KMLGroundOverlay",constructor:function(a){d.isDefined(this.visibility)&&
(this.visible=!!this.visibility)}});h("extend-esri")&&m.setObject("layers.KMLGroundOverlay",n,q);return n})},"dojo/touch":function(){define("./_base/kernel ./aspect ./dom ./dom-class ./_base/lang ./on ./has ./mouse ./domReady ./_base/window".split(" "),function(n,m,h,q,d,a,l,b,k,e){function t(c,g,p){return C&&p?function(c,g){return a(c,p,g)}:w?function(p,s){var w=a(p,g,function(c){s.call(this,c);f=(new Date).getTime()}),r=a(p,c,function(c){(!f||(new Date).getTime()>f+1E3)&&s.call(this,c)});return{remove:function(){w.remove();
r.remove()}}}:function(g,f){return a(g,c,f)}}function x(c){do if(void 0!==c.dojoClick)return c;while(c=c.parentNode)}function E(f,p,w){var b=x(f.target);if(B=!f.target.disabled&&b&&b.dojoClick)if(y=(z="useTarget"==B)?b:f.target,z&&f.preventDefault(),r=f.changedTouches?f.changedTouches[0].pageX-e.global.pageXOffset:f.clientX,A=f.changedTouches?f.changedTouches[0].pageY-e.global.pageYOffset:f.clientY,c=("object"==typeof B?B.x:"number"==typeof B?B:0)||4,s=("object"==typeof B?B.y:"number"==typeof B?B:
0)||4,!F){F=!0;var d=function(g){B=z?h.isDescendant(e.doc.elementFromPoint(g.changedTouches?g.changedTouches[0].pageX-e.global.pageXOffset:g.clientX,g.changedTouches?g.changedTouches[0].pageY-e.global.pageYOffset:g.clientY),y):B&&(g.changedTouches?g.changedTouches[0].target:g.target)==y&&Math.abs((g.changedTouches?g.changedTouches[0].pageX-e.global.pageXOffset:g.clientX)-r)<=c&&Math.abs((g.changedTouches?g.changedTouches[0].pageY-e.global.pageYOffset:g.clientY)-A)<=s};e.doc.addEventListener(p,function(c){d(c);
z&&c.preventDefault()},!0);e.doc.addEventListener(w,function(c){d(c);if(B){g=(new Date).getTime();var f=z?y:c.target;"LABEL"===f.tagName&&(f=h.byId(f.getAttribute("for"))||f);var p=c.changedTouches?c.changedTouches[0]:c,s=document.createEvent("MouseEvents");s._dojo_click=!0;s.initMouseEvent("click",!0,!0,c.view,c.detail,p.screenX,p.screenY,p.clientX,p.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,0,null);setTimeout(function(){a.emit(f,"click",s);g=(new Date).getTime()},0)}},!0);f=function(c){e.doc.addEventListener(c,
function(f){!f._dojo_click&&((new Date).getTime()<=g+1E3&&!("INPUT"==f.target.tagName&&q.contains(f.target,"dijitOffScreen")))&&(f.stopPropagation(),f.stopImmediatePropagation&&f.stopImmediatePropagation(),"click"==c&&(("INPUT"!=f.target.tagName||"radio"==f.target.type||"checkbox"==f.target.type)&&"TEXTAREA"!=f.target.tagName&&"AUDIO"!=f.target.tagName&&"VIDEO"!=f.target.tagName)&&f.preventDefault())},!0)};f("click");f("mousedown");f("mouseup")}}var u=5>l("ios"),C=l("pointer-events")||l("MSPointer"),
v=function(){var c={},g;for(g in{down:1,move:1,up:1,cancel:1,over:1,out:1})c[g]=l("MSPointer")?"MSPointer"+g.charAt(0).toUpperCase()+g.slice(1):"pointer"+g;return c}(),w=l("touch-events"),F,B,z=!1,y,r,A,c,s,g,f,p;C?k(function(){e.doc.addEventListener(v.down,function(c){E(c,v.move,v.up)},!0)}):w&&k(function(){function c(g){var f=d.delegate(g,{bubbles:!0});6<=l("ios")&&(f.touches=g.touches,f.altKey=g.altKey,f.changedTouches=g.changedTouches,f.ctrlKey=g.ctrlKey,f.metaKey=g.metaKey,f.shiftKey=g.shiftKey,
f.targetTouches=g.targetTouches);return f}p=e.body();e.doc.addEventListener("touchstart",function(c){f=(new Date).getTime();var g=p;p=c.target;a.emit(g,"dojotouchout",{relatedTarget:p,bubbles:!0});a.emit(p,"dojotouchover",{relatedTarget:g,bubbles:!0});E(c,"touchmove","touchend")},!0);a(e.doc,"touchmove",function(g){f=(new Date).getTime();var s=e.doc.elementFromPoint(g.pageX-(u?0:e.global.pageXOffset),g.pageY-(u?0:e.global.pageYOffset));s&&(p!==s&&(a.emit(p,"dojotouchout",{relatedTarget:s,bubbles:!0}),
a.emit(s,"dojotouchover",{relatedTarget:p,bubbles:!0}),p=s),a.emit(s,"dojotouchmove",c(g))||g.preventDefault())});a(e.doc,"touchend",function(g){f=(new Date).getTime();var p=e.doc.elementFromPoint(g.pageX-(u?0:e.global.pageXOffset),g.pageY-(u?0:e.global.pageYOffset))||e.body();a.emit(p,"dojotouchend",c(g))})});m={press:t("mousedown","touchstart",v.down),move:t("mousemove","dojotouchmove",v.move),release:t("mouseup","dojotouchend",v.up),cancel:t(b.leave,"touchcancel",C?v.cancel:null),over:t("mouseover",
"dojotouchover",v.over),out:t("mouseout","dojotouchout",v.out),enter:b._eventHandler(t("mouseover","dojotouchover",v.over)),leave:b._eventHandler(t("mouseout","dojotouchout",v.out))};return n.touch=m})},"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(n,m,h,q,d,a,l,b,k){var e=d.delegate(b,{mouseenter:a.enter,mouseleave:a.leave,keypress:h._keypress}),t;h=q("dijit._AttachMixin",
null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);this._beforeFillContent()},_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var b=a;;)if(1==b.nodeType&&(this._processTemplateNode(b,function(a,b){return a.getAttribute(b)},this._attach)||this.searchContainerNode)&&b.firstChild)b=b.firstChild;else{if(b==a)break;for(;!b.nextSibling;)if(b=b.parentNode,b==a)return;b=
b.nextSibling}},_processTemplateNode:function(a,b,e){var h=!0,l=this.attachScope||this,w=b(a,"dojoAttachPoint")||b(a,"data-dojo-attach-point");if(w)for(var F=w.split(/\s*,\s*/);w=F.shift();)d.isArray(l[w])?l[w].push(a):l[w]=a,h="containerNode"!=w,this._attachPoints.push(w);if(b=b(a,"dojoAttachEvent")||b(a,"data-dojo-attach-event")){w=b.split(/\s*,\s*/);for(F=d.trim;b=w.shift();)if(b){var m=null;-1!=b.indexOf(":")?(m=b.split(":"),b=F(m[0]),m=F(m[1])):b=F(b);m||(m=b);this._attachEvents.push(e(a,b,d.hitch(l,
m)))}}return h},_attach:function(a,b,d){b=b.replace(/^on/,"").toLowerCase();b="dijitclick"==b?t||(t=n("./a11yclick")):e[b]||b;return l(a,b,d)},_detachTemplateNodes:function(){var a=this.attachScope||this;m.forEach(this._attachPoints,function(b){delete a[b]});this._attachPoints=[];m.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});d.extend(k,{dojoAttachEvent:"",dojoAttachPoint:""});return h})},
"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all ./lang ./kernel ./request ./tasks/query ./tasks/QueryTask ./tasks/StatisticDefinition dojo/i18n!dojo/cldr/nls/number".split(" "),function(n,m,h,q,d,a,l,b,k,e,t,x,E,u,C,v){n=n(null,{declaredClass:"esri.PopupInfo",initialize:function(a,b){if(a){m.mixin(this,b);this.info=a;this.title=this.getTitle;this.content=this.getContent;var e=this._fieldLabels=
{},d=this._fieldsMap={};a.fieldInfos&&h.forEach(a.fieldInfos,function(a){var b=a.fieldName.toLowerCase();e[b]=a.label;d[b]=a});this._relatedFieldPrefix="relationships/";this.titleHasRelatedFields=!!(a.title&&-1!==a.title.indexOf("{"+this._relatedFieldPrefix))}},toJson:function(){return q.fromJson(q.toJson(this.info))},getTitle:function(){},getContent:function(){},getFieldInfo:function(a){var b;h.some(this.info&&this.info.fieldInfos,function(e){e.fieldName===a&&(b=e);return!!b});return b},getComponents:function(a){var b=
this.info,e=new l,d,k;b.fieldInfos&&(k=h.filter(b.fieldInfos,function(a){return-1!==a.fieldName.indexOf(this._relatedFieldPrefix)},this));k&&0<k.length&&(d=this._getRelatedRecords({graphic:a,fieldsInfo:k}));d?d.always(m.hitch(this,function(){e.resolve(this._getPopupValues(a))})):e.resolve(this._getPopupValues(a));return e.promise},getAttachments:function(a){var b=a.getLayer();a=a.attributes;if(this.info.showAttachments&&(b&&b.hasAttachments&&b.objectIdField)&&(a=a&&a[b.objectIdField]))return b.queryAttachmentInfos(a)},
_getPopupValues:function(a,b){var d=this.info,l=a.getLayer(),k=m.clone(a.attributes)||{},r=m.clone(k),A=d.fieldInfos,c="",s="",g,f,p,J,H,q=l&&l._getDateOpts&&l._getDateOpts().properties,q=q&&q.slice(0),t={dateFormat:{properties:q,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)}};if(this._relatedInfo)for(J in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(J)){var n=this._relatedInfo[J],D=this._relatedLayersInfo[J];n&&(h.forEach(n.relatedFeatures,function(c){for(H in c.attributes)if(c.attributes.hasOwnProperty(H)&&
"esriRelCardinalityOneToOne"===D.relation.cardinality){var g=this._toRelatedFieldName([D.relation.id,H]);k[g]=r[g]=c.attributes[H]}},this),h.forEach(n.relatedStatsFeatures,function(c){for(H in c.attributes)if(c.attributes.hasOwnProperty(H)){var g=this._toRelatedFieldName([D.relation.id,H]);k[g]=r[g]=c.attributes[H]}},this))}A&&h.forEach(A,function(c){f=c.fieldName;var g=this._getLayerFieldInfo(l,f);g&&(f=c.fieldName=g.name);r[f]=this._formatValue(r[f],f,t);q&&(c.format&&c.format.dateFormat)&&(c=h.indexOf(q,
f),-1<c&&q.splice(c,1))},this);if(l){J=l.types;var v=(n=l.typeIdField)&&k[n];for(f in k)if(k.hasOwnProperty(f)&&-1===f.indexOf(this._relatedFieldPrefix)&&(p=k[f],e.isDefined(p))){var u=this._getDomainName(l,a,J,v,f,p);e.isDefined(u)?r[f]=u:f===n&&(u=this._getTypeName(l,a,p),e.isDefined(u)&&(r[f]=u))}}d.title&&(c=this._processFieldsInLinks(this._fixTokens(d.title,l),k),c=m.trim(e.substitute(r,c,t)||""));if(b)return{title:c};d.description&&(s=this._processFieldsInLinks(this._fixTokens(d.description,
l),k),s=m.trim(e.substitute(r,s,t)||""));A&&(g=[],h.forEach(A,function(c){(f=c.fieldName)&&c.visible&&g.push([c.label||f,e.substitute(r,"${"+f+"}",t)||""])}));var x,E;d.mediaInfos&&(x=[],h.forEach(d.mediaInfos,function(c){E=0;p=c.value;switch(c.type){case "image":var g=p.sourceURL,g=g&&m.trim(e.substitute(k,this._fixTokens(g,l)));E=!!g;break;case "piechart":case "linechart":case "columnchart":case "barchart":var f,g=p.normalizeField;p.fields=h.map(p.fields,function(c){return(f=this._getLayerFieldInfo(l,
c))?f.name:c},this);g&&(f=this._getLayerFieldInfo(l,g),p.normalizeField=f?f.name:g);E=h.some(p.fields,function(c){return e.isDefined(k[c])||-1!==c.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(E){c=m.clone(c);p=c.value;var g=c.title?this._processFieldsInLinks(this._fixTokens(c.title,l),k):"",a=c.caption?this._processFieldsInLinks(this._fixTokens(c.caption,l),k):"";c.title=g?m.trim(e.substitute(r,g,t)||""):"";c.caption=a?m.trim(e.substitute(r,a,t)||""):"";if("image"===
c.type)p.sourceURL=e.substitute(k,this._fixTokens(p.sourceURL,l)),p.linkURL&&(p.linkURL=m.trim(e.substitute(k,this._fixTokens(p.linkURL,l))||""));else{var s,b;h.forEach(p.fields,function(c,g){if(-1!==c.indexOf(this._relatedFieldPrefix))b=this._getRelatedChartInfos(c,p,k,t),b instanceof Array?p.fields=b:p.fields[g]=b;else{var f=k[c],f=void 0===f?null:f;s=k[p.normalizeField]||0;f&&s&&(f/=s);p.fields[g]={y:f,tooltip:(this._fieldLabels[c.toLowerCase()]||c)+":\x3cbr/\x3e"+this._formatValue(f,c,t,!!s)}}},
this)}x.push(c)}},this));return{title:c,description:s,hasDescription:!!d.description,fields:g&&g.length?g:null,mediaInfos:x&&x.length?x:null,formatted:r,editSummary:l&&l.getEditSummary?l.getEditSummary(a):""}},_getRelatedChartInfos:function(a,b,e,d){var l,r,A,c,s,g;l=[];g=this._fromRelatedFieldName(a);s=g[0];r=this._relatedInfo[s];s=this._relatedLayersInfo[s];r&&h.forEach(r.relatedFeatures,function(f){f=f.attributes;var p,s;for(s in f)if(f.hasOwnProperty(s)&&s===g[1]){p={};c=f[s];b.normalizeField&&
(A=-1!==b.normalizeField.indexOf(this._relatedFieldPrefix)?f[this._fromRelatedFieldName(b.normalizeField)[1]]:e[b.normalizeField]);c&&A&&(c/=A);if(b.tooltipField)if(-1!==b.tooltipField.indexOf(this._relatedFieldPrefix)){var r=this._fromRelatedFieldName(b.tooltipField)[1];p.tooltip=f[r]&&"string"===typeof f[r]?f[r]+":\x3cbr/\x3e"+this._formatValue(c,f[r],d,!!A):r+":\x3cbr/\x3e"+this._formatValue(c,r,d,!!A)}else p.tooltip=(this._fieldLabels[a.toLowerCase()]||a)+":\x3cbr/\x3e"+this._formatValue(c,b.tooltipField,
d,!!A);else p.tooltip=c;p.y=c;l.push(p)}},this);return"esriRelCardinalityOneToMany"===s.relation.cardinality||"esriRelCardinalityManyToMany"===s.relation.cardinality?l:l[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",
shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",
shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"},_reHref:/href\s*=\s*\"([^\"]+)\"/ig,_reHrefApos:/href\s*=\s*\'([^\']+)\'/ig,_fixTokens:function(a,b){var e=this;return a.replace(/(\{([^\{\r\n]+)\})/g,function(a,d,r){a=e._getLayerFieldInfo(b,r);return"$"+(a?"{"+a.name+"}":d)})},_encodeAttributes:function(a){a=
m.clone(a)||{};var b,e;for(b in a)if((e=a[b])&&"string"===typeof e)e=encodeURIComponent(e).replace(/\'/g,"\x26apos;"),a[b]=e;return a},_processFieldsInLinks:function(a,b){var e=this._encodeAttributes(b),d=this;a&&(a=a.replace(this._reHref,function(a,r){return d._addValuesToHref(a,r,b,e)}).replace(this._reHrefApos,function(a,r){return d._addValuesToHref(a,r,b,e)}));return a},_addValuesToHref:function(a,b,d,l){b=b&&m.trim(b);return e.substitute(b&&0===b.indexOf("${")?d:l,a)},_getLayerFieldInfo:function(a,
b){return a&&a.getField?a.getField(b):null},_formatValue:function(a,b,d,l){var k=this._fieldsMap[b.toLowerCase()],r=k&&k.format,A=-1!==h.indexOf(d.dateFormat.properties,b);b="number"===typeof a&&!A&&(!r||!r.dateFormat);if(!e.isDefined(a)||!k||!e.isDefined(r))return b?this._forceLTR(a):a;var c="",s=[],k=r.hasOwnProperty("places")||r.hasOwnProperty("digitSeparator"),g=r.hasOwnProperty("digitSeparator")?r.digitSeparator:!0;if(k&&!A)c="NumberFormat",s.push("places: "+(e.isDefined(r.places)&&(!l||0<r.places)?
Number(r.places):"Infinity")),s.length&&(c+="("+s.join(",")+")");else if(r.dateFormat)c="DateFormat"+this._insertOffset(this._dateFormats[r.dateFormat]||this._dateFormats.shortDateShortTime);else return b?this._forceLTR(a):a;a=e.substitute({myKey:a},"${myKey:"+c+"}",d)||"";k&&!g&&v.group&&(a=a.replace(RegExp("\\"+v.group,"g"),""));return b?this._forceLTR(a):a},_forceLTR:function(a){var e=b("ie");return e&&10>=e?a:"\x3cspan class\x3d'esriNumericValue'\x3e"+a+"\x3c/span\x3e"},_insertOffset:function(a){a&&
(a=e.isDefined(this.utcOffset)?a.replace(/\)\s*$/,", utcOffset:"+this.utcOffset+")"):a);return a},_getDomainName:function(a,b,e,d,l,r){return(a=a.getDomain&&a.getDomain(l,{feature:b}))&&a.codedValues?a.getName(r):null},_getTypeName:function(a,b,e){return(a=a.getType&&a.getType(b))&&a.name},_getRelatedRecords:function(a){var b=a.graphic,e=new l,d;this._relatedLayersInfo?this._queryRelatedLayers(b).then(m.hitch(this,function(a){this._setRelatedRecords(b,a);e.resolve(a)}),m.hitch(this,this._handlerErrorResponse,
e)):this._getRelatedLayersInfo(a).then(m.hitch(this,function(a){for(d in a)a.hasOwnProperty(d)&&a[d]&&(this._relatedLayersInfo[d].relatedLayerInfo=a[d]);this._queryRelatedLayers(b).then(m.hitch(this,function(a){this._setRelatedRecords(b,a);e.resolve(a)}),m.hitch(this,this._handlerErrorResponse,e))}),m.hitch(this,this._handlerErrorResponse,e));return e.promise},_getRelatedLayersInfo:function(a){var b=a.fieldsInfo,e,d,l={};e=a.graphic.getLayer();this._relatedLayersInfo||(this._relatedLayersInfo={});
h.forEach(b,function(a){var b,c,s,g;b=this._fromRelatedFieldName(a.fieldName);c=b[0];b=b[1];c&&(this._relatedLayersInfo[c]||(h.some(e.relationships,function(a){if(a.id==c)return g=a,!0}),g&&(this._relatedLayersInfo[c]={relation:g,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[c]&&(this._relatedLayersInfo[c].relatedFields.push(b),a.statisticType&&(s=new C,s.statisticType=a.statisticType,s.onStatisticField=b,s.outStatisticFieldName=b,this._relatedLayersInfo[c].outStatistics.push(s))))},
this);for(d in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(d)&&this._relatedLayersInfo[d]&&(a=this._relatedLayersInfo[d].relation,a=e.url.replace(/[0-9]+$/,a.relatedTableId),this._relatedLayersInfo[d].relatedLayerUrl=a,l[d]=x({url:a,content:{f:"json"},callbackParamName:"callback"}));return k(l)},_queryRelatedLayers:function(a){var b={},e;for(e in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(e)&&(b[e]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[e]}));
return k(b)},_queryRelatedLayer:function(a){var b,e,d,l,r,A,c,s,g,f;b=a.graphic;e=b.getLayer().url.match(/[0-9]+$/g)[0];s=a.relatedInfo;c=s.relatedLayerInfo;g=s.relatedLayerUrl;f=s.relation;h.some(c.relationships,function(c){if(c.relatedTableId===parseInt(e,10))return d=c,!0},this);d&&(a=new E,h.some(c.fields,function(c){if(c.name===d.keyField)return r=-1!==h.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],c.type)?"number":"string",!0}),l="string"===
r?d.keyField+"\x3d'"+b.attributes[f.keyField]+"'":d.keyField+"\x3d"+b.attributes[f.keyField],a.where=l,a.outFields=s.relatedFields,s.outStatistics&&(0<s.outStatistics.length&&c.supportsStatistics)&&(A=new E,A.where=a.where,A.outFields=a.outFields,A.outStatistics=s.outStatistics),b=new u(g),l=[],l.push(b.execute(a)),A&&l.push(b.execute(A)));return k(l)},_setRelatedRecords:function(a,b){this._relatedInfo=[];for(var d in b)if(b.hasOwnProperty(d)&&b[d]){var l=b[d];this._relatedInfo[d]={};this._relatedInfo[d].relatedFeatures=
l[0].features;e.isDefined(l[1])&&(this._relatedInfo[d].relatedStatsFeatures=l[1].features)}},_handlerErrorResponse:function(a,b){a.reject(b)},_fromRelatedFieldName:function(a){var b=[];-1!==a.indexOf(this._relatedFieldPrefix)&&(a=a.split("/"),b=a.slice(1));return b},_toRelatedFieldName:function(a){var b="";a&&0<a.length&&(b=this._relatedFieldPrefix+a[0]+"/"+a[1]);return b}});a("extend-esri")&&(t.PopupInfo=t.PopupInfoTemplate=n);return n})},"dijit/focus":function(){define("dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Evented dojo/_base/lang dojo/on dojo/domReady dojo/sniff dojo/Stateful dojo/_base/window dojo/window ./a11y ./registry ./main".split(" "),
function(n,m,h,q,d,a,l,b,k,e,t,x,E,u,C,v,w){var F,B,z=new (m([x,l],{curNode:null,activeStack:[],constructor:function(){var e=b.hitch(this,function(a){h.isDescendant(this.curNode,a)&&this.set("curNode",null);h.isDescendant(this.prevNode,a)&&this.set("prevNode",null)});n.before(a,"empty",e);n.before(a,"destroy",e)},registerIframe:function(a){return this.registerWin(a.contentWindow,a)},registerWin:function(a,b){var c=this,s=a.document&&a.document.body;if(s){var g=t("pointer-events")?"pointerdown":t("MSPointer")?
"MSPointerDown":t("touch-events")?"mousedown, touchstart":"mousedown",f=k(a.document,g,function(a){if(!a||!(a.target&&null==a.target.parentNode))c._onTouchNode(b||a.target,"mouse")}),p=k(s,"focusin",function(a){if(a.target.tagName){var g=a.target.tagName.toLowerCase();"#document"==g||"body"==g||(C.isFocusable(a.target)?c._onFocusNode(b||a.target):c._onTouchNode(b||a.target))}}),e=k(s,"focusout",function(a){c._onBlurNode(b||a.target)});return{remove:function(){f.remove();p.remove();e.remove();s=f=
p=e=null}}}},_onBlurNode:function(a){a=(new Date).getTime();a<F+100||(this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),this._clearFocusTimer=setTimeout(b.hitch(this,function(){this.set("prevNode",this.curNode);this.set("curNode",null)}),0),this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),a<B+100||(this._clearActiveWidgetsTimer=setTimeout(b.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([])}),0)))},_onTouchNode:function(a,b){B=(new Date).getTime();
this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer);d.contains(a,"dijitPopup")&&(a=a.firstChild);var c=[];try{for(;a;){var s=q.get(a,"dijitPopupParent");if(s)a=v.byId(s).domNode;else if(a.tagName&&"body"==a.tagName.toLowerCase()){if(a===E.body())break;a=u.get(a.ownerDocument).frameElement}else{var g=a.getAttribute&&a.getAttribute("widgetId"),f=g&&v.byId(g);f&&!("mouse"==b&&f.get("disabled"))&&c.unshift(g);a=a.parentNode}}}catch(p){}this._setStack(c,
b)},_onFocusNode:function(a){a&&9!=a.nodeType&&(F=(new Date).getTime(),this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),delete this._clearFocusTimer),this._onTouchNode(a),a!=this.curNode&&(this.set("prevNode",this.curNode),this.set("curNode",a)))},_setStack:function(a,b){var c=this.activeStack,s=c.length-1,g=a.length-1;if(a[g]!=c[s]){this.set("activeStack",a);var f;for(f=s;0<=f&&c[f]!=a[f];f--)if(s=v.byId(c[f]))s._hasBeenBlurred=!0,s.set("focused",!1),s._focusManager==this&&s._onBlur(b),
this.emit("widget-blur",s,b);for(f++;f<=g;f++)if(s=v.byId(a[f]))s.set("focused",!0),s._focusManager==this&&s._onFocus(b),this.emit("widget-focus",s,b)}},focus:function(a){if(a)try{a.focus()}catch(b){}}}));e(function(){var a=z.registerWin(u.get(document));t("ie")&&k(window,"unload",function(){a&&(a.remove(),a=null)})});w.focus=function(a){z.focus(a)};for(var y in z)/^_/.test(y)||(w.focus[y]="function"==typeof z[y]?b.hitch(z,y):z[y]);z.watch(function(a,b,c){w.focus[a]=c});return z})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),
function(n,m,h,q,d,a){return n([a,d],{_onMap:function(a){var b=this.constructor._onMap,d;if(!b||!b.FINAL)delete this.constructor._onMap,b=this.registerConnectEvents(),b.FINAL=!0;a=a.toLowerCase();b[a]?d=this[b[a].method]:(a=this._onCamelCase(a),this[a]&&(d=a));return d},on:function(a,b){var d=this._onMap(a),e=a.replace(/\-/g,""),h="on"+e in this.domNode;return d||!h?this.inherited(arguments):this.own(q(this.domNode,e,b))[0]},emit:function(a,b,d){var e,h,q,n=a.toLowerCase(),u=this.constructor._onMap||
this.registerConnectEvents();h=this[this._onMap(n)];b=b||{};b.target||(b.target=this);h&&(u&&u[n])&&(this._onObj2Arr(function(){e=Array.prototype.slice.call(arguments)},u[n].argKeys)(b),q=m.mixin({},arguments),q[2]=e,q[0]=u[n].name.replace(/^on/,""));return this.inherited(q||arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),
function(n,m,h,q,d,a,l,b,k,e,t,x,E,u,C,v){function w(a){return eval("("+a+")")}function F(a){var c=a._nameCaseMap,b=a.prototype;if(!c||c._extendCnt<z){var c=a._nameCaseMap={},g;for(g in b)"_"!==g.charAt(0)&&(c[g.toLowerCase()]=g);c._extendCnt=z}return c}function B(a,c){var b=a.join();if(!y[b]){for(var g=[],f=0,p=a.length;f<p;f++){var e=a[f];g[g.length]=y[e]=y[e]||h.getObject(e)||~e.indexOf("/")&&(c?c(e):n(e))}f=g.shift();y[b]=g.length?f.createSubclass?f.createSubclass(g):f.extend.apply(f,g):f}return y[b]}
new Date("X");var z=0;k.after(h,"extend",function(){z++},!0);var y={},r={_clearCache:function(){z++;y={}},_functionFromScript:function(a,c){var b="",g="",f=a.getAttribute(c+"args")||a.getAttribute("args"),p=a.getAttribute("with"),f=(f||"").split(/\s*,\s*/);p&&p.length&&q.forEach(p.split(/\s*,\s*/),function(a){b+="with("+a+"){";g+="}"});return new Function(f,b+a.innerHTML+g)},instantiate:function(a,c,b){c=c||{};b=b||{};var g=(b.scope||m._scopeName)+"Type",f="data-"+(b.scope||m._scopeName)+"-",p=f+
"type",e=f+"mixins",d=[];q.forEach(a,function(a){var b=g in c?c[g]:a.getAttribute(p)||a.getAttribute(g);if(b){var f=a.getAttribute(e),b=f?[b].concat(f.split(/\s*,\s*/)):[b];d.push({node:a,types:b})}});return this._instantiate(d,c,b)},_instantiate:function(a,c,b,g){function f(a){!c._started&&!b.noStart&&q.forEach(a,function(a){"function"===typeof a.startup&&!a._started&&a.startup()});return a}a=q.map(a,function(a){var g=a.ctor||B(a.types,b.contextRequire);if(!g)throw Error("Unable to resolve constructor for: '"+
a.types.join()+"'");return this.construct(g,a.node,c,b,a.scripts,a.inherited)},this);return g?e(a).then(f):f(a)},construct:function(a,c,e,g,f,p){function d(a){B&&h.setObject(B,a);for(x=0;x<K.length;x++)k[K[x].advice||"after"](a,K[x].method,h.hitch(a,K[x].func),!0);for(x=0;x<N.length;x++)N[x].call(a);for(x=0;x<M.length;x++)a.watch(M[x].prop,M[x].func);for(x=0;x<L.length;x++)C(a,L[x].event,L[x].func);return a}var l=a&&a.prototype;g=g||{};var r={};g.defaults&&h.mixin(r,g.defaults);p&&h.mixin(r,p);var n;
E("dom-attributes-explicit")?n=c.attributes:E("dom-attributes-specified-flag")?n=q.filter(c.attributes,function(a){return a.specified}):(p=(/^input$|^img$/i.test(c.nodeName)?c:c.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),n=q.map(p.split(/\s+/),function(a){var g=a.toLowerCase();return{name:a,value:"LI"==c.nodeName&&"value"==a||"enctype"==g?c.getAttribute(g):c.getAttributeNode(g).value}}));var v=g.scope||m._scopeName;
p="data-"+v+"-";var D={};"dojo"!==v&&(D[p+"props"]="data-dojo-props",D[p+"type"]="data-dojo-type",D[p+"mixins"]="data-dojo-mixins",D[v+"type"]="dojoType",D[p+"id"]="data-dojo-id");for(var x=0,G,v=[],B,z;G=n[x++];){var y=G.name,I=y.toLowerCase();G=G.value;switch(D[I]||I){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":z=G;break;case "data-dojo-id":case "jsid":B=G;break;case "data-dojo-attach-point":case "dojoattachpoint":r.dojoAttachPoint=G;break;case "data-dojo-attach-event":case "dojoattachevent":r.dojoAttachEvent=
G;break;case "class":r["class"]=c.className;break;case "style":r.style=c.style&&c.style.cssText;break;default:if(y in l||(y=F(a)[I]||y),y in l)switch(typeof l[y]){case "string":r[y]=G;break;case "number":r[y]=G.length?Number(G):NaN;break;case "boolean":r[y]="false"!=G.toLowerCase();break;case "function":""===G||-1!=G.search(/[^\w\.]+/i)?r[y]=new Function(G):r[y]=h.getObject(G,!1)||new Function(G);v.push(y);break;default:I=l[y],r[y]=I&&"length"in I?G?G.split(/\s*,\s*/):[]:I instanceof Date?""==G?new Date(""):
"now"==G?new Date:t.fromISOString(G):I instanceof b?m.baseUrl+G:w(G)}else r[y]=G}}for(n=0;n<v.length;n++)D=v[n].toLowerCase(),c.removeAttribute(D),c[D]=null;if(z)try{z=w.call(g.propsThis,"{"+z+"}"),h.mixin(r,z)}catch(O){throw Error(O.toString()+" in data-dojo-props\x3d'"+z+"'");}h.mixin(r,e);f||(f=a&&(a._noScript||l._noScript)?[]:u("\x3e script[type^\x3d'dojo/']",c));var K=[],N=[],M=[],L=[];if(f)for(x=0;x<f.length;x++)D=f[x],c.removeChild(D),e=D.getAttribute(p+"event")||D.getAttribute("event"),g=
D.getAttribute(p+"prop"),z=D.getAttribute(p+"method"),v=D.getAttribute(p+"advice"),n=D.getAttribute("type"),D=this._functionFromScript(D,p),e?"dojo/connect"==n?K.push({method:e,func:D}):"dojo/on"==n?L.push({event:e,func:D}):r[e]=D:"dojo/aspect"==n?K.push({method:z,advice:v,func:D}):"dojo/watch"==n?M.push({prop:g,func:D}):N.push(D);a=(f=a.markupFactory||l.markupFactory)?f(r,c,a):new a(r,c);return a.then?a.then(d):d(a)},scan:function(a,c){function b(a){if(!a.inherited){a.inherited={};var c=a.node,g=
b(a.parent),c={dir:c.getAttribute("dir")||g.dir,lang:c.getAttribute("lang")||g.lang,textDir:c.getAttribute(r)||g.textDir},f;for(f in c)c[f]&&(a.inherited[f]=c[f])}return a.inherited}var g=[],f=[],p={},e=(c.scope||m._scopeName)+"Type",d="data-"+(c.scope||m._scopeName)+"-",l=d+"type",r=d+"textdir",d=d+"mixins",k=a.firstChild,h=c.inherited;if(!h){var t=function(a,c){return a.getAttribute&&a.getAttribute(c)||a.parentNode&&t(a.parentNode,c)},h={dir:t(a,"dir"),lang:t(a,"lang"),textDir:t(a,r)},v;for(v in h)h[v]||
delete h[v]}for(var h={inherited:h},w,u;;)if(k)if(1!=k.nodeType)k=k.nextSibling;else if(w&&"script"==k.nodeName.toLowerCase())(y=k.getAttribute("type"))&&/^dojo\/\w/i.test(y)&&w.push(k),k=k.nextSibling;else if(u)k=k.nextSibling;else{var y=k.getAttribute(l)||k.getAttribute(e);v=k.firstChild;if(!y&&(!v||3==v.nodeType&&!v.nextSibling))k=k.nextSibling;else{u=null;if(y){var z=k.getAttribute(d);w=z?[y].concat(z.split(/\s*,\s*/)):[y];try{u=B(w,c.contextRequire)}catch(C){}u||q.forEach(w,function(a){~a.indexOf("/")&&
!p[a]&&(p[a]=!0,f[f.length]=a)});z=u&&!u.prototype._noScript?[]:null;h={types:w,ctor:u,parent:h,node:k,scripts:z};h.inherited=b(h);g.push(h)}else h={node:k,scripts:w,parent:h};w=z;u=k.stopParser||u&&u.prototype.stopParser&&!c.template;k=v}}else{if(!h||!h.node)break;k=h.node.nextSibling;u=!1;h=h.parent;w=h.scripts}var F=new x;f.length?(E("dojo-debug-messages")&&console.warn("WARNING: Modules being Auto-Required: "+f.join(", ")),(c.contextRequire||n)(f,function(){F.resolve(q.filter(g,function(a){if(!a.ctor)try{a.ctor=
B(a.types,c.contextRequire)}catch(g){}for(var b=a.parent;b&&!b.types;)b=b.parent;var f=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(f&&f.stopParser&&!c.template);a.instantiate=!b||b.instantiate&&b.instantiateChildren;return a.instantiate}))})):F.resolve(g);return F.promise},_require:function(a,c){var b=w("{"+a.innerHTML+"}"),g=[],f=[],p=new x,e=c&&c.contextRequire||n,d;for(d in b)g.push(d),f.push(b[d]);e(f,function(){for(var a=0;a<g.length;a++)h.setObject(g[a],arguments[a]);p.resolve(arguments)});
return p.promise},_scanAmd:function(a,c){var b=new x,g=b.promise;b.resolve(!0);var f=this;u("script[type\x3d'dojo/require']",a).forEach(function(a){g=g.then(function(){return f._require(a,c)});a.parentNode.removeChild(a)});return g},parse:function(b,c){var e;!c&&b&&b.rootNode?(c=b,e=c.rootNode):b&&h.isObject(b)&&!("nodeType"in b)?c=b:e=b;e=e?a.byId(e):l.body();c=c||{};var g=c.template?{template:!0}:{},f=[],p=this,d=this._scanAmd(e,c).then(function(){return p.scan(e,c)}).then(function(a){return p._instantiate(a,
g,c,!0)}).then(function(a){return f=f.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});h.mixin(f,d);return f}};m.parser=r;d.parseOnLoad&&v(100,r,"parse");return r})},"dijit/Destroyable":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(n,m,h){return h("dijit.Destroyable",null,{destroy:function(h){this._destroyed=!0},own:function(){var h=["destroyRecursive","destroy","remove"];n.forEach(arguments,function(d){function a(){b.remove();
n.forEach(k,function(a){a.remove()})}var l,b=m.before(this,"destroy",function(a){d[l](a)}),k=[];d.then?(l="cancel",d.then(a,a)):n.forEach(h,function(b){"function"===typeof d[b]&&(l||(l=b),k.push(m.after(d,b,a,!0)))})},this);return arguments}})})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(n,m,h,q,d){return h("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:!1,widgetsInTemplate:!0,contextRequire:null,
_beforeFillContent:function(){if(this.widgetsInTemplate){var a=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);d.parse(a,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(q.hitch(this,function(a){this._startupWidgets=a;for(var b=0;b<a.length;b++)this._processTemplateNode(a[b],function(a,b){return a[b]},function(a,b,d){return b in
a?a.connect(a,b,d):a.on(b,d,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(a,d,b){return d(a,"dojoType")||d(a,"data-dojo-type")?!0:this.inherited(arguments)},startup:function(){n.forEach(this._startupWidgets,
function(a){a&&(!a._started&&a.startup)&&a.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(n,m,h,q,d,a,l,b){var k=m("dijit._TemplatedMixin",b,{templateString:null,templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(a){var b=this.declaredClass,d=this;return l.substitute(a,this,
function(a,e){"!"==e.charAt(0)&&(a=q.getObject(e.substr(1),!1,d));if("undefined"==typeof a)throw Error(b+" template:"+e);return null==a?"":"!"==e.charAt(0)?a:this._escapeValue(""+a)},this)},_escapeValue:function(a){return a.replace(/["'<>&]/g,function(a){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[a]})},buildRendering:function(){if(!this._rendered){this.templateString||(this.templateString=n(this.templatePath,{sanitize:!0}));var a=k.getCachedTemplate(this.templateString,
this._skipNodeCache,this.ownerDocument),b;if(q.isString(a)){if(b=h.toDom(this._stringRepl(a),this.ownerDocument),1!=b.nodeType)throw Error("Invalid template: "+a);}else b=a.cloneNode(!0);this.domNode=b}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(a){var b=this.containerNode;if(a&&b)for(;a.hasChildNodes();)b.appendChild(a.firstChild)}});k._templateCache={};k.getCachedTemplate=function(a,b,d){var m=k._templateCache,n=a,q=m[n];
if(q){try{if(!q.ownerDocument||q.ownerDocument==(d||document))return q}catch(v){}h.destroy(q)}a=l.trim(a);if(b||a.match(/\$\{([^\}]+)\}/g))return m[n]=a;b=h.toDom(a,d);if(1!=b.nodeType)throw Error("Invalid template: "+a);return m[n]=b};a("ie")&&d(window,"unload",function(){var a=k._templateCache,b;for(b in a){var d=a[b];"object"==typeof d&&h.destroy(d);delete a[b]}});return k})},"esri/layers/KMLFolder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(n,
m,h,q,d){n=n(null,{declaredClass:"esri.layers.KMLFolder",constructor:function(a){m.mixin(this,a);d.isDefined(this.visibility)&&(this.visible=!!this.visibility)}});h("extend-esri")&&m.setObject("layers.KMLFolder",n,q);return n})},"dojo/cache":function(){define(["./_base/kernel","./text"],function(n){return n.cache})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(n,m,h,q){h(function(){m("highcontrast")&&n.add(q.body(),"dijit_a11y")});return m})},
"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(n,m,h,q,d,a,l,b){n=n([a,l],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(a,b){m.mixin(this,b);this.initialize(a,b)},getTitle:function(a){var b;this.info&&(b=this.titleHasRelatedFields?"":this._getPopupValues(a,!0).title);return b||""},getContent:function(a){return this.info?
(new b({template:this,graphic:a,chartTheme:this.chartTheme},q.create("div"))).domNode:""}});h("extend-esri")&&m.setObject("dijit.PopupTemplate",n,d);return n})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),function(n,m,h,q,d,a,l){d.add("highcontrast",function(){var a=l.doc.createElement("div");a.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+
(m.blankGif||n.toUrl("./resources/blank.gif"))+'");';l.body().appendChild(a);var h=q.getComputedStyle(a),e=h.backgroundImage,h=h.borderTopColor==h.borderRightColor||e&&("none"==e||"url(invalid-url:)"==e);8>=d("ie")?a.outerHTML="":l.body().removeChild(a);return h});a(function(){d("highcontrast")&&h.add(l.body(),"dj_a11y")});return d})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),
function(n,m,h,q,d,a,l){a.extend(n,{waiRole:"",waiState:""});return d("dijit._Templated",[m,h],{widgetsInTemplate:!1,constructor:function(){l.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin","","2.0")},_processNode:function(a,d){var e=this.inherited(arguments),h=d(a,"waiRole");h&&a.setAttribute("role",h);(h=d(a,"waiState"))&&q.forEach(h.split(/\s*,\s*/),function(d){-1!=d.indexOf("-")&&(d=d.split("-"),a.setAttribute("aria-"+
d[0],d[1]))});return e}})})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(n,m,h,q){q.extend(m,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return h("dijit._FocusMixin",null,{_focusManager:n})})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),
function(n,m,h,q,d,a,l,b,k,e,t,x,E){function u(){}function C(a){return function(b,d,e,k){return b&&"string"==typeof d&&b[d]==u?b.on(d.substring(2).toLowerCase(),l.hitch(e,k)):a.apply(h,arguments)}}n.around(h,"connect",C);a.connect&&n.around(a,"connect",C);n=q("dijit._Widget",[t,x,E],{onClick:u,onDblClick:u,onKeyDown:u,onKeyPress:u,onKeyUp:u,onMouseDown:u,onMouseMove:u,onMouseOut:u,onMouseOver:u,onMouseLeave:u,onMouseEnter:u,onMouseUp:u,constructor:function(a){this._toConnect={};for(var b in a)this[b]===
u&&(this._toConnect[b.replace(/^on/,"").toLowerCase()]=a[b],delete a[b])},postCreate:function(){this.inherited(arguments);for(var a in this._toConnect)this.on(a,this._toConnect[a]);delete this._toConnect},on:function(a,b){return this[this._onMap(a)]===u?h.connect(this.domNode,a.toLowerCase(),this,b):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(b,d){a.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.",
"","2.0");this.set(b,d)},attr:function(a,b){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,arguments):this.get(a)},getDescendants:function(){a.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?b("[widgetId]",this.containerNode).map(e.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});d("dijit-legacy-requires")&&k(0,function(){require(["dijit/_base"])});
return n})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),function(n,m,h,q,d,a,l,b,k,e,t,x,E,u,C,v,w,F,B,z){var y=0;m=m([B,C,v],{declaredClass:"esri.dijit._PopupRenderer",
constructor:function(){this._nls=q.mixin({},z.widgets.popup)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this.template.getComponents(this.graphic).then(q.hitch(this,this._handleComponentsSuccess),q.hitch(this,this._handleComponentsError))},destroy:function(){this._dfd&&this._dfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._dfd=null;this.inherited(arguments)},_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+
1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var b=this._mediaInfos,h=b.length,c=this.domNode,s=this._prevMedia,g=this._nextMedia;if(1<h){var f=0,p=0;d.forEach(b,function(a){"image"===a.type?f++:-1!==a.type.indexOf("chart")&&p++});f&&(e.set(this._imageCount,"innerHTML",f),a.query(".summary .image",c).removeClass("hidden"));p&&(e.set(this._chartCount,"innerHTML",p),a.query(".summary .chart",c).removeClass("hidden"))}else a.query(".summary",
c).addClass("hidden"),t.add(s,"hidden"),t.add(g,"hidden");b=this._mediaPtr;0===b?t.add(s,"hidden"):t.remove(s,"hidden");b===h-1?t.add(g,"hidden"):t.remove(g,"hidden");this._destroyFrame()},_displayMedia:function(){var b=this._mediaInfos[this._mediaPtr],d=b.title,c=b.caption,s=a.query(".mediaSection .hzLine",this.domNode)[0];e.set(this._mediaTitle,"innerHTML",d);t[d?"remove":"add"](this._mediaTitle,"hidden");e.set(this._mediaCaption,"innerHTML",c);t[c?"remove":"add"](this._mediaCaption,"hidden");t[d&&
c?"remove":"add"](s,"hidden");this._rid=null;if("image"===b.type)this._showImage(b.value);else{var g=this,d=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],c=b.value.theme||this.chartTheme;q.isString(c)&&(c=c.replace(/\./gi,"/"),-1===c.indexOf("/")&&(c="dojox/charting/themes/"+c));c||(c="./Rainbow");d.push(c);try{var f=this._rid=y++;n(d,function(a,c,d){f===g._rid&&(g._rid=null,g._showChart(b.type,b.value,a,c,d))})}catch(p){console.log("PopupRenderer: error loading modules")}}},_preventNewTab:function(a){return(a=
a&&q.trim(a).toLowerCase())&&(0===a.indexOf("mailto:")||0===a.indexOf("tel:"))},_showImage:function(b){t.add(this._mediaFrame,"image");var d=E.get(this._gallery,"height"),c;b.linkURL&&(c=x.create("a",{href:b.linkURL,target:this._preventNewTab(b.linkURL)?"":"_blank"},this._mediaFrame));x.create("img",{className:"esriPopupMediaImage",src:b.sourceURL},c||this._mediaFrame);var e=a.query(".esriPopupMediaImage",this._mediaFrame)[0],g=this,f;f=h.connect(e,"onload",function(){h.disconnect(f);f=null;g._imageLoaded(e,
d)})},_showChart:function(a,b,c,e,g){t.remove(this._mediaFrame,"image");c=this._chart=new c(x.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});g&&c.setTheme(g);switch(a){case "piechart":c.addPlot("default",{type:"Pie",labels:!1});c.addSeries("Series A",b.fields);break;case "linechart":c.addPlot("default",{type:"Markers"});c.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});c.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});d.forEach(b.fields,
function(a,b){a.x=b+1});c.addSeries("Series A",b.fields);break;case "columnchart":c.addPlot("default",{type:"Columns",gap:3});c.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});c.addSeries("Series A",b.fields);break;case "barchart":c.addPlot("default",{type:"Bars",gap:3}),c.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),c.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),c.addSeries("Series A",b.fields)}this._action=new e(c);c.render()},
_destroyFrame:function(){this._rid=null;this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);e.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(a,b){var c=a.height;c<b&&(c=Math.round((b-c)/2),E.set(a,"marginTop",c+"px"))},_attListHandler:function(a,b){if(a===this._dfd){this._dfd=null;var c="";!(b instanceof Error)&&(b&&b.length)&&d.forEach(b,function(a){c+="\x3cli\x3e";c+="\x3ca href\x3d'"+F.addProxy(a.url)+"' target\x3d'_blank'\x3e"+
(a.name||"[No name]")+"\x3c/a\x3e";c+="\x3c/li\x3e"});e.set(this._attachmentsList,"innerHTML",c||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_handleComponentsSuccess:function(b){if(b){var h=this.showTitle?b.title:"",c=b.description,s=b.fields,g=b.mediaInfos,f=this.domNode,p=this._nls,l=this,m=this.template,n=this.graphic;this._prevMedia.title=p.NLS_prevMedia;this._nextMedia.title=p.NLS_nextMedia;e.set(this._title,"innerHTML",h);h||t.add(this._title,"hidden");!b.hasDescription&&s&&(c="",d.forEach(s,
function(a){c+="\x3ctr valign\x3d'top'\x3e";c+="\x3ctd class\x3d'attrName'\x3e"+u.encode(a[0])+"\x3c/td\x3e";c+="\x3ctd class\x3d'attrValue'\x3e"+a[1].replace(/^\s*(https?:\/\/[^\s]+)\s*$/i,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+p.NLS_moreInfo+"\x3c/a\x3e")+"\x3c/td\x3e";c+="\x3c/tr\x3e"}),c&&(c="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+c+"\x3c/table\x3e"));e.set(this._description,"innerHTML",c);c||t.add(this._description,"hidden");a.query("a",
this._description).forEach(function(a){l._preventNewTab(a.href)?"_blank"===a.target&&e.remove(a,"target"):e.set(a,"target","_blank")});h&&c?a.query(".mainSection .hzLine",f).removeClass("hidden"):h||c?a.query(".mainSection .hzLine",f).addClass("hidden"):a.query(".mainSection",f).addClass("hidden");if(h=this._dfd=m.getAttachments(n))h.addBoth(q.hitch(this,this._attListHandler,h)),e.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+p.NLS_searching+"...\x3c/li\x3e"),a.query(".attachmentsSection",f).removeClass("hidden");
g&&g.length&&(a.query(".mediaSection",f).removeClass("hidden"),k.setSelectable(this._mediaFrame,!1),this._mediaInfos=g,this._mediaPtr=0,this._updateUI(),this._displayMedia());b.editSummary&&(e.set(this._editSummary,"innerHTML",b.editSummary),g&&g.length&&t.remove(this._mediaBreak,"hidden"),t.remove(this._editSummarySection,"hidden"))}},_handleComponentsError:function(a){console.log("PopupRenderer: error loading template",a)}});l("extend-esri")&&q.setObject("dijit._PopupRenderer",m,w);return m})},
"dojox/html/entities":function(){define(["dojo/_base/lang"],function(n){var m=n.getObject("dojox.html.entities",!0),h=function(d,a){var h,b;if(a._encCache&&a._encCache.regexp&&a._encCache.mapper&&a.length==a._encCache.length)h=a._encCache.mapper,b=a._encCache.regexp;else{h={};b=["["];var k;for(k=0;k<a.length;k++)h[a[k][0]]="\x26"+a[k][1]+";",b.push(a[k][0]);b.push("]");b=RegExp(b.join(""),"g");a._encCache={mapper:h,regexp:b,length:a.length}}return d=d.replace(b,function(a){return h[a]})},q=function(d,
a){var h,b;if(a._decCache&&a._decCache.regexp&&a._decCache.mapper&&a.length==a._decCache.length)h=a._decCache.mapper,b=a._decCache.regexp;else{h={};b=["("];var k;for(k=0;k<a.length;k++){var e="\x26"+a[k][1]+";";k&&b.push("|");h[e]=a[k][0];b.push(e)}b.push(")");b=RegExp(b.join(""),"g");a._decCache={mapper:h,regexp:b,length:a.length}}return d=d.replace(b,function(a){return h[a]})};m.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];m.latin=[["\u00a1","iexcl"],["\u00a2",
"cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],
["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],
["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1",
"ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],
["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],
["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],
["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],
["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665",
"hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039",
"lsaquo"],["\u203a","rsaquo"]];m.encode=function(d,a){d&&(a?d=h(d,a):(d=h(d,m.html),d=h(d,m.latin)));return d};m.decode=function(d,a){d&&(a?d=q(d,a):(d=q(d,m.html),d=q(d,m.latin)));return d};return m})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(n,m,h,q,d,a,l,b,k,e,t,x,E,u,C,v,w,F,B,z,y,r,A){function c(a){return function(c){b[c?"set":"remove"](this.domNode,a,c);this._set(a,c)}}E.add("dijit-legacy-requires",!u.isAsync);E.add("dojo-bidi",!1);E("dijit-legacy-requires")&&w(0,function(){n(["dijit/_base/manager"])});var s={};q=a("dijit._WidgetBase",[F,y],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:c("lang"),dir:"",_setDirAttr:c("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",a)},attributeMap:{},_blankGif:q.blankGif||n.toUrl("dojo/resources/blank.gif"),_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var b=a.prototype,c=a._setterAttrs=[],a=a._onMap={},d;for(d in b.attributeMap)c.push(d);for(d in b)/^on/.test(d)&&(a[d.substring(2).toLowerCase()]=d),/^_set[A-Z](.*)Attr$/.test(d)&&(d=d.charAt(4).toLowerCase()+d.substr(5,
d.length-9),(!b.attributeMap||!(d in b.attributeMap))&&c.push(d))}},postscript:function(a,b){this.create(a,b)},create:function(a,b){this._introspect();this.srcNodeRef=l.byId(b);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);a&&(this.params=a,C.mixin(this,a));this.postMixInProperties();this.id||(this.id=A.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=this.ownerDocument||
(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=z.body(this.ownerDocument);A.add(this);this.buildRendering();var c;if(this.domNode){this._applyAttributes();var d=this.srcNodeRef;d&&(d.parentNode&&this.domNode!==d)&&(d.parentNode.replaceChild(this.domNode,d),c=!0);this.domNode.setAttribute("widgetId",this.id)}this.postCreate();c&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},b;for(b in this.params||{})a[b]=this._get(b);m.forEach(this.constructor._setterAttrs,
function(b){if(!(b in a)){var c=this._get(b);c&&this.set(b,c)}},this);for(b in a)this.set(b,a[b])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var a=this.baseClass.split(" ");this.isLeftToRight()||(a=a.concat(m.map(a,function(a){return a+"Rtl"})));k.add(this.domNode,a)}},postCreate:function(){},startup:function(){this._started||(this._started=!0,m.forEach(this.getChildren(),function(a){!a._started&&
(!a._destroyed&&C.isFunction(a.startup))&&(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function b(c){c.destroyRecursive?c.destroyRecursive(a):c.destroy&&c.destroy(a)}this._beingDestroyed=!0;this.uninitialize();m.forEach(this._connects,C.hitch(this,"disconnect"));m.forEach(this._supportingWidgets,b);this.domNode&&m.forEach(A.findWidgets(this.domNode,this.containerNode),b);this.destroyRendering(a);
A.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);this.domNode&&(a?b.remove(this.domNode,"widgetId"):e.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||e.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){m.forEach(this.getChildren(),function(b){b.destroyRecursive&&b.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(a){var b=this.domNode;C.isObject(a)?
x.set(b,a):b.style.cssText=b.style.cssText?b.style.cssText+("; "+a):a;this._set("style",a)},_attrToDom:function(a,c,d){d=3<=arguments.length?d:this.attributeMap[a];m.forEach(C.isArray(d)?d:[d],function(d){var p=this[d.node||d||"domNode"];switch(d.type||"attribute"){case "attribute":C.isFunction(c)&&(c=C.hitch(this,c));d=d.attribute?d.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;p.tagName?b.set(p,d,c):p.set(d,c);break;case "innerText":p.innerHTML="";p.appendChild(this.ownerDocument.createTextNode(c));
break;case "innerHTML":p.innerHTML=c;break;case "class":k.replace(p,c,this[a])}},this)},get:function(a){var b=this._getAttrNames(a);return this[b.g]?this[b.g]():this._get(a)},set:function(a,b){if("object"===typeof a){for(var c in a)this.set(c,a[c]);return this}c=this._getAttrNames(a);var d=this[c.s];if(C.isFunction(d))var e=d.apply(this,Array.prototype.slice.call(arguments,1));else{var d=this.focusNode&&!C.isFunction(this.focusNode)?"focusNode":"domNode",h=this[d]&&this[d].tagName,l;if(l=h)if(!(l=
s[h])){l=this[d];var k={},m;for(m in l)k[m.toLowerCase()]=!0;l=s[h]=k}m=l;c=a in this.attributeMap?this.attributeMap[a]:c.s in this?this[c.s]:m&&c.l in m&&"function"!=typeof b||/^aria-|^data-|^role$/.test(a)?d:null;null!=c&&this._attrToDom(a,b,c);this._set(a,b)}return e||this},_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;if(b[a])return b[a];var c=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});return b[a]={n:a+"Node",s:"_set"+c+"Attr",
g:"_get"+c+"Attr",l:c.toLowerCase()}},_set:function(a,b){var c=this[a];this[a]=b;if(this._created&&!(c===b||c!==c&&b!==b))this._watchCallbacks&&this._watchCallbacks(a,c,b),this.emit("attrmodified-"+a,{detail:{prevValue:c,newValue:b}})},_get:function(a){return this[a]},emit:function(a,b,c){b=b||{};void 0===b.bubbles&&(b.bubbles=!0);void 0===b.cancelable&&(b.cancelable=!0);b.detail||(b.detail={});b.detail.widget=this;var d,e=this["on"+a];e&&(d=e.apply(this,c?c:[b]));this._started&&!this._beingDestroyed&&
v.emit(this.domNode,a.toLowerCase(),b);return d},on:function(a,b){var c=this._onMap(a);return c?h.after(this,c,b,!0):this.own(v(this.domNode,a,b))[0]},_onMap:function(a){var b=this.constructor,c=b._onMap;if(!c){var c=b._onMap={},d;for(d in b.prototype)/^on/.test(d)&&(c[d.replace(/^on/,"").toLowerCase()]=d)}return c["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?A.findWidgets(this.containerNode):
[]},getParent:function(){return A.getEnclosingWidget(this.domNode.parentNode)},connect:function(a,b,c){return this.own(d.connect(a,b,this,c))[0]},disconnect:function(a){a.remove()},subscribe:function(a,b){return this.own(B.subscribe(a,C.hitch(this,b)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():t.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=x.get(this.domNode,"display")},placeAt:function(a,b){var c=
!a.tagName&&A.byId(a);c&&c.addChild&&(!b||"number"===typeof b)?c.addChild(this,b):(c=c&&"domNode"in c?c.containerNode&&!/after|before|replace/.test(b||"")?c.containerNode:c.domNode:l.byId(a,this.ownerDocument),e.place(this.domNode,c,b),!this._started&&(this.getParent()||{})._started&&this.startup());return this},defer:function(a,b){var c=setTimeout(C.hitch(this,function(){c&&(c=null,this._destroyed||C.hitch(this,a)())}),b||0);return{remove:function(){c&&(clearTimeout(c),c=null);return null}}}});E("dojo-bidi")&&
q.extend(r);return q})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(n,m){var h={};n.setObject("dojo.date.stamp",h);h.fromISOString=function(n,d){h._isoRegExp||(h._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var a=h._isoRegExp.exec(n),l=null;if(a){a.shift();a[1]&&a[1]--;a[6]&&(a[6]*=1E3);d&&(d=new Date(d),m.forEach(m.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),
function(a){return d["get"+a]()}),function(b,d){a[d]=a[d]||b}));l=new Date(a[0]||1970,a[1]||0,a[2]||1,a[3]||0,a[4]||0,a[5]||0,a[6]||0);100>a[0]&&l.setFullYear(a[0]||1970);var b=0,k=a[7]&&a[7].charAt(0);"Z"!=k&&(b=60*(a[8]||0)+(Number(a[9])||0),"-"!=k&&(b*=-1));k&&(b-=l.getTimezoneOffset());b&&l.setTime(l.getTime()+6E4*b)}return l};h.toISOString=function(h,d){var a=function(a){return 10>a?"0"+a:a};d=d||{};var l=[],b=d.zulu?"getUTC":"get",k="";"time"!=d.selector&&(k=h[b+"FullYear"](),k=["0000".substr((k+
"").length)+k,a(h[b+"Month"]()+1),a(h[b+"Date"]())].join("-"));l.push(k);if("date"!=d.selector){k=[a(h[b+"Hours"]()),a(h[b+"Minutes"]()),a(h[b+"Seconds"]())].join(":");b=h[b+"Milliseconds"]();d.milliseconds&&(k+="."+(100>b?"0":"")+a(b));if(d.zulu)k+="Z";else if("time"!=d.selector)var b=h.getTimezoneOffset(),e=Math.abs(b),k=k+((0<b?"-":"+")+a(Math.floor(e/60))+":"+a(e%60));l.push(k)}return l.join("T")};return h})},"*noref":1}});
define("esri/layers/KMLLayer","dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/sniff dojo/io-query dojo/dom-construct dojo/dom-style ../kernel ../config ../lang ../request ../SpatialReference ../geometry/webMercatorUtils ../dijit/PopupTemplate ./layer ./KMLFolder ./KMLGroundOverlay ./MapImageLayer ./FeatureLayer".split(" "),function(n,m,h,q,d,a,l,b,k,e,t,x,E,u,C,v,w,F,B,z,y,r){var A=m([F],{declaredClass:"esri.layers.KMLLayer",serviceUrl:location.protocol+
"//utility.arcgis.com/sharing/kml",constructor:function(a,b){a||console.log("KMLLayer:constructor - please provide url for the KML file");this._outSR=b&&b.outSR||new C({wkid:4326});this._options=q.mixin({},b);x.defaults.kmlService&&(this.serviceUrl=x.defaults.kmlService);var d=this.linkInfo=b&&b.linkInfo;d&&(this.visible=!!d.visibility,this._waitingForMap=!!d.viewFormat);(!d||d&&d.visibility&&!this._waitingForMap)&&this._parseKml();this.refresh=q.hitch(this,this.refresh);this.registerConnectEvents("esri.layers.KMLLayer",
!0)},getFeature:function(a){if(a){var b=a.type,g=a.id,f;switch(b){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":(a=this["_"+b])&&(f=q.getObject("_mode._featureMap."+g,!1,a));break;case "GroundOverlay":if(a=this._groundLyr){var e=a.getImages(),b=e.length;for(a=0;a<b;a++)if(e[a].id===g){f=e[a];break}}break;case "ScreenOverlay":break;case "NetworkLink":d.some(this._links,function(a){return a.linkInfo&&a.linkInfo.id===g?(f=a,!0):!1});break;case "Folder":b=(e=this.folders)?
e.length:0;for(a=0;a<b;a++)if(e[a].id===g){f=e[a];break}break;default:console.log("KMLLayer:getFeature - unknown feature type")}return f}},getLayers:function(){var a=[];this._groundLyr&&a.push(this._groundLyr);this._fLayers&&(a=a.concat(this._fLayers));this._links&&d.forEach(this._links,function(b){b.declaredClass&&a.push(b)});return a},setFolderVisibility:function(a,b){a&&(this._fireUpdateStart(),(a.visible=b)&&(b=this._areLocalAncestorsVisible(a)),this._setState(a,b),this._fireUpdateEnd())},onRefresh:function(){},
onOpacityChange:function(){},_parseKml:function(b){var d=this;this._fireUpdateStart();this._io=u({url:this.serviceUrl,content:{url:this._url.path+this._getQueryParameters(b),model:"simple",folders:"",refresh:this.loaded?!0:void 0,outSR:a.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(a){d._io=null;d._initLayer(a)},error:function(a){d._io=null;a=q.mixin(Error(),a);a.message="Unable to load KML: "+d.url+" "+(a.message||"");d._fireUpdateEnd(a);d.onError(a)}})},_initLayer:function(a){var b;
this.loaded&&(b=[],d.forEach(this.folders,function(a){a.visible&&b.push(a.id)}),this._options.minScale=this.minScale,this._options.maxScale=this.maxScale,this._options.opacity=this.opacity,this._removeInternalLayers());this.name=a.name;this.description=a.description;this.snippet=a.snippet;this.visibility=a.visibility;this.featureInfos=a.featureInfos;var g,f,e=this.folders=a.folders,h=[],l;if(e){f=e.length;for(g=0;g<f;g++)l=e[g]=new B(e[g]),-1===l.parentFolderId&&h.push(l)}var e=this._links=a.networkLinks,
k;f=e?e.length:0;for(g=0;g<f;g++)e[g].viewRefreshMode&&-1!==e[g].viewRefreshMode.toLowerCase().indexOf("onregion")||(k=q.mixin({},this._options),k.linkInfo=e[g],k.id&&(k.id=k.id+"_"+g),e[g]=new A(e[g].href,k),e[g]._parentLayer=this,e[g]._parentFolderId=this._getLinkParentId(e[g].linkInfo.id));if((e=a.groundOverlays)&&0<e.length){k=q.mixin({},this._options);k.id&&(k.id+="_mapImage");l=this._groundLyr=new y(k);f=e.length;for(g=0;g<f;g++)l.addImage(new z(e[g]))}if((a=q.getObject("featureCollection.layers",
!1,a))&&0<a.length)this._fLayers=[],d.forEach(a,function(a,b){var c=q.getObject("featureSet.features",!1,a);c&&0<c.length&&(k=q.mixin({outFields:["*"],infoTemplate:a.popupInfo?new w(a.popupInfo):null,editable:!1},this._options),k.id&&(k.id=k.id+"_"+b),a.layerDefinition.capabilities="Query,Data",c=new r(a,k),c.geometryType&&(this["_"+c.geometryType]=c),this._fLayers.push(c))},this),0===this._fLayers.length&&delete this._fLayers;if(!this.loaded){f=h.length;for(g=0;g<f;g++)l=h[g],this._setState(l,l.visible)}this._fireUpdateEnd();
this.loaded?(this._addInternalLayers(),d.forEach(this.folders,function(a){-1<d.indexOf(b,a.id)?this.setFolderVisibility(a,!0):this.setFolderVisibility(a,!1)},this),this.onRefresh()):(this.loaded=!0,this.onLoad(this))},_addInternalLayers:function(){var a=this._map;this._fireUpdateStart();this._links&&d.forEach(this._links,function(b){b.declaredClass&&(a.addLayer(b),b._waitingForMap&&(b._waitingForMap=null,b.visible?b._parseKml(a):b._wMap=a))});var b=a.spatialReference,g=this._outSR,f;if(!b.equals(g))if(b.isWebMercator()&&
4326===g.wkid)f=v.geographicToWebMercator;else if(g.isWebMercator()&&4326===b.wkid)f=v.webMercatorToGeographic;else{console.log("KMLLayer:_setMap - unsupported workflow. Spatial reference of the map and kml layer do not match, and the conversion cannot be done on the client.");return}this._groundLyr&&(f&&d.forEach(this._groundLyr.getImages(),function(a){a.extent=f(a.extent)}),a.addLayer(this._groundLyr));(b=this._fLayers)&&0<b.length&&d.forEach(b,function(b){if(f){var d=b.graphics,g,e,h=d?d.length:
0;for(g=0;g<h;g++)(e=d[g].geometry)&&d[g].setGeometry(f(e))}a.addLayer(b)});this.onVisibilityChange(this.visible)},_removeInternalLayers:function(){var a=this._map;this._links&&d.forEach(this._links,function(a){a.declaredClass&&a._io&&a._io.cancel()});a&&d.forEach(this.getLayers(),a.removeLayer,a)},_setState:function(a,b){var d=a.featureInfos,f,e,h,l=d?d.length:0,k=b?"show":"hide";for(h=0;h<l;h++)if(f=d[h],e=this.getFeature(f))if("Folder"===f.type)this._setState(e,b&&e.visible);else if("NetworkLink"===
f.type)this._setInternalVisibility(e,b);else e[k]()},_areLocalAncestorsVisible:function(a){var b=a.parentFolderId;for(a=a.visible;a&&-1!==b;)b=this.getFeature({type:"Folder",id:b}),a=a&&b.visible,b=b.parentFolderId;return a},_setInternalVisibility:function(a,b){var d=a._parentLayer,e=a._parentFolderId;for(b=b&&a.visible;b&&d;)b=b&&d.visible,-1<e&&(b=b&&d._areLocalAncestorsVisible(d.getFeature({type:"Folder",id:e}))),e=d._parentFolderId,d=d._parentLayer;this._setIntState(a,b)},_setIntState:function(a,
b){a&&d.forEach(a.getLayers(),function(d){d.linkInfo?a._setIntState(d,b&&d.visible&&a._areLocalAncestorsVisible(a.getFeature({type:"Folder",id:d._parentFolderId}))):d.setVisibility(b)})},_getLinkParentId:function(a){var b=-1;this.folders&&d.some(this.folders,function(g){return g.networkLinkIds&&-1!==d.indexOf(g.networkLinkIds,a)?(b=g.id,!0):!1});return b},_checkAutoRefresh:function(){var a=this.linkInfo;if(a)if(this.visible){if(this.loaded&&this._map){var b=a.refreshMode,d=a.refreshInterval,e=a.viewRefreshMode,
a=a.viewRefreshTime;b&&(-1!==b.toLowerCase().indexOf("oninterval")&&0<d)&&(this._stopAutoRefresh(),this._timeoutHandle=setTimeout(this.refresh,1E3*d));e&&(-1!==e.toLowerCase().indexOf("onstop")&&0<a)&&!this._extChgHandle&&(this._extChgHandle=h.connect(this._map,"onExtentChange",this,this._extentChanged))}}else this._stopAutoRefresh(),h.disconnect(this._extChgHandle),delete this._extChgHandle},_stopAutoRefresh:function(){clearTimeout(this._timeoutHandle);this._timeoutHandle=null},_getQueryParameters:function(a){a=
a||this._map;var d={},e=this.linkInfo,f=a&&a.extent,h;this._url.query&&(q.mixin(d,this._url.query),h=!!this._url.query.token);if(t.id&&!h&&(h=t.id.findCredential(this._url.path)))d.token=h.token;if(e){h=e.viewFormat;var l=e.httpQuery,e=e.viewBoundScale;if(f&&h){var k=f,m=f,r=f.spatialReference;r&&(r.isWebMercator()?k=v.webMercatorToGeographic(f):4326===r.wkid&&(m=v.geographicToWebMercator(f)));f=k.getCenter();m=Math.max(m.getWidth(),m.getHeight());e&&(k=k.expand(e));h=h.replace(/\[bboxWest\]/ig,k.xmin).replace(/\[bboxEast\]/ig,
k.xmax).replace(/\[bboxSouth\]/ig,k.ymin).replace(/\[bboxNorth\]/ig,k.ymax).replace(/\[lookatLon\]/ig,f.x).replace(/\[lookatLat\]/ig,f.y).replace(/\[lookatRange\]/ig,m).replace(/\[lookatTilt\]/ig,0).replace(/\[lookatHeading\]/ig,0).replace(/\[lookatTerrainLon\]/ig,f.x).replace(/\[lookatTerrainLat\]/ig,f.y).replace(/\[lookatTerrainAlt\]/ig,0).replace(/\[cameraLon\]/ig,f.x).replace(/\[cameraLat\]/ig,f.y).replace(/\[cameraAlt\]/ig,m).replace(/\[horizFov\]/ig,60).replace(/\[vertFov\]/ig,60).replace(/\[horizPixels\]/ig,
a.width).replace(/\[vertPixels\]/ig,a.height).replace(/\[terrainEnabled\]/ig,0);q.mixin(d,b.queryToObject(h))}l&&(l=l.replace(/\[clientVersion\]/ig,t.version).replace(/\[kmlVersion\]/ig,2.2).replace(/\[clientName\]/ig,"ArcGIS API for JavaScript").replace(/\[language\]/ig,n.locale),q.mixin(d,b.queryToObject(l)))}a=[];for(var u in d)E.isDefined(d[u])&&a.push(u+"\x3d"+d[u]);return(a=a.join("\x26"))?"?"+a:""},setScaleRange:function(a,b){this.inherited(arguments);d.forEach(this.getLayers(),function(d){d.setScaleRange(a,
b)})},setOpacity:function(a){this.opacity!=a&&(d.forEach(this.getLayers(),function(b){b.setOpacity(a)}),this.opacity=a,this.onOpacityChange(a))},_setMap:function(a,b){this.inherited(arguments);this._map=a;var d=this._div=k.create("div",null,b);e.set(d,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return d},_unsetMap:function(a,b){this._io&&this._io.cancel();this._stopAutoRefresh();h.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();
var d=this._div;d&&(b.removeChild(d),k.destroy(d));this._wMap=this._div=null;this.inherited(arguments)},onVisibilityChange:function(a){this.loaded?(this._fireUpdateStart(),this._setInternalVisibility(this,a),this._checkAutoRefresh(),this._fireUpdateEnd()):this.linkInfo&&a&&(this._waitingForMap||this._parseKml(this._wMap))},refresh:function(){this.loaded&&(this._map&&!this._io&&this.visible)&&this._parseKml()},getFeatureCollection:function(a){var b,e=[];if(a=this.getFeature({type:"Folder",id:a}))(b=
d.map(a.featureInfos,function(a){if("esriGeometryPoint"===a.type||"esriGeometryPolyline"===a.type||"esriGeometryPolygon"===a.type)return a.id},this))&&0<b.length&&d.forEach(this._fLayers,function(a){var c,h;c=a.toJson();c.featureSet.features&&0<c.featureSet.features.length&&(h=d.filter(c.featureSet.features,function(c){if(-1!==d.indexOf(b,c.attributes[a.objectIdField]))return c},this));h&&0<h.length&&(c.featureSet.features=h,e.push(c))},this);return e},getFeatureCount:function(a){a=this.getFeature({type:"Folder",
id:a});var b={points:0,polylines:0,polygons:0};a&&d.forEach(a.featureInfos,function(a){"esriGeometryPoint"===a.type&&(b.points+=1);"esriGeometryPolyline"===a.type&&(b.polylines+=1);"esriGeometryPolygon"===a.type&&(b.polygons+=1)});return b},_extentChanged:function(){this._stopAutoRefresh();this._timeoutHandle=setTimeout(this.refresh,1E3*this.linkInfo.viewRefreshTime)}});l("extend-esri")&&q.setObject("layers.KMLLayer",A,t);return A});